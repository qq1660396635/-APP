// è‡ªåŠ¨ç”Ÿæˆè„šæœ¬å˜é‡åº“
// æºç›®å½•: /storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/
// ç”Ÿæˆæ—¶é—´: 2025-11-16 07:38:44
// æ€»è®¡: 23 ä¸ªæ–‡ä»¶

var aa = {
  index: 1,
  filename: '1. æœ¬åœ°æœåŠ¡/A. å¼€æœºå¯åŠ¨è„šæœ¬ï¼ˆ3.7ç‰ˆï¼‰.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/1. æœ¬åœ°æœåŠ¡/A. å¼€æœºå¯åŠ¨è„šæœ¬ï¼ˆ3.7ç‰ˆï¼‰.bash',
  content: `######################### ä¸€é”®å®‰è£… begin #########################
# 0. å¦‚æœ‰æ—§æ–‡ä»¶å…ˆæ¸…æ‰ï¼ˆå¯é€‰ï¼‰
rm -f $PREFIX/2025/kw.txt $PREFIX/2025/start

# 1. ç¡®ä¿ç›®å½•å­˜åœ¨
mkdir -p $PREFIX/2025

# 2. å†™å…¥æ ¸å¿ƒå…³é”®è¯
cat > $PREFIX/2025/kw.txt <<'EOF'
è¿›ç¨‹è°ƒåº¦
å†…å­˜ç®¡ç†
è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ
ç½‘ç»œå­ç³»ç»Ÿ
ä¸­æ–­å¤„ç†
ç³»ç»Ÿè°ƒç”¨
æ–‡ä»¶æè¿°ç¬¦
ç¼ºé¡µå¼‚å¸¸
ä¿¡å·é‡
æ­»é”
cron
EOF

# 3. ç”Ÿæˆ start è„šæœ¬
cat > $PREFIX/2025/start <<'EOF'
#!/data/data/com.termux/files/usr/bin/bash
while :; do
    kw=$(shuf -n 1 $PREFIX/2025/kw.txt)
    response=$(curl -s "https://baike.baidu.com/api/openapi/BaikeLemmaCardApi?scope=103&format=json&appid=379020&bk_key=$kw")
    abstract=$(echo "$response" | jq -r '.abstract // ""')
    [[ -n $abstract ]] && break
done

# è‡ªç„¶åˆ†æ®µå¤„ç†ï¼šå°†å¥å·æ›¿æ¢ä¸ºæ¢è¡Œï¼Œå»é™¤å¤šä½™å†…å®¹ï¼Œæ¯è¡Œå‰åŠ ä¸¤ä¸ªç©ºæ ¼
abstract=$(echo "$abstract" | sed 's/ã€‚/ã€‚\\n/g' | sed 's/\\[[0-9]*\\]//g' | sed 's/^[[:space:]]*//' | sed '/^$/d' | sed 's/^/  /')
printf "ã€%sã€‘\\n%s\\n" "$kw" "$abstract"
EOF

# 4. èµ‹æƒ & æ³¨å…¥ .bashrc
chmod +x $PREFIX/2025/start
sed -i '\\|$PREFIX/.*/start|d' $HOME/.bashrc
echo '$PREFIX/2025/start' >> $HOME/.bashrc
######################### ä¸€é”®å®‰è£… end #########################





######################### ç²¾ç®€å…³é”®è¯æ›´æ–°è„šæœ¬ begin #########################
#!/bin/bash

# åˆ é™¤æ—§çš„å…³é”®è¯æ–‡ä»¶
rm -f $PREFIX/2025/kw.txt

# åˆ›å»ºæ–°çš„å…³é”®è¯æ–‡ä»¶ï¼ŒåªåŒ…å«5ä¸ªæ ¸å¿ƒæœ¯è¯­
cat > $PREFIX/2025/kw.txt <<'EOF'
Linuxå†…æ ¸
è¿›ç¨‹è°ƒåº¦
å†…å­˜ç®¡ç†
STM32
åµŒå…¥å¼ç³»ç»Ÿ
EOF

echo "å…³é”®è¯åˆ—è¡¨å·²ç²¾ç®€æ›´æ–°å®Œæˆï¼å…±åŒ…å« $(wc -l < $PREFIX/2025/kw.txt) ä¸ªæ ¸å¿ƒæœ¯è¯­ã€‚"
echo "ä¸‹æ¬¡å¯åŠ¨Termuxæ—¶å°†æ˜¾ç¤ºéšæœºæœ¯è¯­çš„ç™¾åº¦ç™¾ç§‘æ‘˜è¦ã€‚"
######################### ç²¾ç®€å…³é”®è¯æ›´æ–°è„šæœ¬ end #########################




#########################1.  è„šæœ¬3 æ·»åŠ åŠ›æ‰£åŠŸèƒ½ begin #########################
# åˆ›å»ºåŠ›æ‰£é¢˜ç›®æ–‡ä»¶ï¼ˆæ–°æ ¼å¼ï¼‰
cat > $PREFIX/2025/leetcode_short.txt <<'EOF'
100. Same Treeï½œä¸¤æ£µäºŒå‰æ ‘é•¿å¾—ä¸€æ¨¡ä¸€æ ·å—ï¼Ÿï½œåƒæ¯”è¾ƒä¸¤ç›†ç›†æ ½ï¼Œå…ˆæ¯”æ ¹ï¼Œå†é€’å½’æ¯”å·¦å³æï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
101. Symmetric Treeï½œäºŒå‰æ ‘æ˜¯ä¸æ˜¯å·¦å³ç…§é•œå­ï¼Ÿï½œæŠŠæ ‘å¯¹æŠ˜ï¼Œçœ‹ä¸¤è¾¹å¶è„‰èƒ½å¦é‡å ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
102. Binary Tree Level Order Traversalï½œæŠŠæ ‘æŒ‰æ¥¼å±‚æ‹ç…§ï½œç”¨é˜Ÿåˆ—å½“ç”µæ¢¯ï¼Œä¸€å±‚å±‚æŠŠäººæ”¾å‡ºæ¥åˆå½±ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+æ ‘
103. Binary Tree Zigzag Level Order Traversalï½œè›‡å½¢æ’é˜Ÿæ‹ç…§ï½œç”µæ¢¯æ¯å±‚æ¢æ–¹å‘ï¼Œå·¦â†’å³â†’å·¦â†’å³ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+æ ‘
104. Maximum Depth of Binary Treeï½œæ ‘æœ€é«˜åˆ°å‡ æ¥¼ï¼Ÿï½œä»æ ¹å¾€ä¸‹æ‰”çŸ³å­ï¼Œçœ‹æœ€æ·±æº…èµ·çš„æ°´èŠ±ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
EOF

# åˆ›å»ºåŠ›æ‰£é¢˜ç›®éšæœºæ˜¾ç¤ºè„šæœ¬ï¼ˆæ–°æ ¼å¼ç‰ˆï¼‰
cat > $PREFIX/2025/leetcode.sh <<'EOF'
#!/data/data/com.termux/files/usr/bin/bash
FILE="$PREFIX/2025/leetcode_short.txt"
if [ -f "$FILE" ]; then
    echo  # æ¢è¡Œ
    echo  # æ¢è¡Œ
    line=$(shuf -n 1 "$FILE")
    
    # ä½¿ç”¨ï½œåˆ†å‰²å„ä¸ªéƒ¨åˆ†
    IFS='ï½œ' read -ra parts <<< "$line"
    
    # è¾“å‡ºæ ¼å¼åŒ–å†…å®¹
    echo "\${parts[0]}"  # é¢˜ç›®åç§°
    echo "  é¢˜ç›®è¯´æ˜ï¼š\${parts[1]}"  # é¢˜ç›®äººè¯è¯´æ˜
    echo "  æ€è·¯è¯´æ˜ï¼š\${parts[2]}"  # æ€è·¯äººè¯è¯´æ˜
    echo "  ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼š\${parts[3]}"  # ç®—æ³•æ€æƒ³å’Œæ•°æ®ç»“æ„
else
    echo "Leetcode file not found."
fi
EOF

# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x $PREFIX/2025/leetcode.sh

# æ³¨å…¥åˆ°.bashrcï¼ˆåªæ·»åŠ åŠ›æ‰£éƒ¨åˆ†ï¼‰
sed -i '\\|$PREFIX/2025/leetcode.sh|d' $HOME/.bashrc
echo '$PREFIX/2025/leetcode.sh' >> $HOME/.bashrc

echo "åŠ›æ‰£åŠŸèƒ½æ·»åŠ å®Œæˆï¼é‡å¯Termuxæˆ–è¿è¡Œ 'source ~/.bashrc' æŸ¥çœ‹æ•ˆæœã€‚"
######################### æ·»åŠ åŠ›æ‰£åŠŸèƒ½ end #########################






#########################1. æ·»åŠ åŠ›æ‰£åŠŸèƒ½ begin #########################
# åˆ›å»ºåŠ›æ‰£é¢˜ç›®æ–‡ä»¶ï¼ˆ100-150é¢˜ï¼Œå…¨éƒ¨ä½¿ç”¨ä¸­æ–‡ï¼‰
cat > $PREFIX/2025/leetcode_short.txt <<'EOF'
100. åˆ¤æ–­ä¸¤æ£µäºŒå‰æ ‘æ˜¯å¦ç›¸åŒï½œä¸¤æ£µäºŒå‰æ ‘é•¿å¾—ä¸€æ¨¡ä¸€æ ·å—ï¼Ÿï½œåƒæ¯”è¾ƒä¸¤ç›†ç›†æ ½ï¼Œå…ˆæ¯”æ ¹ï¼Œå†é€’å½’æ¯”å·¦å³æï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
101. åˆ¤æ–­äºŒå‰æ ‘æ˜¯å¦å¯¹ç§°ï½œäºŒå‰æ ‘æ˜¯ä¸æ˜¯å·¦å³ç…§é•œå­ï¼Ÿï½œæŠŠæ ‘å¯¹æŠ˜ï¼Œçœ‹ä¸¤è¾¹å¶è„‰èƒ½å¦é‡å ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
102. äºŒå‰æ ‘çš„å±‚åºéå†ï½œæŠŠæ ‘æŒ‰æ¥¼å±‚æ‹ç…§ï½œç”¨é˜Ÿåˆ—å½“ç”µæ¢¯ï¼Œä¸€å±‚å±‚æŠŠäººæ”¾å‡ºæ¥åˆå½±ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+æ ‘
103. äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå†ï½œè›‡å½¢æ’é˜Ÿæ‹ç…§ï½œç”µæ¢¯æ¯å±‚æ¢æ–¹å‘ï¼Œå·¦â†’å³â†’å·¦â†’å³ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+æ ‘
104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ï½œæ ‘æœ€é«˜åˆ°å‡ æ¥¼ï¼Ÿï½œä»æ ¹å¾€ä¸‹æ‰”çŸ³å­ï¼Œçœ‹æœ€æ·±æº…èµ·çš„æ°´èŠ±ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
105. æ ¹æ®å‰åºå’Œä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ï½œPreorderå½“"éª¨æ¶"ï¼ŒInorderå½“"è‚‰"ï½œåƒæ‹¼ä¹é«˜ï¼Œå…ˆæ”¾ä¸»æ¢ï¼Œå†å·¦å³æ’ç –ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
106. æ ¹æ®ä¸­åºå’Œååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ï½œPostorderå½“"å€’éª¨æ¶"ï½œä»åå¾€å‰åƒå€’ç€æ‹†å¿«é€’ï¼Œè¾¹æ‹†è¾¹å¤åŸï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
107. äºŒå‰æ ‘çš„å±‚åºéå†IIï½œè‡ªåº•å‘ä¸Šæ‹æ¥¼å±‚ï½œæŠŠæ¥¼å±‚ç…§ç‰‡å€’åºæ’ï¼Œåƒç¿»ä¹¦ä»æœ€åä¸€é¡µçœ‹ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+æ•°ç»„
108. å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘ï½œæŠŠæ’å¥½åºçš„"å°é˜¶"æŠ˜æˆå¹³è¡¡æ ‘ï½œæ‰¾ä¸­é—´å½“æ”¯ç‚¹ï¼Œå·¦å³ç»§ç»­æŠ˜ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
109. å°†æœ‰åºé“¾è¡¨è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘ï½œæŠŠæœ‰åºé“¾è¡¨æŠ˜æˆæ ‘ï½œå¿«æ…¢æŒ‡é’ˆæ‰¾ä¸­ç‚¹ï¼ŒåƒæŠ˜çº¸é£æœºæ‰¾é‡å¿ƒï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨+æ ‘
110. åˆ¤æ–­å¹³è¡¡äºŒå‰æ ‘ï½œæ ‘æ˜¯ä¸æ˜¯"æ­ªè„–å­"ï¼Ÿï½œæ£€æŸ¥ä»»æ„å­æ ‘ä¸¤å‰æ·±åº¦å·®â‰¤1ï¼Œåƒçœ‹ç›†æ™¯å¹³è¡¡ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
111. äºŒå‰æ ‘çš„æœ€å°æ·±åº¦ï½œæ ‘æœ€æµ…åˆ°æ ¹å¶å­å‡ æ­¥ï¼Ÿï½œBFSæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¶å­å³åœï¼Œåƒè¿·å®«æœ€çŸ­å‡ºå£ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+æ ‘
112. è·¯å¾„æ€»å’Œï½œæ ¹åˆ°å¶å­æœ‰æ²¡æœ‰ä¸€æ¡"åˆšå¥½"é’±æ•°çš„è·¯å¾„ï¼Ÿï½œDFSä¸€è·¯æ‰£æé’±ï¼Œåˆ°å¶å­çœ‹é’±åŒ…ç©ºä¸ç©ºï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-DFSï¼›æ•°æ®ç»“æ„ï¼šæ ‘
113. è·¯å¾„æ€»å’ŒIIï½œæŠŠæ‰€æœ‰åˆšå¥½èŠ±å…‰é’±çš„è·¯å¾„éƒ½è®°ä¸‹æ¥ï½œDFSèµ°åˆ°å¶å­è‹¥æ¸…é›¶ï¼Œåˆ™æ‹ç…§ç•™å¿µï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-DFSï¼›æ•°æ®ç»“æ„ï¼šæ ‘+æ•°ç»„
114. äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨ï½œæŠŠæ ‘å‹æˆå³æ–œ"ç³–è‘«èŠ¦"ï½œååºå…ˆå‹å·¦å³ï¼Œå†æŠŠå·¦å­æ ‘æŒ‚åˆ°å³ä¸‹ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-DFSï¼›æ•°æ®ç»“æ„ï¼šæ ‘
115. ä¸åŒçš„å­åºåˆ—ï½œå­—ç¬¦ä¸²Tåœ¨Sé‡Œèƒ½"è·³æˆ¿å­"å‡ æ¬¡ï¼Ÿï½œDPè·³æ£‹ç›˜ï¼ŒåŒ¹é…åˆ™ç»§æ‰¿å·¦ä¸Šï¼Œå¦åˆ™ç»§æ‰¿ä¸Šæ–¹ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
116. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆIï½œæŠŠæ»¡äºŒå‰æ ‘æ¯å±‚è¿"æ¨ªä¸"ï½œBFSé˜Ÿåˆ—åƒä¸²çç ï¼Œå·¦å³é‚»å±…ç‰µæ‰‹ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+æ ‘
117. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆIIï½œæ™®é€šäºŒå‰æ ‘ä¹Ÿè¿æ¨ªä¸ï½œç”¨"ä¸Šä¸€å±‚çš„æ¨ªä¸"å½“é“¾è¡¨ï¼ŒèŠ‚çœé˜Ÿåˆ—ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨+æ ‘
118. æ¨è¾‰ä¸‰è§’ï½œæ‰“å°æ¨è¾‰ä¸‰è§’ï½œæ¯è¡Œä¸¤ç«¯æ”¾1ï¼Œä¸­é—´æ˜¯ä¸Šä¸€è¡Œä¸¤è‚©ç›¸åŠ ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
119. æ¨è¾‰ä¸‰è§’IIï½œåªè¦ç¬¬kè¡Œï½œæ»šåŠ¨æ•°ç»„ï¼Œåªå­˜å½“å‰è¡Œï¼ŒåƒæŠ˜æ‰‡åªå±•å¼€ä¸€å±‚ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
120. ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œï½œä»ä¸‰è§’å¡”é¡¶å¾€ä¸‹èµ°ï¼Œå’Œæœ€å°ï¼Ÿï½œè‡ªåº•å‘ä¸ŠDPï¼Œåƒå ç§¯æœ¨ï¼Œæ¯å±‚é€‰ä¾¿å®œåº•åº§ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºï½œä½ä¹°é«˜å–ä¸€æ¬¡ï¼Œæœ€å¤§å·®ï¼Ÿï½œä¸€æ¬¡éå†ï¼Œè®°å½•å†å²æœ€ä½ï¼Œä»Šå¤©å–èƒ½èµšå¤šå°‘ï½œç®—æ³•æ€æƒ³ï¼šè´ªå¿ƒï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIIï½œå¯ä»¥å¤šæ¬¡ä¹°å–ï¼Œå½“å¤©å¯å–å†ä¹°ï½œåªè¦æ˜å¤©æ¯”ä»Šå¤©è´µå°±ä»Šå¤©ä¹°æ˜å¤©å–ï¼Œåƒ"æ¬ç –å¥—åˆ©"ï½œç®—æ³•æ€æƒ³ï¼šè´ªå¿ƒï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIIIï½œæœ€å¤šä¸¤æ¬¡äº¤æ˜“ï½œDPå››çŠ¶æ€ï¼šç¬¬ä¸€æ¬¡ä¹°ã€å–ã€ç¬¬äºŒæ¬¡ä¹°ã€å–ï¼Œåƒä¸¤æ¡å¿ƒè·³æ›²çº¿ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
124. äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œï½œäºŒå‰æ ‘ä»»æ„è·¯å¾„æœ€å¤§å’Œï½œååºéå†ï¼Œå·¦å³å­æ ‘è´¡çŒ®æ­£æ•°ï¼Œåƒ"æ ‘æå¿«é€’"åªé€ä¸äºæœ¬çš„ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šæ ‘
125. éªŒè¯å›æ–‡ä¸²ï½œè¿‡æ»¤åæ˜¯å¦å›æ–‡ï¼Ÿï½œåŒæŒ‡é’ˆä»ä¸¤å¤´å¾€ä¸­é—´å¤¹ï¼Œåƒåƒç”˜è”—å‰¥å¶å­ï½œç®—æ³•æ€æƒ³ï¼šåŒæŒ‡é’ˆï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
126. å•è¯æ¥é¾™IIï½œå­—å…¸é‡Œå˜å•è¯ï¼Œæœ€çŸ­æ‰€æœ‰è·¯å¾„ï½œBFSå»ºå›¾+DFSå›æº¯ï¼Œåƒåœ°é“æ¢ä¹˜æ‰€æœ‰æœ€çŸ­è·¯çº¿ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†+å›æº¯ï¼›æ•°æ®ç»“æ„ï¼šå›¾+é˜Ÿåˆ—
127. å•è¯æ¥é¾™ï½œåªæƒ³è¦æœ€çŸ­é•¿åº¦ï½œå•å‘/åŒå‘BFSï¼Œåƒä¸¤æŸæ¿€å…‰å¯¹å°„ç¢°å¤´ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-BFSï¼›æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—+å“ˆå¸Œè¡¨
128. æœ€é•¿è¿ç»­åºåˆ—ï½œæ— åºæ•°ç»„æœ€é•¿è¿ç»­æ•°åˆ—ï½œå“ˆå¸Œè¡¨å½“"æŠ½å±‰"ï¼Œå…ˆå…¨æ”¾å†O(n)æ‰¾æ¯ä¸ªæ•°åˆ—å¼€å¤´ï½œç®—æ³•æ€æƒ³ï¼šå“ˆå¸Œï¼›æ•°æ®ç»“æ„ï¼šå“ˆå¸Œè¡¨
129. æ±‚æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹æ•°å­—ä¹‹å’Œï½œæ ¹åˆ°å¶å­è·¯å¾„æ•°å­—å’Œï½œDFSä¸€è·¯æ‹¼æ•°å­—ï¼Œåˆ°å¶å­åŠ æ€»ï¼Œåƒ"æ‹¨å·ç›˜"ç´¯è®¡ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-DFSï¼›æ•°æ®ç»“æ„ï¼šæ ‘
130. è¢«å›´ç»•çš„åŒºåŸŸï½œæ£‹ç›˜è¾¹ç•ŒOä¸ä¼šåŒ…å›´çš„Xæ‰å˜Oï½œå…ˆDFSè¾¹ç•ŒOåš"æ•‘ç”Ÿåœˆ"ï¼Œå†æ‰«æä¸­é—´æ²‰çš„ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-DFSï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
131. åˆ†å‰²å›æ–‡ä¸²ï½œæŠŠå­—ç¬¦ä¸²åˆ‡æˆæ¯å—éƒ½æ˜¯å›æ–‡ï½œå›æº¯+DPé¢„å¤„ç†å›æ–‡ï¼Œåƒåˆ‡è›‹ç³•å…ˆç”»è™šçº¿ï½œç®—æ³•æ€æƒ³ï¼šå›æº¯ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
132. åˆ†å‰²å›æ–‡ä¸²IIï½œæœ€å°‘åˆ‡å‡ åˆ€èƒ½å…¨å›æ–‡ï½œDPï¼šè‹¥s[i..j]å›æ–‡åˆ™dp[j]=min(dp[j],dp[i-1]+1)ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
133. å…‹éš†å›¾ï½œæ·±åº¦æ‹·è´æ— å‘å›¾ï½œDFS/BFS+å“ˆå¸Œ"å½±å°"èŠ‚ç‚¹ï¼Œåƒå¤å°æœºè¾¹ç¿»é¡µè¾¹å½±å°ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†ï¼›æ•°æ®ç»“æ„ï¼šå›¾+å“ˆå¸Œè¡¨
134. åŠ æ²¹ç«™ï½œç¯å½¢è·¯æ²¹ç«™èƒ½å¦è·‘ä¸€åœˆï½œæ€»æ²¹â‰¥æ€»è€—å³å¯ï¼Œèµ·ç‚¹æ‰¾"äºç©º"åä¸€ç«™ï¼Œåƒæ¥åŠ›æ£’æ‰¾èµ·è·‘ç‚¹ï½œç®—æ³•æ€æƒ³ï¼šè´ªå¿ƒï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
135. åˆ†å‘ç³–æœï½œåˆ†ç³–æœï¼Œè¯„åˆ†é«˜çš„æ¯”é‚»å±…å¤šï½œä¸¤éè´ªå¿ƒï¼šå·¦â†’å³ä¿è¯å³é‚»å±…ï¼Œå³â†’å·¦ä¿è¯å·¦é‚»å±…ï½œç®—æ³•æ€æƒ³ï¼šè´ªå¿ƒï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
136. åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï½œä¼—æ•°æˆåŒï¼Œè½å•æ˜¯è°ï¼Ÿï½œå…¨å‘˜å¼‚æˆ–ï¼Œç›¸åŒå½’é›¶ï¼Œè½å•ç°èº«ï½œç®—æ³•æ€æƒ³ï¼šæ•°å­¦ä½è¿ç®—ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
137. åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—IIï½œä¸‰ä¸ªæ•°æˆå¯¹ï¼Œè½å•æ˜¯è°ï¼Ÿï½œä½è®¡æ•°æ¨¡3ï¼Œåƒ"ä¸‰è¿›åˆ¶"é‡Œæ‰¾ä½™1ä½ï½œç®—æ³•æ€æƒ³ï¼šæ•°å­¦ä½è¿ç®—ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„
138. å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨ï½œé“¾è¡¨å¸¦éšæœºæŒ‡é’ˆæ·±æ‹·è´ï½œç¬¬ä¸€æ¬¡ä¸²nextå¹¶å»ºå“ˆå¸Œï¼Œç¬¬äºŒæ¬¡è¡¥randomï¼Œåƒå…ˆæ­éª¨æ¶å†è¿ç¥ç»ï½œç®—æ³•æ€æƒ³ï¼šå“ˆå¸Œï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨+å“ˆå¸Œè¡¨
139. å•è¯æ‹†åˆ†ï½œå­—å…¸èƒ½å¦æ‹¼å‡ºå­—ç¬¦ä¸²ï¼Ÿï½œDPï¼šs[0..i]å¯æ‹¼å½“å­˜åœ¨j<iä¸”s[j+1..i]åœ¨å­—å…¸ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„+å“ˆå¸Œè¡¨
140. å•è¯æ‹†åˆ†IIï½œæ‹¼æ³•æ‰€æœ‰å¥å­ï½œDPé¢„å¤„ç†å¯è¡Œ+å›æº¯æ‹¼å¥å­ï¼Œåƒå…ˆç­›ä¹é«˜åº•åº§å†æ­é€ å‹ï½œç®—æ³•æ€æƒ³ï¼šåŠ¨æ€è§„åˆ’+å›æº¯ï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„+å“ˆå¸Œè¡¨
141. ç¯å½¢é“¾è¡¨ï½œé“¾è¡¨æœ‰ç¯å—ï¼Ÿï½œå¿«æ…¢æŒ‡é’ˆï¼Œåƒè·‘é“å¥—åœˆï¼Œç›¸é‡åˆ™æœ‰ç¯ï½œç®—æ³•æ€æƒ³ï¼šåŒæŒ‡é’ˆï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨
142. ç¯å½¢é“¾è¡¨IIï½œç¯èµ·ç‚¹åœ¨å“ªï¼Ÿï½œå¿«æ…¢ç›¸é‡åï¼Œæ…¢å›å¤´åˆ°èµ·ç‚¹ï¼Œå†åŒæ­¥èµ°åˆ°ç¯å£ï½œç®—æ³•æ€æƒ³ï¼šåŒæŒ‡é’ˆï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨
143. é‡æ’é“¾è¡¨ï½œé“¾è¡¨L0â†’Lnâ†’L1â†’Ln-1â€¦é‡æ’ï½œæ‰¾ä¸­ç‚¹+åè½¬ååŠ+åˆå¹¶ï¼ŒåƒæŠ˜æ‰‡æ”¶æ‹¢å†ç©¿æ’ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»+é“¾è¡¨æ“ä½œï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨
144. äºŒå‰æ ‘çš„å‰åºéå†ï½œæ ¹å·¦å³é¡ºåºè¾“å‡ºï½œé€’å½’/è¿­ä»£æ ˆï¼Œåƒæ¢é™©å…ˆæ’æ——å†æ¢å·¦å³ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-DFSï¼›æ•°æ®ç»“æ„ï¼šæ ‘+æ ˆ
145. äºŒå‰æ ‘çš„ååºéå†ï½œå·¦å³æ ¹é¡ºåºè¾“å‡ºï½œé€’å½’/è¿­ä»£ï¼Œåƒæ¸…ç†æˆ˜åœºå…ˆæ¸…å·¦å³å†æ±‡æŠ¥ï½œç®—æ³•æ€æƒ³ï¼šå›¾éå†-DFSï¼›æ•°æ®ç»“æ„ï¼šæ ‘+æ ˆ
146. LRUç¼“å­˜ï½œæœ€è¿‘æœ€å°‘ç”¨ç¼“å­˜ï½œå“ˆå¸Œ+åŒå‘é“¾è¡¨ï¼Œåƒä¹¦æ¶+ä¾¿ç­¾ï¼Œç”¨å®Œæ”¾æœ€å‰ï¼Œæ»¡æ—¶æ‰”æœ«å°¾ï½œç®—æ³•æ€æƒ³ï¼šå“ˆå¸Œ+é“¾è¡¨ï¼›æ•°æ®ç»“æ„ï¼šå“ˆå¸Œè¡¨+åŒå‘é“¾è¡¨
147. å¯¹é“¾è¡¨è¿›è¡Œæ’å…¥æ’åºï½œé“¾è¡¨æ’å…¥æ’åºï½œæ–­é“¾é‡æ’ï¼Œåƒæ‰“æ‰‘å…‹æ‘¸ä¸€å¼ æ’ä¸€å¼ ï½œç®—æ³•æ€æƒ³ï¼šæš´åŠ›æšä¸¾ï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨
148. æ’åºé“¾è¡¨ï½œé“¾è¡¨å½’å¹¶æ’åºï½œå¿«æ…¢æ‰¾ä¸­ç‚¹+å½’å¹¶ï¼ŒåƒæŠŠçç é“¾å…ˆæ°åŠå†åˆå¹¶ï½œç®—æ³•æ€æƒ³ï¼šåˆ†æ²»ï¼›æ•°æ®ç»“æ„ï¼šé“¾è¡¨
149. ç›´çº¿ä¸Šæœ€å¤šçš„ç‚¹æ•°ï½œå¹³é¢ä¸Šæœ€å¤šç‚¹å…±çº¿ï½œå¯¹æ¯ç‚¹æè§’æ’åºï¼Œæ»‘åŠ¨çª—å£æ•°åŒæ–œç‡ï¼Œåƒé›·è¾¾æ‰«å°„ï½œç®—æ³•æ€æƒ³ï¼šæš´åŠ›æšä¸¾+å“ˆå¸Œï¼›æ•°æ®ç»“æ„ï¼šæ•°ç»„+å“ˆå¸Œè¡¨
150. é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ï½œåç¼€è¡¨è¾¾å¼æ±‚å€¼ï½œæ ˆå½“"ç®—ç›˜"ï¼Œé‡æ•°å‹æ ˆï¼Œé‡ç¬¦å¼¹ä¸¤æ•°ç®—å®Œå‹å›ï½œç®—æ³•æ€æƒ³ï¼šæ ˆï¼›æ•°æ®ç»“æ„ï¼šæ ˆ
EOF

# åˆ›å»ºåŠ›æ‰£é¢˜ç›®éšæœºæ˜¾ç¤ºè„šæœ¬
cat > $PREFIX/2025/leetcode.sh <<'EOF'
#!/data/data/com.termux/files/usr/bin/bash
FILE="$PREFIX/2025/leetcode_short.txt"
if [ -f "$FILE" ]; then
    echo
    echo
    line=$(shuf -n 1 "$FILE")
    IFS='ï½œ' read -ra parts <<< "$line"
    echo "ã€\${parts[0]}ã€‘"
    echo "é¢˜ç›®è¯´æ˜ï¼š\${parts[1]}"
    echo "æ€è·¯è¯´æ˜ï¼š\${parts[2]}"
    echo "ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼š\${parts[3]}"
else
    echo "Leetcode file not found."
fi
EOF

# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x $PREFIX/2025/leetcode.sh

# æ³¨å…¥åˆ°.bashrcï¼ˆåªæ·»åŠ åŠ›æ‰£éƒ¨åˆ†ï¼‰
sed -i '\\|$PREFIX/2025/leetcode.sh|d' $HOME/.bashrc
echo '$PREFIX/2025/leetcode.sh' >> $HOME/.bashrc

echo "åŠ›æ‰£åŠŸèƒ½æ·»åŠ å®Œæˆï¼é‡å¯Termuxæˆ–è¿è¡Œ 'source ~/.bashrc' æŸ¥çœ‹æ•ˆæœã€‚"
######################### æ·»åŠ åŠ›æ‰£åŠŸèƒ½ end #########################`,
  type: 'bash',
  varName: 'aa',
  size: 6916
};
var ab = {
  index: 2,
  filename: '1. æœ¬åœ°æœåŠ¡/A. çŒœæ•°å­—ï¼ˆè·å–è¾“å…¥ï¼‰.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/1. æœ¬åœ°æœåŠ¡/A. çŒœæ•°å­—ï¼ˆè·å–è¾“å…¥ï¼‰.bash',
  content: `#!/data/data/com.termux/files/usr/bin/bash
# TermuxçŒœæ•°å­—æ¸¸æˆ
# ä½œè€…ï¼šæ ¹æ®ä½ çš„éœ€æ±‚å®šåˆ¶
# L.è¯´æ˜ ï¼Œåç»­å¯è‡ªè¡Œæ‹“å±•ã€‚çŒœè€å¸ˆï¼ŒçŒœå¯¹è·³è½¬ç½‘å€ã€‚è‡ªå·±åˆ·é¢˜ï¼Œ100é“ç­‰

echo "ğŸ¯ æ¬¢è¿æ¥åˆ°TermuxçŒœæ•°å­—æ¸¸æˆï¼"
echo "================================"

# ç”Ÿæˆ1-100ä¹‹é—´çš„éšæœºæ•°
target=$(( RANDOM % 100 + 1 ))
attempts=0
max_attempts=10

echo "æˆ‘å·²ç»æƒ³äº†ä¸€ä¸ª1åˆ°100ä¹‹é—´çš„ç¥ç§˜æ•°å­—ã€‚"
echo "ä½ æœ‰ $max_attempts æ¬¡æœºä¼šçŒœä¸­å®ƒï¼"
echo ""

while [ $attempts -lt $max_attempts ]; do
    remaining=$((max_attempts - attempts))
    echo "ğŸ“Š ä½ è¿˜å‰© $remaining æ¬¡æœºä¼š"
    read -p "è¯·è¾“å…¥ä½ çŒœçš„æ•°å­—ï¼ˆ1-100ï¼‰: " guess
    
    # æ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸ºæ•°å­—
    if ! [[ "$guess" =~ ^[0-9]+$ ]]; then
        echo "âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—ï¼"
        continue
    fi
    
    guess=$((guess))
    attempts=$((attempts + 1))
    
    if [ $guess -eq $target ]; then
        echo "ğŸ‰ æ­å–œä½ ï¼çŒœå¯¹äº†ï¼"
        echo "âœ… ä½ ç”¨äº† $attempts æ¬¡çŒœä¸­äº†æ•°å­— $target"
        break
    elif [ $guess -lt $target ]; then
        echo "ğŸ“ˆ å¤ªå°äº†ï¼å¾€å¤§ç‚¹çŒœã€‚"
    else
        echo "ğŸ“‰ å¤ªå¤§äº†ï¼å¾€å°ç‚¹çŒœã€‚"
    fi
    
    # ç»™å‡ºæç¤º
    difference=$((guess - target))
    if [ \${difference#-} -le 5 ]; then
        echo "ğŸ”¥ éå¸¸æ¥è¿‘äº†ï¼"
    elif [ \${difference#-} -le 15 ]; then
        echo "ğŸ’¡ æœ‰ç‚¹æ¥è¿‘äº†ï¼"
    fi
    echo ""
done

if [ $attempts -eq $max_attempts ] && [ $guess -ne $target ]; then
    echo "ğŸ’€ æ¸¸æˆç»“æŸï¼æ•°å­—æ˜¯ $target"
    echo "ğŸ’¡ ä¸‹æ¬¡è¿æ°”ä¼šæ›´å¥½ï¼"
fi

echo ""
echo "æ„Ÿè°¢æ¸¸ç©ï¼"
`,
  type: 'bash',
  varName: 'ab',
  size: 1231
};
var ac = {
  index: 3,
  filename: '1. æœ¬åœ°æœåŠ¡/B.  91å­¦ä¹ è§†é¢‘è½¬PDF.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/1. æœ¬åœ°æœåŠ¡/B.  91å­¦ä¹ è§†é¢‘è½¬PDF.bash',
  content: `ä¸€  éœ€æ±‚åˆ†æ
1. éœ€æ±‚ï¼šè§†é¢‘è½¬PDFå·¥å…·ï¼Œæˆ‘ä»¬å®¶ä¸‹è½½çš„91å­¦ä¹ è§†é¢‘ã€Œ1991å¹´æ•°å­¦è§†é¢‘ã€ï¼Œè½¬PDF

2. åŠŸèƒ½ï¼šå°†è§†é¢‘æ–‡ä»¶æ¯éš”10ç§’æå–ä¸€å¸§å›¾ç‰‡ï¼Œåˆå¹¶ç”ŸæˆPDFæ–‡æ¡£

3. æ‰§è¡Œæµç¨‹ï¼š
   1. ffmpegæŒ‰æ—¶é—´é—´éš”æå–è§†é¢‘å¸§ä¸ºJPGå›¾ç‰‡
   2. ImageMagickå°†å›¾ç‰‡åºåˆ—åˆå¹¶ä¸ºPDFæ–‡ä»¶
   3. æ¸…ç†ä¸´æ—¶æ–‡ä»¶å¹¶è¾“å‡ºç»“æœ
   
äºŒ   ä»£ç  
 #!/data/data/com.termux/files/usr/bin/bash
# è®¾ç½®è·¯å¾„
INPUT_VIDEO="/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/è„šæœ¬/2025-ouikk-4.mp4"
OUTPUT_DIR="$(dirname "$INPUT_VIDEO")/temp_frames"
PDF_OUTPUT="\${INPUT_VIDEO%.mp4}.pdf"

echo "å¼€å§‹å¤„ç†è§†é¢‘: $INPUT_VIDEO"
echo "è¾“å‡ºç›®å½•: $OUTPUT_DIR"
echo "PDFè¾“å‡º: $PDF_OUTPUT"

# åˆ›å»ºä¸´æ—¶ç›®å½•
mkdir -p "$OUTPUT_DIR"
cd "$(dirname "$INPUT_VIDEO")"

# æå–å¸§ï¼ˆæ¯10ç§’ä¸€å¸§ï¼‰
echo "æ­£åœ¨æå–è§†é¢‘å¸§..."
ffmpeg -v error -i "$INPUT_VIDEO" -vf "fps=1/10" -q:v 2 "temp_frames/frame_%04d.jpg"

# æ£€æŸ¥æå–ç»“æœ
FRAME_COUNT=$(ls "$OUTPUT_DIR"/*.jpg 2>/dev/null | wc -l)
if [ $FRAME_COUNT -eq 0 ]; then
    echo "âŒ é”™è¯¯ï¼šæœªæå–åˆ°ä»»ä½•å¸§ï¼"
    echo "å¯èƒ½åŸå› ï¼š"
    echo "1. è¾“å…¥è§†é¢‘è·¯å¾„ä¸æ­£ç¡®"
    echo "2. ffmpegæœªæ­£ç¡®å®‰è£…"
    echo "3. è§†é¢‘æ ¼å¼ä¸æ”¯æŒ"
    exit 1
else
    echo "âœ… æˆåŠŸæå– $FRAME_COUNT å¸§å›¾åƒ"
fi

# åˆå¹¶ä¸ºPDF
echo "æ­£åœ¨åˆå¹¶å¸§ä¸ºPDF..."
cd "temp_frames"
mapfile -t FRAMES < <(ls *.jpg 2>/dev/null | sort)
magick "\${FRAMES[@]}" "$PDF_OUTPUT"

# æ¸…ç†
cd ..
rm -rf "temp_frames"

echo "âœ… PDFåˆå¹¶å®Œæˆ: $PDF_OUTPUT"
echo "âœ… æ–‡ä»¶å¤§å°: $(du -h "$PDF_OUTPUT" | cut -f1)"
`,
  type: 'bash',
  varName: 'ac',
  size: 1195
};
var ad = {
  index: 4,
  filename: '1. æœ¬åœ°æœåŠ¡/B. åŠ å¯†91å­¦ä¹ è§†é¢‘.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/1. æœ¬åœ°æœåŠ¡/B. åŠ å¯†91å­¦ä¹ è§†é¢‘.bash',
  content: `éœ€æ±‚ï¼Œè¿˜åœ¨æ‹…å¿ƒè§†é¢‘è¢«ç™¾åº¦ç½‘ç›˜è¿…é›·å°æ€å—ï¼Ÿ

è„šæœ¬01  åŠ å¯†91è§†é¢‘ ï¼Œå…¨éƒ¨MP4è½¬TXT
#!/data/data/com.termux/files/usr/bin/bash
cd "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/è„šæœ¬/02 ä¸å¯æè¿°/A" || exit 1
find . -type f -iname '*.mp4' -exec sh -c 'mv "$1" "\${1%.mp4}.txt"' _ {} \\;



è„šæœ¬02  è§£å¯†91è§†é¢‘ï¼Œå…¨éƒ¨TXTè½¬MP4
#!/data/data/com.termux/files/usr/bin/bash
cd "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/è„šæœ¬/02 ä¸å¯æè¿°/A" || exit 1
find . -type f -iname '*.txt' -exec sh -c 'mv "$1" "\${1%.txt}.mp4"' _ {} \\;
`,
  type: 'bash',
  varName: 'ad',
  size: 486
};
var ae = {
  index: 5,
  filename: '2. ç½‘ç»œçˆ¬å–/3.  åˆ¤æ–­91è§†é¢‘æ˜¯å¦å¤±æ•ˆ.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/3.  åˆ¤æ–­91è§†é¢‘æ˜¯å¦å¤±æ•ˆ.bash',
  content: ` # åˆ¤æ–­è§†é¢‘æ˜¯å¦å¤±æ•ˆï¼Œï¼Œï¼Œæˆ–è€…æ‰«æç«¯å£ä¸‹çš„èµ„æºã€‚
base="https:è§†é¢‘é“¾æ¥"
outdir="/storage/emulated/0/Download/OnePlus Share"
outfile="$outdir/scan_result.txt"
mkdir -p "$outdir"; >"$outfile"

for ((i=87000;i<=87200;i++)); do
  url="$base/$i/index.m3u8"
  # å‘ GETï¼Œåªæ‹‰ 1k å­—èŠ‚ï¼Œå¸¦è·³è½¬
  resp=$(curl -s -r 0-1023 -L --max-time 5 "$url")
  # ç®€å•åˆ¤æ–­ï¼šè¿”å›é‡Œå‡ºç° #EXTM3U å°±è¯´æ˜æ˜¯åˆæ³• m3u8
  if grep -q "^#EXTM3U" <<<"$resp"; then
    echo "[OK]  $url" | tee -a "$outfile"
  else
    echo "[404] $url" >> "$outfile"
  fi
done
echo "æ‰«æå®Œæˆï¼Œç»“æœå·²ä¿å­˜åˆ°ï¼š$outfile"`,
  type: 'bash',
  varName: 'ae',
  size: 496
};
var af = {
  index: 6,
  filename: '2. ç½‘ç»œçˆ¬å–/3. çˆ¬å–91 å­¦ä¹ èµ„æ–™ç½‘ç«™.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/3. çˆ¬å–91 å­¦ä¹ èµ„æ–™ç½‘ç«™.bash',
  content: `éœ€æ±‚    çˆ¬å–91è§†é¢‘ å­¦ä¹ ç½‘ç«™
ä¿®æ”¹    è¾“å…¥åœ°å€ã€‚ä¿å­˜ç›®å½•åœ°å€ã€‚  ã€Œè§†é¢‘åœ°å€å¯ä»¥åœ¨æºç ä¸­è·å¾—ã€‚ã€
æœªå®Œæˆ  æ²¡æœ‰é’ˆå¯¹ä¸‹è½½é€Ÿåº¦ä¼˜åŒ–ï¼Œæ²¡æœ‰å¯¹è§‚çœ‹é™é¢è¿›è¡Œä¼˜åŒ–ï¼Œ   æ²¡æœ‰æ›´æ¢å…¬ç½‘IPï¼Œæ¢æºç­‰

ä¸€.  æºç 
ffmpeg -loglevel error -stats -progress pipe:1 \\
  -user_agent "Mozilla/5.0 (Linux; Android 10; SM-G973F) AppleWebKit/537.36" \\
  -i "è§†é¢‘ç½‘ç«™åœ°å€ï¼Œ18ï¼‹æ•™å­¦è§†é¢‘ï¼Œæœªæˆå¹´äººä¸å¯è§‚çœ‹ã€Œè¾“å…¥ä½ è‡ªå·±çš„åœ°å€ğŸ’ŠğŸ’ŠğŸ’Šã€" \\
  -c copy \\
  "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/è„šæœ¬/2025-ouikk-4.mp4" 2>&1 | \\
awk -F'=' '/^progress=end/ {print; fflush(); exit}
           /^progress=/    {print; fflush()}
           /^size=|^time=/ {printf "%s  ", $0; fflush()}' | \\
while read -r line; do echo "$(date '+%H:%M:%S')  $line"; sleep 10; done


äºŒ.   ä»£ç è§£æ
ffmpeg -loglevel error -stats -progress pipe:1 \\
# ffmpeg: å¤šåª’ä½“å¤„ç†å·¥å…·
# -loglevel error: åªæ˜¾ç¤ºé”™è¯¯æ—¥å¿—ï¼ˆerrorçº§åˆ«ï¼‰
# -stats: æ˜¾ç¤ºç¼–ç ç»Ÿè®¡ä¿¡æ¯
# -progress pipe:1: å°†è¿›åº¦ä¿¡æ¯è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆç®¡é“1ï¼‰
# \\: è¡Œç»­æ¥ç¬¦ï¼Œè¡¨ç¤ºå‘½ä»¤ç»§ç»­åˆ°ä¸‹ä¸€è¡Œ

  -user_agent "Mozilla/5.0 (Linux; Android 10; SM-G973F) AppleWebKit/537.36" \\
  # -user_agent: è®¾ç½®HTTPè¯·æ±‚çš„User-Agentå¤´éƒ¨
  # "Mozilla/...": æ¨¡æ‹ŸAndroidè®¾å¤‡çš„æµè§ˆå™¨æ ‡è¯†
  # \\: è¡Œç»­æ¥ç¬¦

  -i "è§†é¢‘ç½‘ç«™åœ°å€ï¼Œ18ï¼‹æ•™å­¦è§†é¢‘ï¼Œæœªæˆå¹´äººä¸å¯è§‚çœ‹ã€Œè¾“å…¥ä½ è‡ªå·±çš„åœ°å€ğŸ’ŠğŸ’ŠğŸ’Š    " \\
  # -i: æŒ‡å®šè¾“å…¥æ–‡ä»¶/URL
  # "https://...": HLSè§†é¢‘æµçš„m3u8ç´¢å¼•æ–‡ä»¶åœ°å€
  # \\: è¡Œç»­æ¥ç¬¦

  -c copy \\
  # -c copy: æµå¤åˆ¶æ¨¡å¼ï¼ˆä¸é‡æ–°ç¼–ç ï¼Œç›´æ¥å¤åˆ¶åŸå§‹æµï¼‰
  # \\: è¡Œç»­æ¥ç¬¦

  "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/è„šæœ¬/2025-ouikk-4.mp4" 2>&1 | \\
  # è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆAndroidè®¾å¤‡å­˜å‚¨è·¯å¾„ï¼‰
  # 2>&1: å°†æ ‡å‡†é”™è¯¯(stderr)é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º(stdout)
  # |: ç®¡é“ç¬¦ï¼Œå°†å‰å‘½ä»¤è¾“å‡ºä½œä¸ºåå‘½ä»¤è¾“å…¥

awk -F'=' '/^progress=end/ {print; fflush(); exit}
           # awk: æ–‡æœ¬å¤„ç†å·¥å…·
           # -F'=': è®¾ç½®å­—æ®µåˆ†éš”ç¬¦ä¸ºç­‰å·(=)
           # /^progress=end/: åŒ¹é…ä»¥"progress=end"å¼€å¤´çš„è¡Œ
           # {print; fflush(); exit}: æ‰“å°è¯¥è¡Œï¼Œç«‹å³åˆ·æ–°ç¼“å†²åŒºï¼Œç„¶åé€€å‡ºawk

           /^progress=/    {print; fflush()}
           # /^progress=/: åŒ¹é…ä»¥"progress="å¼€å¤´çš„è¡Œï¼ˆä¸å«endï¼‰
           # {print; fflush()}: æ‰“å°è¯¥è¡Œå¹¶åˆ·æ–°ç¼“å†²åŒº

           /^size=|^time=/ {printf "%s  ", $0; fflush()}' | \\
           # /^size=|^time=/: åŒ¹é…ä»¥"size="æˆ–"time="å¼€å¤´çš„è¡Œ
           # {printf "%s  ", $0}: æ‰“å°æ•´è¡Œå†…å®¹ï¼ˆæœ«å°¾åŠ ä¸¤ä¸ªç©ºæ ¼ï¼‰
           # fflush(): ç«‹å³åˆ·æ–°è¾“å‡ºç¼“å†²åŒº
           # |: ç®¡é“ç¬¦

while read -r line; do echo "$(date '+%H:%M:%S')  $line"; sleep 10; done
# while read -r line: é€è¡Œè¯»å–è¾“å…¥ï¼ˆ-ré˜²æ­¢åæ–œæ è½¬ä¹‰ï¼‰
# do...done: å¾ªç¯ä½“å¼€å§‹/ç»“æŸ
# echo "$(date '+%H:%M:%S')  $line": æ‰“å°å½“å‰æ—¶é—´(æ—¶:åˆ†:ç§’) + è¡Œå†…å®¹
# sleep 10: æ¯æ¬¡å¾ªç¯æš‚åœ10ç§’ï¼ˆæ§åˆ¶è¾“å‡ºé¢‘ç‡ï¼‰

`,
  type: 'bash',
  varName: 'af',
  size: 2146
};
var ag = {
  index: 7,
  filename: '2. ç½‘ç»œçˆ¬å–/4. æ‰«æç«¯å£å¹¶ä¸‹è½½91å­¦ä¹ è§†é¢‘ .bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/4. æ‰«æç«¯å£å¹¶ä¸‹è½½91å­¦ä¹ è§†é¢‘ .bash',
  content: `#!/data/data/com.termux/files/usr/bin/bash
# -*- coding: utf-8 -*-
# 87000 å›ºå®šï¼Œ87100-87200 éšåˆ°éšä¸‹
# å•çº¿ç¨‹ + æç®€æç¤º + è·³è¿‡ >500 MB æ–‡ä»¶

BASE_URL="https://è§†é¢‘åœ°å€ğŸ”—ğŸ”—ğŸ”—/87000"
START_ID=87100
END_ID=87200
SAVE_ROOT="/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/è„šæœ¬/02 ä¸å¯æè¿°"
UA="Mozilla/5.0 (Linux; Android 13; SM-G973F) AppleWebKit/537.36"

mkdir -p "$SAVE_ROOT"

#---- 1-2 ç§’å¿«é€Ÿä¼°ç®—å¤§å° ----
get_size_mb(){
  local m3u8="$1"
  seg=$(curl -sL -H "User-Agent: $UA" "$m3u8" | sed -n '/^[^#]/p' | head -1)
  [ -z "$seg" ] && { echo 0; return; }
  seg_url=$(dirname "$m3u8")/$seg

  # æ‹¿ bitrateï¼Œå¤±è´¥å°±ç»™ 1 Mbps
  br=$(curl -sL -r 0-1023 -H "User-Agent: $UA" "$seg_url" \\
       | ffprobe -v error -show_entries format=bit_rate -of csv=p=0 - 2>/dev/null)
  case "$br" in ''|*[!0-9]*) br=1000000 ;; esac

  # æ‹¿æ€»æ—¶é•¿ï¼Œå¤±è´¥ç»™ 0
  dur=$(curl -sL -H "User-Agent: $UA" "$m3u8" \\
        | awk -F: '/^#EXTINF:/{s+=$2} END{printf "%.0f",s}')
  [ -z "$dur" ] && dur=0

  echo $(( br * dur / 8 / 1024 / 1024 ))
}

for id in $(seq "$START_ID" "$END_ID"); do
  m3u8_url="$BASE_URL/$id/index.m3u8"

  curl -s -r 0-1023 -L --max-time 5 -H "User-Agent: $UA" "$m3u8_url" | grep -q "^#EXTM3U" || {
    echo "[è·³è¿‡] $id  æ— æ³•è·å– m3u8"; continue
  }

  folder_start=$((START_ID + ((id - START_ID) / 20) * 20))
  folder="$SAVE_ROOT/\${folder_start}-$((folder_start+19))"
  mkdir -p "$folder"
  out="$folder/$id.mp4"
  [ -f "$out" ] && { echo "[å­˜åœ¨] $id.mp4"; continue; }

  echo "[æ¢æµ‹] $id  ä¼°ç®—å¤§å°ä¸­..."
  size_mb=$(get_size_mb "$m3u8_url")
  [ "$size_mb" -gt 500 ] && {
    echo "[è·³è¿‡] $id  ä¼°ç®— \${size_mb}MB (>500MB)"; continue
  }

  echo "[ä¸‹è½½] $id  ä¼°ç®— \${size_mb}MB â†’ $out"
  ffmpeg -hide_banner -loglevel error -nostats -nostdin -y \\
    -user_agent "$UA" -i "$m3u8_url" -c copy "$out" && \\
    echo "[å®Œæˆ] $id.mp4" || echo "[å¤±è´¥] $id.mp4"
done

echo ">>> å…¨éƒ¨ç»“æŸï¼"
`,
  type: 'bash',
  varName: 'ag',
  size: 1805
};
var ah = {
  index: 8,
  filename: '3. é¡¹ç›®åˆ†æ/4. ctagsåˆ†ææ–‡ä»¶å¹¶ç¾åŒ–.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/4. ctagsåˆ†ææ–‡ä»¶å¹¶ç¾åŒ–.bash',
  content: `f="/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/[9] GPIOè¾“å‡ºä¸ç‚¹ç¯/Core/Src/main.c"
ctags --output-format=json --fields=+KnzSst --kinds-c=+cdefglmnpstuvxL --extras=+qF "$f" 2>/dev/null |
jq -r 'select(.name|startswith("__anon")|not) | (.kind+"\\t"+.name+"\\t"+(.scope//"-")+"\\t"+(.line|tostring)+"\\t"+(.static//"no"))' |
awk -v f="$f" '
BEGIN{
  print "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
  print "â”‚                    ç¬¦å·åˆ†ææŠ¥å‘Š                           â”‚"
  print "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
  print "â”‚ æ–‡ä»¶: " f
  print "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
}
# 1. å‡½æ•°åŸå‹æ”¾æœ€ä¸Š
$1=="prototype" {prototypes[++pcount] = $0; next}
# 2. å…¶ä½™æ‰€æœ‰å‡½æ•°å®šä¹‰ï¼ˆå…¨å±€å¯è§ï¼‰éƒ½å½’åˆ°"å…¨å±€å‡½æ•°"
$1=="function" && $3=="-" {functions[++fcount] = $0; next}
# 3. å˜é‡/å±€éƒ¨é‡/ç»“æ„ä½“ç­‰ä¿æŒåŸæ ·
$1=="macro"   {macros[++mcount] = $0; next}
$1=="struct"  {structs[++scount] = $0; next}
$1=="union"   {unions[++ucount] = $0; next}
$1=="enum"    {enums[++ecount] = $0; next}
$1=="enumerator"{enumerators[++evcount] = $0; next}
$1=="typedef" {typedefs[++tcount] = $0; next}
$1=="variable"&&$5=="yes"&&$3=="-"{static_globals[++sgcount] = $0; next}
$1=="variable"&&$5=="no"&&$3=="-" {globals[++gcount] = $0; next}
$1=="local"   {locals[++lcount] = $0; next}
END{
  # å…ˆè¾“å‡ºå‡½æ•°åŸå‹
  if (pcount > 0) {
    print "â”‚"
    print "â”‚ [å‡½æ•°åŸå‹]"
    for (i=1; i<=pcount; i++) {
      split(prototypes[i], parts, "\\t")
      printf "â”‚   %-40s (åŸå‹)\\n", parts[2]
    }
  }
  
  # ç„¶åè¾“å‡ºå…¨å±€å‡½æ•°
  if (fcount > 0) {
    print "â”‚"
    print "â”‚ [å…¨å±€å‡½æ•°]"
    for (i=1; i<=fcount; i++) {
      split(functions[i], parts, "\\t")
      printf "â”‚   %-40s (å‡½æ•°)\\n", parts[2]
    }
  }
  
  # è¾“å‡ºå…¶ä»–éƒ¨åˆ†
  if (mcount > 0) {
    print "â”‚"
    print "â”‚ [å®å®šä¹‰]"
    for (i=1; i<=mcount; i++) {
      split(macros[i], parts, "\\t")
      printf "â”‚   %-40s (å®)\\n", parts[2]
    }
  }
  if (scount > 0) {
    print "â”‚"
    print "â”‚ [ç»“æ„ä½“]"
    for (i=1; i<=scount; i++) {
      split(structs[i], parts, "\\t")
      printf "â”‚   %-40s (ç»“æ„ä½“)\\n", parts[2]
    }
  }
  if (ucount > 0) {
    print "â”‚"
    print "â”‚ [è”åˆä½“]"
    for (i=1; i<=ucount; i++) {
      split(unions[i], parts, "\\t")
      printf "â”‚   %-40s (è”åˆä½“)\\n", parts[2]
    }
  }
  if (ecount > 0) {
    print "â”‚"
    print "â”‚ [æšä¸¾ç±»å‹]"
    for (i=1; i<=ecount; i++) {
      split(enums[i], parts, "\\t")
      printf "â”‚   %-40s (æšä¸¾)\\n", parts[2]
    }
  }
  if (evcount > 0) {
    print "â”‚"
    print "â”‚ [æšä¸¾å€¼]"
    for (i=1; i<=evcount; i++) {
      split(enumerators[i], parts, "\\t")
      printf "â”‚   %-40s (æšä¸¾å€¼)\\n", parts[2]
    }
  }
  if (tcount > 0) {
    print "â”‚"
    print "â”‚ [ç±»å‹å®šä¹‰]"
    for (i=1; i<=tcount; i++) {
      split(typedefs[i], parts, "\\t")
      printf "â”‚   %-40s (typedef)\\n", parts[2]
    }
  }
  if (sgcount > 0) {
    print "â”‚"
    print "â”‚ [é™æ€å…¨å±€å˜é‡]"
    for (i=1; i<=sgcount; i++) {
      split(static_globals[i], parts, "\\t")
      printf "â”‚   %-40s (static å…¨å±€)\\n", parts[2]
    }
  }
  if (gcount > 0) {
    print "â”‚"
    print "â”‚ [å…¨å±€å˜é‡]"
    for (i=1; i<=gcount; i++) {
      split(globals[i], parts, "\\t")
      printf "â”‚   %-40s (å…¨å±€)\\n", parts[2]
    }
  }
  if (lcount > 0) {
    print "â”‚"
    print "â”‚ [å±€éƒ¨å˜é‡]"
    for (i=1; i<=lcount; i++) {
      split(locals[i], parts, "\\t")
      printf "â”‚   %-40s (å±€éƒ¨ï¼Œä½äº: %s)\\n", parts[2], parts[3]
    }
  }
  print "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
  print "ç¬¦å·åˆ†æå®Œæˆã€‚"
}'
`,
  type: 'bash',
  varName: 'ah',
  size: 3415
};
var ai = {
  index: 9,
  filename: '3. é¡¹ç›®åˆ†æ/5. ctagsåˆ†ææ–‡ä»¶å¹¶ç¾åŒ–ï¼ˆå•æ¨¡å—ï¼‰å¸¸ç”¨.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/5. ctagsåˆ†ææ–‡ä»¶å¹¶ç¾åŒ–ï¼ˆå•æ¨¡å—ï¼‰å¸¸ç”¨.bash',
  content: `TARGET_DIR="/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/[9] GPIOè¾“å‡ºä¸ç‚¹ç¯/Core"
REPORT="$TARGET_DIR/æ–‡ä»¶åˆ†ææŠ¥å‘Š.txt"

# æŠ¥å‘Šå¤´
{
  echo "æ–‡ä»¶åˆ†ææŠ¥å‘Š"
  echo "ç”Ÿæˆæ—¶é—´: $(date)"
  echo "========================================================="
  echo ""
} > "$REPORT"

# é€ä¸ªæ–‡ä»¶åˆ†æ
find "$TARGET_DIR" -type f \\( -name '*.c' -o -name '*.h' \\) | sort -V | nl -w1 -s'. ' | while read -r idx f; do
  # åªä¿ç•™æœ€åä¸‰çº§ç›®å½•
  short=$(echo "$f" | sed -E 's|.*(/[^/]+/[^/]+/[^/]+/[^/]+)$|\\1|')
  {
    echo ""
    echo "ğŸŸ¢ $idx $(basename "$f")"
    echo "ğŸ”»ğŸ”»ğŸ”»ğŸ”»ğŸ”»ğŸ”»ğŸ”»"
    echo "ğŸ“ $short"
    echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
    echo "â”‚                    æ–‡ä»¶åˆ†æ                               â”‚"
    echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
    echo "â”‚ æ–‡ä»¶: $short"
    echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"

    # ä»¥ä¸‹å®Œå…¨æ²¿ç”¨ä½ æœ€å¼€å§‹é‚£å¥— json æµæ°´çº¿
    ctags --output-format=json --fields=+KnzSst --kinds-c=+cdefglmnpstuvxL --extras=+qF "$f" 2>/dev/null |
    jq -r 'select(.name|startswith("__anon")|not) | (.kind+"\\t"+.name+"\\t"+(.scope//"-")+"\\t"+(.line|tostring)+"\\t"+(.static//"no"))' |
    awk '
    $1=="prototype" {prototypes[++pcount] = $0; next}
    $1=="function" && $3=="-" {functions[++fcount] = $0; next}
    $1=="macro"   {macros[++mcount] = $0; next}
    $1=="struct"  {structs[++scount] = $0; next}
    $1=="union"   {unions[++ucount] = $0; next}
    $1=="enum"    {enums[++ecount] = $0; next}
    $1=="enumerator"{enumerators[++evcount] = $0; next}
    $1=="typedef" {typedefs[++tcount] = $0; next}
    $1=="variable"&&$5=="yes"&&$3=="-"{static_globals[++sgcount] = $0; next}
    $1=="variable"&&$5=="no"&&$3=="-" {globals[++gcount] = $0; next}
    $1=="local"   {locals[++lcount] = $0; next}
    END{
      if (pcount > 0) {
        print "â”‚"; print "â”‚ [å‡½æ•°åŸå‹]"
        for (i=1; i<=pcount; i++) {split(prototypes[i], parts, "\\t"); printf "â”‚   %-40s (åŸå‹)\\n", parts[2]}
      }
      if (fcount > 0) {
        print "â”‚"; print "â”‚ [å…¨å±€å‡½æ•°]"
        for (i=1; i<=fcount; i++) {split(functions[i], parts, "\\t"); printf "â”‚   %-40s (å‡½æ•°)\\n", parts[2]}
      }
      if (mcount > 0) {
        print "â”‚"; print "â”‚ [å®å®šä¹‰]"
        for (i=1; i<=mcount; i++) {split(macros[i], parts, "\\t"); printf "â”‚   %-40s (å®)\\n", parts[2]}
      }
      if (scount > 0) {
        print "â”‚"; print "â”‚ [ç»“æ„ä½“]"
        for (i=1; i<=scount; i++) {split(structs[i], parts, "\\t"); printf "â”‚   %-40s (ç»“æ„ä½“)\\n", parts[2]}
      }
      if (ucount > 0) {
        print "â”‚"; print "â”‚ [è”åˆä½“]"
        for (i=1; i<=ucount; i++) {split(unions[i], parts, "\\t"); printf "â”‚   %-40s (è”åˆä½“)\\n", parts[2]}
      }
      if (ecount > 0) {
        print "â”‚"; print "â”‚ [æšä¸¾ç±»å‹]"
        for (i=1; i<=ecount; i++) {split(enums[i], parts, "\\t"); printf "â”‚   %-40s (æšä¸¾)\\n", parts[2]}
      }
      if (evcount > 0) {
        print "â”‚"; print "â”‚ [æšä¸¾å€¼]"
        for (i=1; i<=evcount; i++) {split(enumerators[i], parts, "\\t"); printf "â”‚   %-40s (æšä¸¾å€¼)\\n", parts[2]}
      }
      if (tcount > 0) {
        print "â”‚"; print "â”‚ [ç±»å‹å®šä¹‰]"
        for (i=1; i<=tcount; i++) {split(typedefs[i], parts, "\\t"); printf "â”‚   %-40s (typedef)\\n", parts[2]}
      }
      if (sgcount > 0) {
        print "â”‚"; print "â”‚ [é™æ€å…¨å±€å˜é‡]"
        for (i=1; i<=sgcount; i++) {split(static_globals[i], parts, "\\t"); printf "â”‚   %-40s (static å…¨å±€)\\n", parts[2]}
      }
      if (gcount > 0) {
        print "â”‚"; print "â”‚ [å…¨å±€å˜é‡]"
        for (i=1; i<=gcount; i++) {split(globals[i], parts, "\\t"); printf "â”‚   %-40s (å…¨å±€)\\n", parts[2]}
      }
      if (lcount > 0) {
        print "â”‚"; print "â”‚ [å±€éƒ¨å˜é‡]"
        for (i=1; i<=lcount; i++) {split(locals[i], parts, "\\t"); printf "â”‚   %-40s (å±€éƒ¨ï¼Œä½äº: %s)\\n", parts[2], parts[3]}
      }
      print "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      print ""
      print "========================================================="
    }'
  } >> "$REPORT"
done

echo "åˆ†æå®Œæˆï¼æŠ¥å‘Šå·²ä¿å­˜åˆ°ï¼š$REPORT"
`,
  type: 'bash',
  varName: 'ai',
  size: 3937
};
var aj = {
  index: 10,
  filename: '3. é¡¹ç›®åˆ†æ/6. é‡ç«å°æ™ºé¡¹ç›®åˆ†æï¼ˆAPIï¼‰.bash',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/6. é‡ç«å°æ™ºé¡¹ç›®åˆ†æï¼ˆAPIï¼‰.bash',
  content: `ä¸‹é¢è¿™æ®µ ç›´æ¥å¤åˆ¶è¿› Termux å›è½¦å³å¯è·‘ï¼š
1. ä¸€æ¬¡æ€§æ‰«æ
 /storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/ 
ä¸‹ æ‰€æœ‰ é¡¹ç›®æ–‡ä»¶å¤¹ï¼ˆä¸ç®¡ç¼–å·æ˜¯å¤šå°‘ï¼‰ï¼š
 
å¦‚æœç›®å½•é‡Œæœ‰  Core  â†’ æ‰«  Core 
 
å¦‚æœç›®å½•é‡Œæœ‰  User  â†’ æ‰«  User 
 
å¦‚æœç›®å½•é‡Œæœ‰  APP  â†’ æ‰«  APP 

2. æ¯ä¸ªé¡¹ç›®ç”Ÿæˆä¸€ä»½ ç‹¬ç«‹æŠ¥å‘Šï¼Œæ–‡ä»¶åå°±æ˜¯ é¡¹ç›®æ–‡ä»¶å¤¹åå­—.txtï¼Œç»Ÿä¸€æ”¾åˆ°ï¼š
 /storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/é¡¹ç›®åˆ†ææŠ¥å‘Š/ 
 
3. è·¯å¾„åªä¿ç•™æœ€åä¸‰çº§ï¼ŒæŠ¥å‘Šæ ¼å¼å’Œä½ åˆšæ‰ æœ€æ»¡æ„çš„é‚£ç‰ˆå®Œå…¨ä¸€è‡´ã€‚

# ä¸€æ¬¡æ€§å¤åˆ¶å³å¯
BASE="/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£"
OUT_DIR="$BASE/é¡¹ç›®åˆ†ææŠ¥å‘Š"
mkdir -p "$OUT_DIR"

# éå†æ‰€æœ‰é¡¹ç›®æ–‡ä»¶å¤¹
find "$BASE" -maxdepth 1 -type d ! -path "$BASE" | while read -r proj; do
  proj_name=$(basename "$proj")
  report_file="$OUT_DIR/\${proj_name}.txt"

  # å†³å®šåˆ°åº•æ‰«å“ªä¸ªå­ç›®å½•
  if   [ -d "$proj/Core" ]; then SCAN_DIR="$proj/Core"
  elif [ -d "$proj/User" ]; then SCAN_DIR="$proj/User"
  elif [ -d "$proj/APP"  ]; then SCAN_DIR="$proj/APP"
  else continue; fi

  # å†™æŠ¥å‘Šå¤´
  {
    echo "æ–‡ä»¶åˆ†ææŠ¥å‘Š"
    echo "ç”Ÿæˆæ—¶é—´: $(date)"
    echo "========================================================="
    echo ""
  } > "$report_file"

  # é€ä¸ªæ–‡ä»¶åˆ†æ
  find "$SCAN_DIR" -type f \\( -name '*.c' -o -name '*.h' \\) | sort -V | nl -w1 -s'. ' | while read -r idx f; do
    short=$(echo "$f" | sed -E 's|.*(/[^/]+/[^/]+/[^/]+/[^/]+)$|\\1|')
    {
      echo ""
      echo "ğŸŸ¢ $idx $(basename "$f")"
      echo "ğŸ”»ğŸ”»ğŸ”»ğŸ”»ğŸ”»ğŸ”»ğŸ”»"
      echo "ğŸ“ $short"
      echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
      echo "â”‚                    æ–‡ä»¶åˆ†æ                               â”‚"
      echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
      echo "â”‚ æ–‡ä»¶: $short"
      echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"

      ctags --output-format=json --fields=+KnzSst --kinds-c=+cdefglmnpstuvxL --extras=+qF "$f" 2>/dev/null |
      jq -r 'select(.name|startswith("__anon")|not) | (.kind+"\\t"+.name+"\\t"+(.scope//"-")+"\\t"+(.line|tostring)+"\\t"+(.static//"no"))' |
      awk '
      $1=="prototype" {prototypes[++pcount] = $0; next}
      $1=="function" && $3=="-" {functions[++fcount] = $0; next}
      $1=="macro"   {macros[++mcount] = $0; next}
      $1=="struct"  {structs[++scount] = $0; next}
      $1=="union"   {unions[++ucount] = $0; next}
      $1=="enum"    {enums[++ecount] = $0; next}
      $1=="enumerator"{enumerators[++evcount] = $0; next}
      $1=="typedef" {typedefs[++tcount] = $0; next}
      $1=="variable"&&$5=="yes"&&$3=="-"{static_globals[++sgcount] = $0; next}
      $1=="variable"&&$5=="no"&&$3=="-" {globals[++gcount] = $0; next}
      $1=="local"   {locals[++lcount] = $0; next}
      END{
        if (pcount > 0) {
          print "â”‚"; print "â”‚ [å‡½æ•°åŸå‹]"
          for (i=1; i<=pcount; i++) {split(prototypes[i], parts, "\\t"); printf "â”‚   %-40s (åŸå‹)\\n", parts[2]}
        }
        if (fcount > 0) {
          print "â”‚"; print "â”‚ [å…¨å±€å‡½æ•°]"
          for (i=1; i<=fcount; i++) {split(functions[i], parts, "\\t"); printf "â”‚   %-40s (å‡½æ•°)\\n", parts[2]}
        }
        if (mcount > 0) {
          print "â”‚"; print "â”‚ [å®å®šä¹‰]"
          for (i=1; i<=mcount; i++) {split(macros[i], parts, "\\t"); printf "â”‚   %-40s (å®)\\n", parts[2]}
        }
        if (scount > 0) {
          print "â”‚"; print "â”‚ [ç»“æ„ä½“]"
          for (i=1; i<=scount; i++) {split(structs[i], parts, "\\t"); printf "â”‚   %-40s (ç»“æ„ä½“)\\n", parts[2]}
        }
        if (ucount > 0) {
          print "â”‚"; print "â”‚ [è”åˆä½“]"
          for (i=1; i<=ucount; i++) {split(unions[i], parts, "\\t"); printf "â”‚   %-40s (è”åˆä½“)\\n", parts[2]}
        }
        if (ecount > 0) {
          print "â”‚"; print "â”‚ [æšä¸¾ç±»å‹]"
          for (i=1; i<=ecount; i++) {split(enums[i], parts, "\\t"); printf "â”‚   %-40s (æšä¸¾)\\n", parts[2]}
        }
        if (evcount > 0) {
          print "â”‚"; print "â”‚ [æšä¸¾å€¼]"
          for (i=1; i<=evcount; i++) {split(enumerators[i], parts, "\\t"); printf "â”‚   %-40s (æšä¸¾å€¼)\\n", parts[2]}
        }
        if (tcount > 0) {
          print "â”‚"; print "â”‚ [ç±»å‹å®šä¹‰]"
          for (i=1; i<=tcount; i++) {split(typedefs[i], parts, "\\t"); printf "â”‚   %-40s (typedef)\\n", parts[2]}
        }
        if (sgcount > 0) {
          print "â”‚"; print "â”‚ [é™æ€å…¨å±€å˜é‡]"
          for (i=1; i<=sgcount; i++) {split(static_globals[i], parts, "\\t"); printf "â”‚   %-40s (static å…¨å±€)\\n", parts[2]}
        }
        if (gcount > 0) {
          print "â”‚"; print "â”‚ [å…¨å±€å˜é‡]"
          for (i=1; i<=gcount; i++) {split(globals[i], parts, "\\t"); printf "â”‚   %-40s (å…¨å±€)\\n", parts[2]}
        }
        if (lcount > 0) {
          print "â”‚"; print "â”‚ [å±€éƒ¨å˜é‡]"
          for (i=1; i<=lcount; i++) {split(locals[i], parts, "\\t"); printf "â”‚   %-40s (å±€éƒ¨ï¼Œä½äº: %s)\\n", parts[2], parts[3]}
        }
        print "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        print ""
        print "========================================================="
      }'
    } >> "$report_file"
  done
done

echo "å…¨éƒ¨å®Œæˆï¼æŠ¥å‘Šå·²é›†ä¸­æ”¾åˆ°ï¼š$OUT_DIR"
`,
  type: 'bash',
  varName: 'aj',
  size: 4798
};
var ak = {
  index: 11,
  filename: '1. æœ¬åœ°æœåŠ¡/A. æ‰‹æœºè·‘ç®€æ˜“æœåŠ¡å™¨.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/1. æœ¬åœ°æœåŠ¡/A. æ‰‹æœºè·‘ç®€æ˜“æœåŠ¡å™¨.py',
  content: `éœ€æ±‚ï¼Œæ‰‹æœºå¯åŠ¨æœåŠ¡å™¨ã€‚å¹¶ä¸”å¯ä»¥åœ¨ç½‘ç«™ä¸­é“¾æ¥è¿™ä¸ªæœåŠ¡å™¨

ä¸€  ä»£ç éƒ¨åˆ†
python3 -x <<'EOF'
# -*- coding: utf-8 -*-
from http.server import HTTPServer, BaseHTTPRequestHandler as RH

class H(RH):
    def do_GET(self):
        self.send_response(200)
        self.end_headers()
        self.wfile.write('<html><meta charset=utf-8><body><h1>ä½ å¥½ä¸–ç•Œ</h1></body></html>'.encode('utf-8'))

HTTPServer(('', 8080), H).serve_forever()
EOF


äºŒ è®¿é—®ç½‘ç«™
http://127.0.0.1:8080


ä¸‰  ç®€å•ä¼˜åŒ–ï¼Œå¯åŒå‘é€šä¿¡
python3 -x <<'EOF'
# -*- coding: utf-8 -*-
import json
import socket
import subprocess
from http.server import HTTPServer, BaseHTTPRequestHandler
from socketserver import ThreadingMixIn
import threading

# å…¨å±€æ¶ˆæ¯é˜Ÿåˆ—å’Œé”
message_queue = []
queue_lock = threading.Lock()

class ThreadedHTTPServer(ThreadingMixIn, HTTPServer):
    """æ”¯æŒå¤šçº¿ç¨‹çš„HTTPæœåŠ¡å™¨"""

class RequestHandler(BaseHTTPRequestHandler):
    def _set_headers(self):
        self.send_response(200)
        self.send_header('Content-type', 'text/html; charset=utf-8')
        self.end_headers()
    
    def do_GET(self):
        if self.path == '/':
            self._set_headers()
            self.wfile.write(self._create_html().encode('utf-8'))
        elif self.path == '/messages':
            self._handle_messages()
        elif self.path == '/ip':
            self.send_response(200)
            self.send_header('Content-type', 'application/json')
            self.end_headers()
            # è·å–çƒ­ç‚¹IPåœ°å€
            hotspot_ip = self.get_hotspot_ip()
            self.wfile.write(json.dumps({"ip": hotspot_ip}).encode('utf-8'))
        else:
            self.send_error(404)
    
    def do_POST(self):
        if self.path == '/send':
            content_length = int(self.headers['Content-Length'])
            post_data = self.rfile.read(content_length)
            self._process_message(post_data)
            self._set_headers()
            self.wfile.write(b'Message received')
        else:
            self.send_error(404)
    
    def get_hotspot_ip(self):
        """è·å–æ‰‹æœºçƒ­ç‚¹IPåœ°å€"""
        try:
            # å°è¯•è·å–wlan0æ¥å£çš„IPï¼ˆçƒ­ç‚¹æ¥å£ï¼‰
            result = subprocess.run(['ip', 'addr', 'show', 'wlan0'], capture_output=True, text=True)
            if result.returncode == 0:
                # æŸ¥æ‰¾IPv4åœ°å€
                import re
                ip_match = re.search(r'inet (\\d+\\.\\d+\\.\\d+\\.\\d+)/', result.stdout)
                if ip_match:
                    return ip_match.group(1)
            
            # å¦‚æœwlan0æ²¡æœ‰IPï¼Œå°è¯•å…¶ä»–æ–¹æ³•
            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
            try:
                s.connect(("8.8.8.8", 80))
                return s.getsockname()[0]
            finally:
                s.close()
        except:
            return "æ— æ³•è·å–IP"
    
    def _process_message(self, data):
        try:
            message = json.loads(data.decode('utf-8'))['message']
            with queue_lock:
                message_queue.append(message)
            print(f"\\n\\033[1;35mæ”¶åˆ°æ¶ˆæ¯: \\033[1;36m{message}\\033[0m")
        except:
            print("\\n\\033[1;31mæ— æ•ˆæ¶ˆæ¯æ ¼å¼\\033[0m")
    
    def _handle_messages(self):
        self.send_response(200)
        self.send_header('Content-type', 'application/json')
        self.end_headers()
        with queue_lock:
            response = json.dumps({"messages": message_queue.copy()})
            message_queue.clear()
        self.wfile.write(response.encode('utf-8'))
    
    def _create_html(self):
        return f"""
        <!DOCTYPE html>
        <html lang="zh-CN">
        <head>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Termux é€šä¿¡ä¸­å¿ƒ</title>
            <style>
                body {{
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
                    color: white;
                    margin: 0;
                    padding: 20px;
                    min-height: 100vh;
                }}
                .container {{
                    max-width: 800px;
                    margin: 0 auto;
                    background: rgba(255, 255, 255, 0.1);
                    backdrop-filter: blur(10px);
                    border-radius: 20px;
                    padding: 30px;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
                }}
                h1 {{
                    text-align: center;
                    font-size: 2.5rem;
                    margin-bottom: 30px;
                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                }}
                .message-box {{
                    background: rgba(255, 255, 255, 0.15);
                    border-radius: 15px;
                    padding: 20px;
                    margin-bottom: 25px;
                    max-height: 300px;
                    overflow-y: auto;
                }}
                .message {{
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 10px;
                    padding: 12px 15px;
                    margin-bottom: 10px;
                    animation: fadeIn 0.5s;
                }}
                @keyframes fadeIn {{
                    from {{ opacity: 0; transform: translateY(10px); }}
                    to {{ opacity: 1; transform: translateY(0); }}
                }}
                .input-group {{
                    display: flex;
                    gap: 10px;
                }}
                input {{
                    flex: 1;
                    padding: 15px;
                    border: none;
                    border-radius: 50px;
                    background: rgba(255, 255, 255, 0.2);
                    color: white;
                    font-size: 1rem;
                    outline: none;
                }}
                input::placeholder {{ color: rgba(255, 255, 255, 0.7); }}
                button {{
                    background: #ff2e63;
                    color: white;
                    border: none;
                    border-radius: 50px;
                    padding: 0 30px;
                    font-size: 1rem;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s;
                }}
                button:hover {{
                    background: #ff5c8d;
                    transform: translateY(-2px);
                    box-shadow: 0 5px 15px rgba(255, 46, 99, 0.4);
                }}
                .status {{
                    text-align: center;
                    margin-top: 20px;
                    font-size: 0.9rem;
                    opacity: 0.8;
                }}
                .ip-info {{
                    background: rgba(0, 0, 0, 0.2);
                    border-radius: 10px;
                    padding: 10px;
                    margin-top: 20px;
                    text-align: center;
                    font-size: 0.9rem;
                }}
                .copy-btn {{
                    background: #4CAF50;
                    color: white;
                    border: none;
                    border-radius: 5px;
                    padding: 5px 10px;
                    margin-left: 10px;
                    cursor: pointer;
                    font-size: 0.8rem;
                }}
            </style>
        </head>
        <body>
            <div class="container">
                <h1>âœ¨ Termux é€šä¿¡ä¸­å¿ƒ âœ¨</h1>
                
                <div class="message-box" id="messageBox">
                    <div class="message">ğŸ“¢ å·²è¿æ¥åˆ°TermuxæœåŠ¡å™¨ï¼</div>
                </div>
                
                <div class="input-group">
                    <input type="text" id="messageInput" placeholder="è¾“å…¥æ¶ˆæ¯å‘é€åˆ°Termuxç»ˆç«¯...">
                    <button onclick="sendMessage()">å‘é€</button>
                </div>
                
                <div class="status">
                    <p>è¿æ¥çŠ¶æ€: <span id="status">ğŸŸ¢ åœ¨çº¿</span></p>
                </div>
                
                <div class="ip-info">
                    <p>å…¶ä»–è®¾å¤‡è®¿é—®åœ°å€: <span id="ipAddress">æ­£åœ¨è·å–...</span>
                    <button class="copy-btn" onclick="copyIP()">å¤åˆ¶</button></p>
                </div>
            </div>

            <script>
                const messageBox = document.getElementById('messageBox');
                const messageInput = document.getElementById('messageInput');
                const statusElem = document.getElementById('status');
                const ipAddressElem = document.getElementById('ipAddress');
                
                // æ·»åŠ æ–°æ¶ˆæ¯åˆ°æ¶ˆæ¯æ¡†
                function addMessage(text) {{
                    const msgDiv = document.createElement('div');
                    msgDiv.className = 'message';
                    msgDiv.textContent = text;
                    messageBox.prepend(msgDiv);
                    messageBox.scrollTop = 0;
                }}
                
                // å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨
                function sendMessage() {{
                    const message = messageInput.value.trim();
                    if (message) {{
                        fetch('/send', {{
                            method: 'POST',
                            headers: {{ 'Content-Type': 'application/json' }},
                            body: JSON.stringify({{ message }})
                        }});
                        addMessage(\`ğŸ“¤ ä½ : \${{message}}\`);
                        messageInput.value = '';
                    }}
                }}
                
                // æŒ‰Enterå‘é€æ¶ˆæ¯
                messageInput.addEventListener('keypress', (e) => {{
                    if (e.key === 'Enter') sendMessage();
                }});
                
                // è½®è¯¢è·å–æ–°æ¶ˆæ¯
                async function fetchMessages() {{
                    try {{
                        const response = await fetch('/messages');
                        const data = await response.json();
                        data.messages.forEach(msg => addMessage(\`ğŸ“¥ Termux: \${{msg}}\`));
                        statusElem.innerHTML = 'ğŸŸ¢ åœ¨çº¿';
                    }} catch (error) {{
                        statusElem.innerHTML = 'ğŸ”´ ç¦»çº¿ - å°è¯•é‡æ–°è¿æ¥...';
                    }}
                    setTimeout(fetchMessages, 2000);
                }}
                
                // è·å–æœåŠ¡å™¨IPåœ°å€
                async function getServerIP() {{
                    try {{
                        const response = await fetch('/ip');
                        const data = await response.json();
                        ipAddressElem.textContent = \`http://\${{data.ip}}:8080\`;
                    }} catch (error) {{
                        ipAddressElem.textContent = 'æ— æ³•è·å–IPåœ°å€';
                    }}
                }}
                
                // å¤åˆ¶IPåœ°å€åˆ°å‰ªè´´æ¿
                function copyIP() {{
                    const text = ipAddressElem.textContent;
                    navigator.clipboard.writeText(text)
                        .then(() => alert('åœ°å€å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'))
                        .catch(err => console.error('å¤åˆ¶å¤±è´¥:', err));
                }}
                
                // åˆå§‹åŒ–
                fetchMessages();
                getServerIP();
            </script>
        </body>
        </html>
        """

if __name__ == '__main__':
    host = '0.0.0.0'  # ç»‘å®šåˆ°æ‰€æœ‰ç½‘ç»œæ¥å£
    port = 8080
    
    # è·å–çƒ­ç‚¹IPåœ°å€
    def get_hotspot_ip():
        """è·å–æ‰‹æœºçƒ­ç‚¹IPåœ°å€"""
        try:
            # å°è¯•è·å–wlan0æ¥å£çš„IPï¼ˆçƒ­ç‚¹æ¥å£ï¼‰
            result = subprocess.run(['ip', 'addr', 'show', 'wlan0'], capture_output=True, text=True)
            if result.returncode == 0:
                # æŸ¥æ‰¾IPv4åœ°å€
                import re
                ip_match = re.search(r'inet (\\d+\\.\\d+\\.\\d+\\.\\d+)/', result.stdout)
                if ip_match:
                    return ip_match.group(1)
            
            # å¦‚æœwlan0æ²¡æœ‰IPï¼Œå°è¯•å…¶ä»–æ–¹æ³•
            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
            try:
                s.connect(("8.8.8.8", 80))
                return s.getsockname()[0]
            finally:
                s.close()
        except:
            return "æ— æ³•è·å–IP"
    
    hotspot_ip = get_hotspot_ip()

    print("\\033[1;32må¯åŠ¨Termuxé€šä¿¡æœåŠ¡å™¨...\\033[0m")
    print(f"\\033[1;33mæœ¬æœºè®¿é—®: \\033[1;34mhttp://localhost:{port}\\033[0m")
    print(f"\\033[1;33mçƒ­ç‚¹IP: \\033[1;34mhttp://{hotspot_ip}:{port}\\033[0m")
    print("\\033[1;33mç­‰å¾…ç½‘é¡µè¿æ¥...\\033[0m")
    
    server = ThreadedHTTPServer((host, port), RequestHandler)
    server.serve_forever()
EOF
`,
  type: 'python',
  varName: 'ak',
  size: 12514
};
var al = {
  index: 12,
  filename: '1. æœ¬åœ°æœåŠ¡/B htmlå®šé•¿è½¬å›¾ç‰‡.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/1. æœ¬åœ°æœåŠ¡/B htmlå®šé•¿è½¬å›¾ç‰‡.py',
  content: `python3 -x <<'EOF'
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
2000Ã—3000 å›ºå®šæˆªå›¾ï¼ˆä¸€æ¬¡æˆå‹ï¼‰
"""
import os, subprocess, sys
from PIL import Image

# ---------- å¯é…å‚æ•° ----------
HTML_FILE   = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/é¡¹ç›®åˆ†ææŠ¥å‘Š/mainå·®å¼‚åˆ†æHTML/é¡¹ç›®08_vs_[25-2] TIMé€šé“æ•è·åº”ç”¨ä¹‹è¶…å£°æ³¢æµ‹è·_å·®å¼‚åˆ†æ.html"
OUTPUT_FILE = "/storage/emulated/0/Download/QQ/é¡¹ç›®08_vs_[16] ç«ç„°ä¼ æ„Ÿå™¨è§¦å‘èœ‚é¸£å™¨_å·®å¼‚åˆ†æ_optimized.png"
WIDTH       = 2000   # å›ºå®šå®½åº¦
HEIGHT      = 3000   # å›ºå®šé«˜åº¦
# ------------------------------

def shoot(html, out, width=2000, height=3000):
    cmd = ["chromium-browser", "--headless", "--disable-gpu", "--no-sandbox",
           "--run-all-compositor-stages-before-draw", "--virtual-time-budget=30000",
           f"--window-size={width},{height}", f"--screenshot={out}", f"file://{html}"]
    return subprocess.run(cmd, capture_output=True).returncode == 0

def main():
    print(f"æˆªå›¾ {WIDTH}Ã—{HEIGHT} â€¦")
    if shoot(HTML_FILE, OUTPUT_FILE, WIDTH, HEIGHT):
        print(f"âœ… å®Œæˆï¼{WIDTH}Ã—{HEIGHT}\\nğŸ“ {OUTPUT_FILE}")
    else:
        print("æˆªå›¾å¤±è´¥")

if __name__ == "__main__":
    main()
EOF





#   è„šæœ¬äºŒ  ï¼Œéå†æ•´ä¸ªç›®å½•ä¸‹çš„htmlåˆå¹¶
python3 -x <<'EOF'
import os, subprocess, glob, tempfile, shutil

# â‘  è·¯å¾„å¸¦ç©ºæ ¼ â†’ ç”¨å¼•å·åŒ…èµ·æ¥
DIR   = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/é¡¹ç›®åˆ†ææŠ¥å‘Š/mainå·®å¼‚åˆ†æHTML"
WIDTH = 2000
HEIGHT = 3000
PDF   = os.path.join(DIR, "merged.pdf")

# â‘¡ æ‰¾ chromium
chromium = shutil.which("chromium-browser") or shutil.which("chrome") or "chromium-browser"

def shot(html, png):
    cmd = [chromium, "--headless", "--disable-gpu", "--no-sandbox",
           "--run-all-compositor-stages-before-draw", "--virtual-time-budget=30000",
           f"--window-size={WIDTH},{HEIGHT}", f"--screenshot={png}", f"file://{html}"]
    cp = subprocess.run(cmd, capture_output=True, text=True)
    if cp.returncode != 0:
        print("!!! chromium æŠ¥é”™:\\n", cp.stderr[:400])
    return cp.returncode == 0

with tempfile.TemporaryDirectory() as tmp:
    pngs = []
    for f in sorted(glob.glob(os.path.join(DIR, "*.html"))):
        png = os.path.join(tmp, os.path.basename(f).replace(".html", ".png"))
        if shot(f, png):
            pngs.append(png)
        else:
            break
    if not pngs:
        print("âŒ æ—  PNG"); exit()

    subprocess.run(["magick"] + pngs + [PDF], check=True)
    print("âœ… merged.pdf å®Œæˆ â†’", os.path.basename(PDF))

# ä¸´æ—¶ PNG éš tmp ç›®å½•è‡ªåŠ¨æ¶ˆå¤±
EOF
`,
  type: 'python',
  varName: 'al',
  size: 2391
};
var am = {
  index: 13,
  filename: '2. ç½‘ç»œçˆ¬å–/1. æ‰¹é‡å†™å°è¯´.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/1. æ‰¹é‡å†™å°è¯´.py',
  content: `python3 - <<'EOF'
import os,sys,pathlib,time,requests,re
from docx import Document

# ==================== é…ç½®åŒºï¼ˆåªæ”¹è¿™é‡Œï¼‰ ====================
API_KEY = "sk-å“¥ä»¬ä½ è‡ªå·±ğŸ”‘ğŸ”‘ğŸ”‘ğŸ”‘"
MODEL   = "kimi-k2-turbo-preview"
ROOT    = pathlib.Path("/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/3. ESP32-å°æ™º/å‰¯æœ¬/ç« èŠ‚")
TOTAL   = 30
# ===========================================================

DOCX_PATH = pathlib.Path("/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/3. ESP32-å°æ™º/å‰¯æœ¬/ï¼ˆåˆå¹¶ï¼‰gå—å ‚  å°è¯´æ¶æ„ï¼ˆ10.2ï¼‰.docx")
if not DOCX_PATH.exists():
    sys.exit("åŸå§‹.docx ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è·¯å¾„")

ROOT.mkdir(parents=True, exist_ok=True)
WORLD_TEXT = "\\n".join(p.text for p in Document(DOCX_PATH).paragraphs if p.text.strip())

BIBLE = f"""
{WORLD_TEXT}

ã€è¡¥å……å¼ºåˆ¶æ„è±¡ã€‘
ç³–=æ‰¿è¯ºï¼Œç´=å®¶ä¹¦ï¼Œçº¸é¸¢=å½’å¦ï¼Œæ¡ƒèŠ±=å‡‰å®‰ï¼Œç©ºé”…=æ‰§å¿µã€‚
æ¯ç« å¿…é¡»å‡ºç°è‡³å°‘1ä¸ªæ„è±¡ï¼Œå¹¶ç¿»è½¬å…¶åŸä¹‰ã€‚

ã€åæ´¾ä¸‰çº§ã€‘
â‘ è¢æ½¾ï¼ˆé—¨é˜€ï¼‰ â‘¡èµ«è¿æ›œï¼ˆæµæ°‘å¸…ï¼‰ â‘¢ä¹±ä¸–æœ¬èº«

ã€å¼ºåˆ¶è½¬æŠ˜è¡¨ã€‘
1.å—é£æ¸¡å¤œé€ƒâ†’ä¸Šå·³æ¸¸å›­ï¼ˆæ¸…è°ˆæ–—è¯—ï¼‰
2.æ¸¸å›­â†’ç»›å°æœ±é—¨æ‹’å…¥ï¼ˆé—¨é˜€å˜²ç™½è¡£ï¼‰
3.ç»›å°â†’çº¸é¸¢ç›Ÿï¼ˆåŸå¢™åŒçº¿ç«‹èª“ï¼‰
4.çº¸é¸¢â†’æµæ°‘å¸…å¤œè¢­ï¼ˆç«ä¹Œé¸¦ç¬¬ä¸€æ¬¡ï¼‰
5.å¤œè¢­â†’é•œæ¹–è½¯ç¦ï¼ˆè¢æ°åšå±€ï¼‰
6.é•œæ¹–â†’é›ªå¤œæ–­æŒ‡ï¼ˆå‡‰å®‰æ–­æŒ‡æ¢å¥¹å‘½ï¼‰
7.æ–­æŒ‡â†’å—é£æ¸¡ç«‹æ——ï¼ˆå—æ£ è‡ªå°æ¸¡ä¸»ï¼‰
"""

TURN_LIST = [l.strip() for l in """
å—é£æ¸¡å¤œé€ƒâ†’ä¸Šå·³æ¸¸å›­ï¼ˆæ¸…è°ˆæ–—è¯—ï¼‰
æ¸¸å›­â†’ç»›å°æœ±é—¨æ‹’å…¥ï¼ˆé—¨é˜€å˜²ç™½è¡£ï¼‰
ç»›å°â†’çº¸é¸¢ç›Ÿï¼ˆåŸå¢™åŒçº¿ç«‹èª“ï¼‰
çº¸é¸¢â†’æµæ°‘å¸…å¤œè¢­ï¼ˆç«ä¹Œé¸¦ç¬¬ä¸€æ¬¡ï¼‰
å¤œè¢­â†’é•œæ¹–è½¯ç¦ï¼ˆè¢æ°åšå±€ï¼‰
é•œæ¹–â†’é›ªå¤œæ–­æŒ‡ï¼ˆå‡‰å®‰æ–­æŒ‡æ¢å¥¹å‘½ï¼‰
æ–­æŒ‡â†’å—é£æ¸¡ç«‹æ——ï¼ˆå—æ£ è‡ªå°æ¸¡ä¸»ï¼‰
""".strip().splitlines() if l.strip()]

memory_file = ROOT / "memory.txt"
written     = sorted(ROOT.glob("ch*.txt"), key=lambda x: int(x.stem[2:]))
next_ch     = len(written) + 1
memory      = "\\n".join(ch.read_text(encoding='utf-8') for ch in written)

url = "https://api.moonshot.cn/v1/chat/completions"
hdr = {"Authorization": f"Bearer {API_KEY}", "Content-Type": "application/json"}

def chat(prompt: str) -> str:
    for i in range(1, 8):
        try:
            r = requests.post(url, headers=hdr,
                              json={"model": MODEL, "messages": [{"role": "user", "content": prompt}],
                                    "temperature": 0.32}, timeout=300)     # â† åªæ”¹è¿™é‡Œï¼š120â†’300
            if r.status_code == 429: time.sleep(2 ** i); continue
            r.raise_for_status()
            return r.json()["choices"][0]["message"]["content"]
        except Exception as e:
            print(f"[ERR] {e}"); time.sleep(2)
    raise RuntimeError("é‡è¯•å¤±è´¥")

if next_ch > TOTAL:
    print("[*] å·ä¸€å·²å®Œæˆ"); exit(0)

for ch in range(next_ch, TOTAL + 1):
    turn = TURN_LIST[(ch - 1) // 5] if (ch - 1) // 5 < len(TURN_LIST) else "è‡ªç”±æ¨è¿›"
    temp = "45â†’60â†’70â†’30â„ƒ".split("â†’")[(ch - 1) // 10]

    print(f"[INFO] æ­£åœ¨ç”Ÿæˆ ch{ch:02d} ...")
    title = chat(f"{BIBLE}\\n{memory[-1200:]}\\nè¯·èµ·ç¬¬{ch}ç« æ ‡é¢˜ï¼ˆâ‰¤12å­—ï¼‰ï¼Œä»…è¿”å›æ ‡é¢˜ã€‚").strip()
    title = re.sub(r"[\\"\\"''ã€‚,ï¼Œ!?ï¼Ÿï¼]", "", title)
    print(f"[INFO] æ ‡é¢˜ï¼š{title}")

    # â†“â†“â†“ åªæ”¹è¿™é‡Œï¼šprompt åŠ é•¿ + æ˜ç¡®å­—æ•°/token ä¸Šé™ â†“â†“â†“
    body = chat(f"{BIBLE}\\nå‰æ–‡æ‘˜è¦ï¼š{memory[-1200:]}\\nå¼ºåˆ¶è½¬æŠ˜ï¼š{turn}\\næ„Ÿæƒ…æ¸©åº¦ï¼š{temp}\\næ ‡é¢˜ï¼š{title}\\n"
                f"è¦æ±‚ï¼š\\n"
                f"1. æœ¬ç« ã€Š{title}ã€‹æ­£æ–‡ 2200-2600 å­—ï¼›\\n"
                f"2. äº”ä¸ªæ„è±¡â€œç³–/ç´/çº¸é¸¢/æ¡ƒèŠ±/ç©ºé”…â€åªèƒ½å„å‡ºç°ä¸€æ¬¡ï¼Œä¸”å¿…é¡»ç¿»è½¬å…¶åŸä¹‰ï¼›\\n"
                f"3. æˆ˜äº‰æå†™â‰¤15%ï¼Œç¦ç”¨â€œé›ªå¤œæ–­æŒ‡â€åšä»»ä½•æ ‡é¢˜æˆ–æƒ…èŠ‚å¤ç”¨ï¼›\\n"
                f"4. ç»“å°¾ç•™åŠå¥ï¼Œæ ‡é¢˜å¿…é¡»å…¨æ–°ï¼Œä¸å¾—ä¸å‰é¢ä»»ä½•ç« èŠ‚é‡å¤ï¼›\\n"
                f"5. ç¦æ­¢è‡ªæˆ‘é‡å¤ã€ç¦æ­¢å¤§æ®µæ’æ¯”ã€ç¦æ­¢è§£é‡Šæ€§æ—ç™½ã€‚")
    print(f"[INFO] è¿”å›å­—æ•°ï¼š{len(body)}")

    f = ROOT / f"ch{ch:02d}.txt"
    f.write_text(f"ç¬¬{ch}ç« ã€€{title}\\n\\n{body.strip()}", encoding='utf-8')
    memory += f"\\n\\n{body.strip()}"
    with memory_file.open("a", encoding='utf-8') as m:
        m.write(f"\\n\\n{body.strip()}")

    kw = re.findall(r"ç³–|ç´|çº¸é¸¢|æ¡ƒèŠ±|ç©ºé”…", body)
    print(f"[OK] ch{ch:02d}ã€Š{title}ã€‹{len(body)}å­—  æ„è±¡:{kw}")

# åˆå¹¶ç»ˆç¨¿
all_txt = "\\n".join(ch.read_text(encoding='utf-8') for ch in sorted(ROOT.glob("ch*.txt"), key=lambda x: int(x.stem[2:])))
(ROOT / "VOL1_final.txt").write_text(all_txt, encoding='utf-8')
print("[ALL DONE] æ€»å· â†’ ", ROOT / "VOL1_final.txt")
EOF
`,
  type: 'python',
  varName: 'am',
  size: 3547
};
var an = {
  index: 14,
  filename: '2. ç½‘ç»œçˆ¬å–/1. æ‰¹é‡å›ç­”é—®é¢˜ï¼ˆä¸æˆªæ–­ï¼‰.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/1. æ‰¹é‡å›ç­”é—®é¢˜ï¼ˆä¸æˆªæ–­ï¼‰.py',
  content: `éœ€æ±‚   ä¸€æ¬¡æ€§ bash å†…åµŒ Python3è„šæœ¬
1.     ä¸€æ¬¡æ€§è¯»å– 30 ä¸ªé—®é¢˜ï¼ˆè‡ªåŠ¨æ ¡éªŒï¼Œä¸è¶³ 30 ä¸ªç›´æ¥é€€å‡ºï¼‰ã€‚
2.    æ¯é—®ä¸€æ¬¡ Moonshot APIï¼Œä¸æºå¸¦å†å²ï¼Œä¿è¯å…¨æ–°å›ç­”ã€‚
3.    å›ç­”æŒ‰ã€Œæ•™ç§‘ä¹¦å¤§çº²ï¼šç« èŠ‚é€Ÿè§ˆ â†’ ä¸€çº§â†’äºŒçº§â†’æ­£æ–‡ï¼ˆTXT ä»£ç å—ï¼Œäººè¯+åè¯è§£é‡Šï¼‰ã€æ ¼å¼è¾“å‡ºã€‚
4.    ç»“æœä¿å­˜åœ¨
 /storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/å›ç­”/YYYYmmdd_HHMMSS/ 
æ–‡ä»¶åä¸º  Q01.txt  â€¦  Q30.txt ï¼Œåºå·ä¸ questions.txt ä¸¥æ ¼å¯¹åº”ã€‚
---------------- å¤åˆ¶å³è·‘ ----------------


python3 - <<'EOF'
# ---------- å”¯ä¸€éœ€è¦æ”¹çš„ ----------
API_KEY = "sk-å“¥ä»¬ä½ è‡ªå·±çš„è¦æ˜¯ğŸ”‘ğŸ”‘ğŸ”‘"
QUESTIONS_FILE = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/questions.txt"
OUTPUT_DIR_PARENT = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01"
# ----------------------------------

import sys, time, pathlib, requests, datetime

q_path = pathlib.Path(QUESTIONS_FILE)
if not q_path.exists():
    sys.exit(f"[ERR] é—®é¢˜æ–‡ä»¶ä¸å­˜åœ¨ï¼š{q_path}")

# è½»é‡æ ¡éªŒï¼šå¿…é¡»æ°å¥½ 30 è¡Œéç©ºé—®é¢˜
with q_path.open(encoding='utf-8') as f:
    questions = [line.strip() for line in f if line.strip()]
if len(questions) != 30:
    sys.exit(f"[ERR] é—®é¢˜æ•°é‡å¿…é¡»æ˜¯ 30 ä¸ªï¼Œå½“å‰ {len(questions)} ä¸ª")

# åˆ›å»ºè¾“å‡ºç›®å½•ï¼šé¡¹ç›®01/å›ç­”/YYYYmmdd_HHMMSS/
ts = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
out_dir = pathlib.Path(OUTPUT_DIR_PARENT) / "å›ç­”" / ts
out_dir.mkdir(parents=True, exist_ok=True)

url = "https://api.moonshot.cn/v1/chat/completions"
hdr = {"Authorization": f"Bearer {API_KEY}", "Content-Type": "application/json"}

def ask_once(q: str) -> str:
    """å•é—®å•ç­”ï¼Œå¤±è´¥æŠ›å¼‚å¸¸"""
    prompt = f"""
ã€æ•™ç§‘ä¹¦å¤§çº²ç¤ºä¾‹ã€‘ï¼ˆEXT4 è¿›åŒ–å²ï¼‰
ç»“è®ºä¸€å¥è¯ï¼šEXT4 å°±æ˜¯æŠŠ 32 ä½é™åˆ¶ç ¸æ‰ã€å†ç»™å°æ–‡ä»¶â€œæ‹¼è½¦â€ã€ç»™å¤§æ–‡ä»¶â€œåŒ…æœºâ€çš„ EXT3 è¶…çº§å‡çº§ç‰ˆï¼Œè‡³ä»Šä»æ˜¯ Linux é»˜è®¤æ ¹æ–‡ä»¶ç³»ç»Ÿè€å¤§å“¥ã€‚
----------------------------------------------------------------
ç¬¬0ç«  è¯»å‰é˜²å‘†
0.1 åªèŠâ€œEXT å®¶å²â€+EXT4 è´¨å˜ï¼Œä¸æ•™ mkfs å‚æ•°
0.2 ç”Ÿè¯â†’å³ä¾§â€œäººè¯å¡â€ç§’æ‡‚
0.3 æ¯ç« æœ«å°¾â€œå¿«é—®å¿«ç­”â€â€”â€”é¢è¯•/è£…ç³»ç»Ÿ/å¹æ°´å‰èƒŒä¸¤å¥
----------------------------------------------------------------
ç¬¬1ç«  å››ä»£åŒå ‚ä¸€å¼ å›¾
1.1 1992 EXTâ€”â€”å©´å„¿æœŸ
ï¼ˆä»¥ä¸‹ç»§ç»­ç…§æ­¤é£æ ¼å±•å¼€ï¼‰

ä½ æ˜¯ä¸€ä½ã€ŒLinux å†…å­˜ç®¡ç†ã€è¯¾ç¨‹åŠ©æ•™ï¼Œè¯·æŠŠå›ç­”æ•´ç†æˆâ€œæ•™ç§‘ä¹¦â€é£æ ¼ï¼š
1. å…ˆç»™ã€ç« èŠ‚é€Ÿè§ˆã€‘ä¸€å¥è¯æ€»ç»“ï¼›
2. æ­£æ–‡æŒ‰ ä¸€çº§æ ‡é¢˜â†’äºŒçº§æ ‡é¢˜â†’æ­£æ–‡ é€çº§å±•å¼€ï¼›
3. æ­£æ–‡ä½¿ç”¨ TXT ä»£ç å—ï¼ˆ\`\`\`txt ... \`\`\`ï¼‰åŒ…è£¹ï¼›
4. é‡åˆ°ä¸“ä¸šåè¯ï¼Œç”¨æ‹¬å·æ’æ’­ä¸€å¥â€œäººè¯è§£é‡Šâ€ï¼›
5. ä¿æŒå£è¯­åŒ–ï¼Œç¦æ­¢è·‘é¢˜ï¼›
6. ä¸è¾“å‡ºä»»ä½•ä¸è¯¾ç¨‹æ— å…³çš„å¯’æš„ã€‚

é—®é¢˜ï¼š{q}
"""
    payload = {
        "model": "kimi-k2-turbo-preview",
        "messages": [{"role": "user", "content": prompt.strip()}],
        "temperature": 0.35,
        "max_tokens": 32000
    }
    for attempt in range(1, 6):
        try:
            r = requests.post(url, headers=hdr, json=payload, timeout=180)
            if r.status_code == 429:
                time.sleep(2 ** attempt)
                continue
            r.raise_for_status()
            return r.json()["choices"][0]["message"]["content"].strip()
        except Exception as e:
            print(f"[WARN] ç¬¬{attempt}æ¬¡å¤±è´¥: {e}")
            time.sleep(2)
    raise RuntimeError("å¤šæ¬¡é‡è¯•ä»å¤±è´¥")

# å†è¯»ä¸€æ¬¡æ–‡ä»¶ï¼Œé€æ¡å¤„ç†ï¼Œä¿è¯â€œä¸€æ¬¡åªè¯»ä¸€ä¸ªé—®é¢˜â€
with q_path.open(encoding='utf-8') as f:
    for idx, raw_line in enumerate(f, 1):
        q = raw_line.strip()
        if not q:           # è·³è¿‡ç©ºè¡Œ
            continue
        print(f"[{idx:02}/30] æé—®ï¼š{q}")
        ans = ask_once(q)
        out_file = out_dir / f"Q{idx:02d}.txt"
        out_file.write_text(ans, encoding='utf-8')
        print(f"      å·²å†™å…¥ï¼š{out_file.name}  ï¼ˆ{len(ans)} å­—ï¼‰")

print(f"\\n[ALL DONE] 30 ä¸ªå›ç­”å·²ä¿å­˜åˆ° â†’ {out_dir}")
EOF
`,
  type: 'python',
  varName: 'an',
  size: 3053
};
var ao = {
  index: 15,
  filename: '2. ç½‘ç»œçˆ¬å–/2.  æŠ“å–å†·ç¬‘è¯.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/2.  æŠ“å–å†·ç¬‘è¯.py',
  content: `python3 -c "
import requests
import re
import random

try:
    # å°è¯•å¤šä¸ªå¯èƒ½çš„ç¬‘è¯ç½‘ç«™
    urls = [
        'http://xiaohua.zol.com.cn/lengxiaohua/',
        'https://www.xiaohua.com/duanzi',
        'https://www.lengxiaohua.com/'
    ]
    
    # å°è¯•ä¸åŒçš„ç”¨æˆ·ä»£ç†
    user_agents = [
        'Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X)',
        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
        'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36'
    ]
    
    for url in urls:
        try:
            response = requests.get(
                url, 
                headers={'User-Agent': random.choice(user_agents)}, 
                timeout=10
            )
            html_content = response.text
            
            # å°è¯•å¤šç§æå–æ–¹æ³•
            patterns = [
                r'<div class=\\"article-text\\">(.*?)</div>',
                r'<div class=\\"content\\">(.*?)</div>',
                r'<p>(.*?)</p>',
                r'<div class=\\"detail-text\\">(.*?)</div>'
            ]
            
            jokes = []
            for pattern in patterns:
                found = re.findall(pattern, html_content, re.S)
                if found:
                    jokes.extend(found)
            
            if jokes:
                # æ¸…ç†HTMLæ ‡ç­¾
                clean_jokes = []
                for joke in jokes:
                    joke = re.sub(r'<[^>]+>', '', joke)
                    joke = re.sub(r'\\s+', ' ', joke)
                    joke = joke.strip()
                    if len(joke) > 20 and 'ç¬‘è¯' not in joke and 'http' not in joke:
                        clean_jokes.append(joke)
                
                if clean_jokes:
                    selected_joke = random.choice(clean_jokes)
                    print('='*50)
                    print('éšæœºç¬‘è¯:')
                    print('='*50)
                    print(selected_joke)
                    print('='*50)
                    exit(0)  # æˆåŠŸæ‰¾åˆ°ç¬‘è¯ï¼Œé€€å‡ºç¨‹åº
            
            print(f'åœ¨ {url} æœªæ‰¾åˆ°ç¬‘è¯ï¼Œå°è¯•ä¸‹ä¸€ä¸ªç½‘ç«™...')
            
        except Exception as e:
            print(f'è®¿é—® {url} å¤±è´¥: {e}')
            continue
    
    # å¦‚æœæ‰€æœ‰ç½‘ç«™éƒ½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨ç¬‘è¯
    backup_jokes = [
        'ä¸ºä»€ä¹ˆæ•°å­¦ä¹¦æ€»æ˜¯å¾ˆæ‚²ä¼¤ï¼Ÿå› ä¸ºå®ƒæœ‰å¤ªå¤šçš„é—®é¢˜ã€‚',
        'ç¨‹åºå‘˜å»å•†åº—ä¹°ç‰›å¥¶ï¼Œåº—å‘˜é—®ï¼šè¦ä¸è¦æ¥ç‚¹é¢åŒ…ï¼Ÿç¨‹åºå‘˜å›ç­”ï¼šä¸ç”¨äº†ï¼Œæˆ‘å®¶è¿˜æœ‰ã€‚',
        'æœ‰ä¸€å¤©ï¼Œä¸‰è§’å½¢ã€åœ†å½¢å’Œæ­£æ–¹å½¢æ¯”èµ›è·‘æ­¥ã€‚åœ†å½¢æ»šå¾—æœ€å¿«ï¼Œæ­£æ–¹å½¢å¡ä½äº†ï¼Œä¸‰è§’å½¢ä¸€ç›´è½¬åœˆã€‚',
        'ä¸ºä»€ä¹ˆç”µè„‘æ°¸è¿œä¸ä¼šæ„Ÿå†’ï¼Ÿå› ä¸ºå®ƒæœ‰Windowsï¼Œä½†æ€»æ˜¯ä¼šæ‰“å¼€ã€‚'
    ]
    
    print('='*50)
    print('ç½‘ç»œç¬‘è¯è·å–å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨ç¬‘è¯:')
    print('='*50)
    print(random.choice(backup_jokes))
    print('='*50)

except Exception as e:
    print(f'ç¨‹åºæ‰§è¡Œå¤±è´¥: {e}')
"
`,
  type: 'python',
  varName: 'ao',
  size: 2545
};
var ap = {
  index: 16,
  filename: '2. ç½‘ç»œçˆ¬å–/2. æ‰¹é‡æŠ“å–åŠ›æ‰£é¢˜ç›®.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/2. æ‰¹é‡æŠ“å–åŠ›æ‰£é¢˜ç›®.py',
  content: `     Mr.L  éœ€æ±‚ã€Œä¸€æ¬¡å¤åˆ¶ï¼Œä¸¤è¡Œç›´æ¥è·‘ã€çš„è„šæœ¬ï¼š   termuxçš„bashè„šæœ¬ 
1.   å…ˆæŠ“ å…¨éƒ¨ 1000 é¢˜ çš„é¢˜å¹²ï¼ˆè‹±æ–‡çº¯æ–‡æœ¬ï¼‰
2.   æŒ‰ æ¯ 50 é¢˜åˆ‡ä¸€ä¸ªæ–‡ä»¶ï¼ˆå…± 20 ä¸ªæ–‡ä»¶ï¼‰
3.   æ–‡ä»¶åè‡ªåŠ¨ç¼–å·ï¼š leetcode_001_050.json  â€¦  leetcode_951_1000.json 
4.   ç›®å½•è‹¥ä¸å­˜åœ¨ä¼šè‡ªåŠ¨å»ºï¼Œè·‘å®Œæ‰“å° âœ… åˆ—è¡¨ã€‚   


python3 -x <<'PYEOF'
import json, urllib.request, pathlib, re, html

root = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/leetcode_split"
pathlib.Path(root).mkdir(parents=True, exist_ok=True)

# â‘  æŒ‰ ID å‡åºæ‹¿å‰ 1000 é¢˜
list_url = "https://leetcode.com/api/problems/all/"
req = urllib.request.Request(list_url, headers={
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"})
with urllib.request.urlopen(req) as resp:
    pairs = sorted(
        [(q["stat"]["frontend_question_id"], q["stat"]["question__title_slug"])
         for q in json.loads(resp.read().decode())["stat_status_pairs"]],
        key=lambda x: x[0])[:1000]

# â‘¡ GraphQL æ¨¡æ¿
query = """
query questionData($titleSlug: String!) {
  question(titleSlug: $titleSlug) { content difficulty }
}"""

def fetch(qid, slug):
    payload = json.dumps({
        "operationName": "questionData",
        "query": query,
        "variables": {"titleSlug": slug}
    }).encode()
    greq = urllib.request.Request(
        "https://leetcode.com/graphql",
        data=payload,
        headers={"Content-Type": "application/json",
                 "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"})
    with urllib.request.urlopen(greq) as r:
        d = json.loads(r.read().decode())["data"]["question"]
    text = html.unescape(re.sub(r'<[^>]+>', '', d["content"])) if d["content"] else ""
    return {"id": qid, "slug": slug, "difficulty": d["difficulty"], "content": text.strip()}

# â‘¢ æ¯ 50 é¢˜å†™ä¸€æ–‡ä»¶ï¼ˆå­˜åœ¨å°±è·³è¿‡ï¼‰
batch = 50
for i in range(0, 1000, batch):
    file = pathlib.Path(root) / f"leetcode_{i+1:03d}_{min(i+batch, 1000):03d}.json"
    if file.exists():
        print(f"â­ è·³è¿‡ {file}")
        continue
    chunk = [fetch(qid, slug) for qid, slug in pairs[i:i+batch]]
    with open(file, "w", encoding="utf-8") as f:
        json.dump(chunk, f, ensure_ascii=False, indent=2)
    print(f"âœ… å·²å†™å…¥ {file}  ï¼ˆID {chunk[0]['id']} ~ {chunk[-1]['id']}ï¼‰")

print("å…¨éƒ¨å®Œæˆï¼")
PYEOF
`,
  type: 'python',
  varName: 'ap',
  size: 2184
};
var aq = {
  index: 17,
  filename: '2. ç½‘ç»œçˆ¬å–/4. ä¸‹è½½91å­¦ä¹ è§†é¢‘ï¼ˆpythonç‰ˆï¼‰.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/2. ç½‘ç»œçˆ¬å–/4. ä¸‹è½½91å­¦ä¹ è§†é¢‘ï¼ˆpythonç‰ˆï¼‰.py',
  content: `#   L.  å·²å¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œä¾¿äºäººç±»é˜…è¯»ï¼Œå…ˆçœ‹main
 
python3 -x <<'EOF'   #   Pythonè½¬bash
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
M3U8è§†é¢‘ä¸‹è½½è„šæœ¬
87000å›ºå®šï¼Œ87100-87200éšåˆ°éšä¸‹
å•çº¿ç¨‹+æç®€æç¤º+è·³è¿‡>500MBæ–‡ä»¶
"""

import os
import subprocess
import requests
from pathlib import Path

# ==================== é…ç½®å¸¸é‡ ====================
BASE_URL = "https://ä½ çš„è§†é¢‘åœ°å€ğŸ”—ğŸ”—ğŸ”—ğŸ”—ğŸ”—ğŸ”—/87000"
START_ID = 87100
END_ID = 87200
SAVE_ROOT = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/è„šæœ¬/02 ä¸å¯æè¿°"
USER_AGENT = "Mozilla/5.0 (Linux; Android 13; SM-G973F) AppleWebKit/537.36"
MAX_FILE_SIZE_MB = 500
REQUEST_TIMEOUT = 10
DOWNLOAD_TIMEOUT = 3600

HEADERS = {"User-Agent": USER_AGENT}


# ==================== åŠŸèƒ½å‡½æ•°ï¼ˆæŒ‰è°ƒç”¨é¡ºåºæ’åˆ—ï¼‰ ====================
def check_m3u8_accessible(m3u8_url: str) -> bool:
    """
    æ£€æŸ¥M3U8æ–‡ä»¶æ˜¯å¦å¯è®¿é—®
    
    å‚æ•°: m3u8_url - M3U8æ–‡ä»¶URL
    è¿”å›: å¸ƒå°”å€¼
    """
    try:
        response = requests.get(m3u8_url, headers=HEADERS, timeout=5)
        return response.text.startswith("#EXTM3U")
    except requests.RequestException:
        return False


def get_save_folder(video_id: int, start_id: int, save_root: str) -> Path:
    """
    è·å–è§†é¢‘ä¿å­˜æ–‡ä»¶å¤¹è·¯å¾„
    
    å‚æ•°: 
        video_id - è§†é¢‘ID
        start_id - èµ·å§‹ID  
        save_root - ä¿å­˜æ ¹ç›®å½•
    è¿”å›: æ–‡ä»¶å¤¹Pathå¯¹è±¡
    """
    # æ¯20ä¸ªè§†é¢‘ä¸€ä¸ªæ–‡ä»¶å¤¹
    folder_start = start_id + ((video_id - start_id) // 20) * 20
    folder_name = f"{folder_start}-{folder_start + 19}"
    folder_path = Path(save_root) / folder_name
    folder_path.mkdir(parents=True, exist_ok=True)
    
    return folder_path


def get_video_size_mb(m3u8_url: str) -> int:
    """
    ä¼°ç®—M3U8è§†é¢‘æ–‡ä»¶å¤§å°(MB)
    
    å‚æ•°: m3u8_url - M3U8æ–‡ä»¶URL
    è¿”å›: ä¼°ç®—å¤§å°(MB)ï¼Œå¤±è´¥è¿”å›0
    """
    try:
        # 1. è·å–M3U8å†…å®¹
        response = requests.get(m3u8_url, headers=HEADERS, timeout=REQUEST_TIMEOUT)
        lines = [line.strip() for line in response.text.splitlines() if line.strip()]
        
        # 2. æŸ¥æ‰¾åˆ†ç‰‡ä¿¡æ¯
        segment_line = next((line for line in lines if not line.startswith("#")), None)
        if not segment_line:
            return 0
        
        # 3. æ„å»ºåˆ†ç‰‡URL
        base_url = m3u8_url.rsplit("/", 1)[0]
        segment_url = f"{base_url}/{segment_line}"
        
        # 4. è·å–åˆ†ç‰‡å¤´éƒ¨ä¼°ç®—æ¯”ç‰¹ç‡
        segment_head = requests.get(
            segment_url, 
            headers={**HEADERS, "Range": "bytes=0-1023"}, 
            timeout=REQUEST_TIMEOUT
        ).content
        
        # 5. ä½¿ç”¨ffprobeè·å–æ¯”ç‰¹ç‡
        bitrate_output = subprocess.check_output(
            ["ffprobe", "-v", "error", "-show_entries", "format=bit_rate", "-of", "csv=p=0", "-"],
            input=segment_head, 
            stderr=subprocess.DEVNULL,
        ).decode().strip()
        
        bitrate = int(bitrate_output) if bitrate_output.isdigit() else 1_000_000
        
        # 6. è®¡ç®—æ€»æ—¶é•¿
        total_duration = 0.0
        for line in lines:
            if line.startswith("#EXTINF:"):
                total_duration += float(line.split(":")[1].split(",")[0])
        
        return int(bitrate * total_duration / 8 / 1024 / 1024) if total_duration > 0 else 0
        
    except Exception:
        return 0


def download_video(m3u8_url: str, output_file: Path, video_id: int) -> bool:
    """
    ä¸‹è½½M3U8è§†é¢‘æ–‡ä»¶
    
    å‚æ•°:
        m3u8_url - M3U8æ–‡ä»¶URL
        output_file - è¾“å‡ºæ–‡ä»¶è·¯å¾„  
        video_id - è§†é¢‘ID
    è¿”å›: å¸ƒå°”å€¼
    """
    try:
        result = subprocess.run(
            [
                "ffmpeg", "-hide_banner", "-loglevel", "error", "-nostats", "-y",
                "-user_agent", USER_AGENT, "-i", m3u8_url, "-c", "copy", str(output_file)
            ],
            timeout=DOWNLOAD_TIMEOUT
        )
        return result.returncode == 0
    except subprocess.TimeoutExpired:
        print(f"[è¶…æ—¶] {video_id}")
        return False
    except Exception as error:
        print(f"[é”™è¯¯] {video_id}: {error}")
        return False


def main():
    """ä¸»å‡½æ•°"""
    # ä¸€ã€åˆå§‹åŒ–
    Path(SAVE_ROOT).mkdir(parents=True, exist_ok=True)
    print(f"[å¼€å§‹] ä¸‹è½½èŒƒå›´ {START_ID}-{END_ID}")
    
    success_count, skip_count, fail_count = 0, 0, 0
    
    # äºŒã€éå†è§†é¢‘ID
    for video_id in range(START_ID, END_ID + 1):
        m3u8_url = f"{BASE_URL}/{video_id}/index.m3u8"
        
        # 1. æ£€æŸ¥å¯è®¿é—®æ€§
        if not check_m3u8_accessible(m3u8_url):
            print(f"[è·³è¿‡] {video_id} ä¸å¯è®¿é—®")
            skip_count += 1
            continue
        
        # 2. è·å–ä¿å­˜è·¯å¾„
        save_folder = get_save_folder(video_id, START_ID, SAVE_ROOT)
        output_file = save_folder / f"{video_id}.mp4"
        
        # 3. æ£€æŸ¥æ–‡ä»¶å­˜åœ¨
        if output_file.exists():
            print(f"[å­˜åœ¨] {video_id}.mp4")
            skip_count += 1
            continue
        
        # 4. ä¼°ç®—æ–‡ä»¶å¤§å°
        file_size = get_video_size_mb(m3u8_url)
        if file_size > MAX_FILE_SIZE_MB:
            print(f"[è·³è¿‡] {video_id} å¤§å°{file_size}MB>500MB")
            skip_count += 1
            continue
        
        # 5. ä¸‹è½½è§†é¢‘
        print(f"[ä¸‹è½½] {video_id} å¤§å°{file_size}MB")
        if download_video(m3u8_url, output_file, video_id):
            print(f"[å®Œæˆ] {video_id}.mp4")
            success_count += 1
        else:
            print(f"[å¤±è´¥] {video_id}.mp4")
            fail_count += 1
    
    # ä¸‰ã€è¾“å‡ºæ€»ç»“
    print(f">>> å…¨éƒ¨ç»“æŸ! æˆåŠŸ:{success_count}, è·³è¿‡:{skip_count}, å¤±è´¥:{fail_count}")


if __name__ == "__main__":
    main()

EOF`,
  type: 'python',
  varName: 'aq',
  size: 5262
};
var ar = {
  index: 18,
  filename: '3. é¡¹ç›®åˆ†æ/1. é¡¹ç›®åˆ†ææŠ¥å‘Šï¼ˆAPIï¼‰.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/1. é¡¹ç›®åˆ†ææŠ¥å‘Šï¼ˆAPIï¼‰.py',
  content: `# å•æ–‡ä»¶ ï¼Œå…ˆctags,jqåˆ†æ ï¼Œ   å†  æ–‡ä»¶ï¼‹ctagsï¼‹æç¤ºè¯åˆ†æ
# ç²˜è´´termuxç›´æ¥è¿è¡Œ,  .pyæ ¼å¼ä¸ºäº†ä¾¿äºé˜…è¯»
python3 - <<'EOF'
import os, subprocess, pathlib, requests, time, sys
from requests.exceptions import HTTPError

API_KEY = 'sk-å“¥ä»¬å„¿ï¼Œåˆ«è–…ç¾Šæ¯›äº†ã€‚æˆ‘ä¹Ÿæ²¡é’±ğŸ”‘ğŸ”‘ğŸ”‘'
MODEL   = 'kimi-k2-turbo-preview'
SRC     = pathlib.Path('/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/3. ESP32-å°æ™º/å‰¯æœ¬/xiaozhi-esp32-main/main/application.cc')
OUT_DIR = pathlib.Path('/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/3. ESP32-å°æ™º/å‰¯æœ¬/xiaozhi-esp32-main/é¡¹ç›®åˆ†ææŠ¥å‘Š')

OUT_DIR.mkdir(parents=True, exist_ok=True)
TAGS_FILE = OUT_DIR / f'{SRC.stem}.cc_ctags.txt'
BRAIN_FILE= OUT_DIR / f'{SRC.stem}.cc_è„‘å›¾.txt'

mode = 'c' if SRC.suffix == '.c' else 'cpp'
# 1. å®Œæ•´ ctags + jq + awk ç®¡é“ï¼ˆå« macroï¼‰
cmd = f'''
ctags --output-format=json --kinds-c++=+c+d+e+f+g+l+m+n+p+s+t+u+v+x "{SRC}" 2>/dev/null |
jq -r \\'select((.kind=="function" or .kind=="member" or .kind=="macro" or .kind=="struct" or .kind=="typedef" or .kind=="variable") and (.name|startswith("__anon")|not))
        | . as $$r
        | if   $$r.kind=="macro"    then "MACRO\\\\t\\\\($$r.name)"
          elif $$r.kind=="function" then "FUNC\\\\t\\\\($$r.name)\\\\t\\\\($$r.scope//"-")"
          elif $$r.kind=="member"   then "MEMBER\\\\t\\\\($$r.name)\\\\t\\\\($$r.scope)"
          elif $$r.kind=="struct"   then "STRUCT\\\\t\\\\($$r.name)"
          elif $$r.kind=="typedef"  then "TYPEDEF\\\\t\\\\($$r.name)"
          elif $$r.kind=="variable" then "VAR\\\\t\\\\($$r.name)"
          else empty end\\' |
awk -v mode="{mode}" \\'
BEGIN{{print "[å®å®šä¹‰]"}}
$1=="MACRO"   {{printf "  %-30s ï¼ˆå®ï¼‰\\\\n",$2; next}}
$1=="STRUCT"  {{if(!s_h){{print "\\\\n[ç»“æ„ä½“]";s_h=1}} printf "  %-30s ï¼ˆç»“æ„ä½“ï¼‰\\\\n",$2; next}}
$1=="TYPEDEF" {{if(!t_h){{print "\\\\n[ç±»å‹åˆ«å]";t_h=1}} printf "  %-30s ï¼ˆç±»å‹åˆ«åï¼‰\\\\n",$2; next}}
$1=="VAR"     {{if(!v_h){{print "\\\\n[å˜é‡]";v_h=1}} printf "  %-30s ï¼ˆå˜é‡ï¼‰\\\\n",$2; next}}
mode=="c" && $1=="FUNC" {{if(!f_h){{print "\\\\n[å‡½æ•°]";f_h=1}} printf "  %-30s ï¼ˆå‡½æ•°ï¼‰\\\\n",$2; next}}
mode=="cpp" && $1=="FUNC" {{
    cls=$3; if(cls=="-"){{if(!g_h){{print "\\\\n[å…¨å±€å‡½æ•°]";g_h=1}} printf "  %-30s ï¼ˆå‡½æ•°ï¼‰\\\\n",$2; next}}
    else{{if(!(cls in done)){{printf "\\\\n[ç±» %s]\\\\n",cls; done[cls]=1}} printf "  %-30s ï¼ˆæˆå‘˜å‡½æ•°ï¼‰\\\\n",$2; next}}
}}
mode=="cpp" && $1=="MEMBER" {{
    cls=$3; if(!(cls in done)){{printf "\\\\n[ç±» %s]\\\\n",cls; done[cls]=1}} printf "  %-30s ï¼ˆæˆå‘˜å˜é‡ï¼‰\\\\n",$2; next}}
\\'
'''
symbols = subprocess.check_output(cmd, shell=True, text=True)
TAGS_FILE.write_text(symbols, encoding='utf-8')
print('[OK] ç¬¦å· â†’', TAGS_FILE)

code = SRC.read_text(encoding='utf-8', errors='ignore')

def chat(msgs):
    attempt = 0
    while True:
        try:
            r = requests.post(
                'https://api.moonshot.cn/v1/chat/completions',
                headers={'Authorization': f'Bearer {API_KEY}', 'Content-Type': 'application/json'},
                json={'model': MODEL, 'messages': msgs, 'temperature': 0.1},
                timeout=90)
            r.raise_for_status()
            return r.json()['choices'][0]['message']['content']
        except HTTPError as e:
            if e.response.status_code == 429:
                attempt += 1
                wait = 2 ** attempt
                print(f'\\nï¼429é™é€Ÿï¼Œ{wait}såé‡è¯•(ç¬¬{attempt}æ¬¡)', file=sys.stderr)
                time.sleep(wait)
                continue
            raise

prompt = f"""ä¸‹æ–¹ç»™å‡ºä¸¤ä»½ææ–™ï¼š
1. ctags æŠ“å–çš„ç¬¦å·æ¸…å•ï¼ˆå·²å»é‡ï¼‰ï¼›
2. å®Œæ•´ C/C++ æºç ã€‚

è¯·ä»¥ç¬¦å·æ¸…å•ä¸ºåŸºå‡†ï¼Œå¯¹ç…§æºç ï¼ŒæŒ‰ä¸‹é¢ 3 ç‚¹è¿”å›ä¸­æ–‡è¯´æ˜ï¼ˆè‹±æ–‡æ ‡è¯†ç¬¦ä¿ç•™ï¼Œæ‹¬å·å†…ä¸­æ–‡ï¼‰ï¼š
1. æ¯ä¸ªå¼•å…¥å¤´æ–‡ä»¶çš„ä½œç”¨ï¼›
2. æ‰€æœ‰è‡ªå®šä¹‰å¸¸é‡/å®ï¼›
3. æˆå‘˜ï¼ˆå«ç±»å‹/å‡½æ•°/å›è°ƒ/å˜é‡ï¼‰ã€‚

æ ¼å¼ç¤ºä¾‹ï¼ˆå¿…é¡»ä¸¥æ ¼ç…§æ­¤è¾“å‡ºï¼Œä¸è¦å¤šä¸€è¡Œè§£é‡Šï¼‰ï¼š
ã€å¤´æ–‡ä»¶ã€‘
freertos/FreeRTOS.hï¼ˆFreeRTOSä¸»è¦å¤´æ–‡ä»¶ï¼‰

ã€å®å¸¸é‡ã€‘
TAG â†’ "APP"ï¼ˆæ—¥å¿—æ ‡ç­¾ï¼‰

ã€ç±»ã€‘
class Applicationï¼ˆåº”ç”¨ä¸»ç±»ï¼‰ï¼š
- void start()ï¼ˆå¯åŠ¨å‡½æ•°ï¼‰
- static QueueHandle_t msgqï¼ˆæ¶ˆæ¯é˜Ÿåˆ—å¥æŸ„ï¼‰

ç¬¦å·æ¸…å•ï¼ˆ{symbols.count(chr(10))} è¡Œï¼‰ï¼š
{symbols}

æºç ï¼š
{code}"""

BRAIN_FILE.write_text(chat([{'role': 'user', 'content': prompt}]), encoding='utf-8')
print('[OK] è„‘å›¾ â†’', BRAIN_FILE)
EOF
`,
  type: 'python',
  varName: 'ar',
  size: 3782
};
var as = {
  index: 19,
  filename: '3. é¡¹ç›®åˆ†æ/2. ç”Ÿæˆé¡¹ç›®ä¾èµ–æ ‘ï¼ˆæ— é»‘åå•ï¼‰.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/2. ç”Ÿæˆé¡¹ç›®ä¾èµ–æ ‘ï¼ˆæ— é»‘åå•ï¼‰.py',
  content: `#!/usr/bin/env bash # æŒ‡å®šç”¨ bash è§£é‡Šå™¨      Mr.L bahè„šæœ¬ ï¼Œ.pyåªæ˜¯ä¸ºäº†é˜…è¯»
#!/usr/bin/env bash # æŒ‡å®šç”¨ bash è§£é‡Šå™¨
# ===================== é…ç½®åŒº =====================
PROJECT_ROOT="/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/3. ESP32-å°æ™º/å‰¯æœ¬/xiaozhi-esp32-main" # é¡¹ç›®æ ¹ç›®å½•
IDF_ROOT="/storage/emulated/0/Download/OnePlus Share/ESP-IDFæºç /esp-idf-v5.5.1" # ESP-IDF æ ¹ç›®å½•
ENTRY_FILE="main/main.cc" # å…¥å£æºæ–‡ä»¶
OUT_SUBDIR="é¡¹ç›®åˆ†ææŠ¥å‘Š" # è¾“å‡ºå­ç›®å½•
# =================================================
set -euo pipefail # å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼šé‡é”™é€€å‡ºã€æœªå®šä¹‰å˜é‡æŠ¥é”™ã€ç®¡é“å¤±è´¥å³å¤±è´¥

main(){ # ä¸»å‡½æ•°
    local ENTRY_FULL="\${PROJECT_ROOT}/\${ENTRY_FILE}" # æ‹¼æ¥å…¥å£æ–‡ä»¶å®Œæ•´è·¯å¾„
    local OUT_FULL="\${PROJECT_ROOT}/\${OUT_SUBDIR}/$(basename "\${ENTRY_FILE}")-å±‚çº§ä¾èµ–æ ‘.txt" # è¾“å‡ºæ–‡ä»¶å®Œæ•´è·¯å¾„
    mkdir -p "$(dirname "\${OUT_FULL}")" # è‹¥è¾“å‡ºç›®å½•ä¸å­˜åœ¨åˆ™é€’å½’åˆ›å»º

    echo "â³ æ­£åœ¨æ‰«æå¤´æ–‡ä»¶ï¼Œè¯·ç¨ç­‰..." # æ‰“å°æç¤º
    declare -A HDR_MAP # å£°æ˜å…³è”æ•°ç»„ï¼Œç”¨äºå­˜å‚¨å¤´æ–‡ä»¶æ˜ å°„
    while IFS= read -r -d '' h; do # ä»¥ null ä¸ºåˆ†éš”ç¬¦è¯»å–æ‰€æœ‰ .h æ–‡ä»¶
        HDR_MAP["$(basename "$h")"]+="$h"$'\\n' # ä»¥æ–‡ä»¶åä¸ºé”®ï¼Œå®Œæ•´è·¯å¾„ä¸ºå€¼ï¼Œå…è®¸å¤šè·¯å¾„
    done < <(find "\${PROJECT_ROOT}" "\${IDF_ROOT}" -type f -iname '*.h' -print0) # åœ¨é¡¹ç›®æ ¹å’Œ IDF æ ¹ä¸‹æŸ¥æ‰¾æ‰€æœ‰å¤´æ–‡ä»¶

    extract(){ # å®šä¹‰æå–å¤´æ–‡ä»¶åçš„å‡½æ•°
        grep -oE '^\\s*#\\s*include\\s+["<][^">]+[">]' "$1" 2>/dev/null | # åŒ¹é… #include è¡Œ
        sed -E 's/^[^"<]*["<]//; s/[">].*$//' | # å»æ‰å‰åç¼€ï¼Œä¿ç•™æ–‡ä»¶å
        xargs -n1 basename 2>/dev/null || true # å– basenameï¼Œå¿½ç•¥é”™è¯¯
    }

    declare -A SEEN_INC        # ä»…ç”¨äºâ€œå·²æ‰“å°â€å»é‡
    declare -A STACK           # ç”¨äºå¾ªç¯ä¾èµ–æ£€æµ‹
    local ROOT_IDX=1 # æ ¹åºå·ä» 1 å¼€å§‹

    # DFS é€’å½’
    walk(){ # é€’å½’éå†ä¾èµ–
        local prefix=$1 inc=$2 lvl=$3 # å‚æ•°ï¼šå‰ç¼€ã€å½“å‰å¤´æ–‡ä»¶ã€å±‚çº§
        [[ -n "\${STACK[$inc]:-}" ]] && { printf "%*s%s: %s  [Circular Dependency!]\\n" $((lvl*2)) "" "\${prefix}" "\${inc}"; return; } # æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–
        [[ -n "\${SEEN_INC[\${inc}]:-}" ]] && return   # å·²æ‰“å°è¿‡å°±ä¸å†å±•å¼€
        SEEN_INC["\${inc}"]=1 # æ ‡è®°å·²æ‰“å°
        STACK["\${inc}"]=1 # å…¥æ ˆï¼Œç”¨äºå¾ªç¯æ£€æµ‹

        local found= # æ˜¯å¦æ‰¾åˆ°æ ‡å¿—
        local cand # å€™é€‰è·¯å¾„
        while IFS= read -r cand; do # è¯»å–è¯¥å¤´æ–‡ä»¶æ‰€æœ‰å¯èƒ½è·¯å¾„
            [[ -f "$cand" ]] || continue # æ–‡ä»¶ä¸å­˜åœ¨åˆ™è·³è¿‡
            local sub_counter=1 sub_inc # å­åºå·ä¸å¤´æ–‡ä»¶
            for sub_inc in $(extract "$cand"); do # æå–è¯¥å¤´æ–‡ä»¶åŒ…å«çš„å­å¤´æ–‡ä»¶
                local new_prefix="\${prefix}.\${sub_counter}" # æ„é€ æ–°å‰ç¼€
                printf "%*s%s: %s\\n" $((lvl*2)) "" "\${new_prefix}" "\${sub_inc}" # æ‰“å°å­èŠ‚ç‚¹
                walk "\${new_prefix}" "\${sub_inc}" $((lvl+1)) # é€’å½’
                ((sub_counter++)) # åºå·è‡ªå¢
            done
            found=1 # æ‰¾åˆ°è‡³å°‘ä¸€ä¸ªæœ‰æ•ˆè·¯å¾„
            break # åªå–ç¬¬ä¸€ä¸ªæœ‰æ•ˆè·¯å¾„
        done < <(printf '%s' "\${HDR_MAP[$inc]:-}") # ä»æ˜ å°„ä¸­è¯»å–è·¯å¾„åˆ—è¡¨

        [[ $found ]] || printf "%*s%s: %s  [Not Found]\\n" $((lvl*2)) "" "\${prefix}" "\${inc}" # æœªæ‰¾åˆ°æ–‡ä»¶
        unset STACK["\${inc}"]    # å›æº¯å‡ºæ ˆ
    }

    { # å¼€å§‹é‡å®šå‘åˆ°è¾“å‡ºæ–‡ä»¶
        printf "=== å±‚çº§ä¾èµ–æ ‘ï¼ˆæ— é»‘åå•ï¼Œå·²æ£€æµ‹å¾ªç¯ä¾èµ–ï¼‰ ===\\n" # æ ‡é¢˜
        printf "0: %s\\n" "$(basename "\${ENTRY_FILE}")" # æ‰“å°å…¥å£æ–‡ä»¶å
        local inc # ä¸´æ—¶å˜é‡
        for inc in $(extract "\${ENTRY_FULL}"); do # æå–å…¥å£æ–‡ä»¶ç›´æ¥åŒ…å«çš„å¤´æ–‡ä»¶
            printf "%d: %s\\n" "\${ROOT_IDX}" "\${inc}" # æ‰“å°ç¬¬ä¸€å±‚
            walk "\${ROOT_IDX}" "\${inc}" 1 # é€’å½’å±•å¼€
            ((ROOT_IDX++)) # æ ¹åºå·è‡ªå¢
        done
    } > "\${OUT_FULL}" # å…¨éƒ¨å†™å…¥æ–‡ä»¶

    echo "âœ… æ–°æ ¼å¼å±‚çº§ä¾èµ–æ ‘å·²å†™å…¥ï¼š\${OUT_FULL}" # å®Œæˆæç¤º
}

main "$@" # ä¼ å…¥æ‰€æœ‰å‚æ•°å¹¶æ‰§è¡Œä¸»å‡½æ•°
`,
  type: 'python',
  varName: 'as',
  size: 3123
};
var at = {
  index: 20,
  filename: '3. é¡¹ç›®åˆ†æ/3. tmåˆ†æstm32é¡¹ç›®.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/3. tmåˆ†æstm32é¡¹ç›®.py',
  content: `â€œæŠŠ 8~20 å·ä¾‹ç¨‹æ–‡ä»¶å¤¹é‡Œçš„ Core å­ç›®å½• tree ç»“æœï¼Œè¿åŒå¯¹åº”æ–‡ä»¶å¤¹åï¼Œä¸€æ¬¡æ€§è¿½åŠ å†™è¿›
/storage/emulated/0/Download/OnePlus\\ Share/GITHUB\\ å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/core_summary.txtâ€  

python3 -c "
# å¼•å…¥ subprocess ç”¨äºåœ¨ Python å†…è°ƒç”¨å¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ treeï¼‰
# å¼•å…¥ pathlib ç”¨äºé¢å‘å¯¹è±¡åœ°æ“ä½œæ–‡ä»¶ç³»ç»Ÿè·¯å¾„
# å¼•å…¥ re ç”¨äºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç›®å½•å
import subprocess, pathlib, re

# å°†æ ¹ç›®å½•å­—ç¬¦ä¸²å°è£…ä¸º Path å¯¹è±¡ï¼Œåç»­å¯ç›´æ¥ç”¨ / æ‹¼æ¥å­è·¯å¾„
root = pathlib.Path('/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£')

# æ‹¼æ¥è¾“å‡ºæ–‡ä»¶å®Œæ•´è·¯å¾„ï¼Œç­‰ä»·äº os.path.join(root, 'core_summary.txt')
out  = root/'core_summary.txt'

# ä»¥ UTF-8 ç¼–ç ã€è¦†ç›–å†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼›with å—ç»“æŸæ—¶ä¼šè‡ªåŠ¨ flush å¹¶å…³é—­æ–‡ä»¶
with out.open('w', encoding='utf-8') as f:
    # å¾ªç¯ç”Ÿæˆ 8 åˆ° 20ï¼ˆå«ï¼‰å…± 13 ä¸ªå®éªŒç¼–å·
    for n in range(8, 21):
        # ä¸ºå½“å‰ç¼–å·æ„é€ æ­£åˆ™å…³é”®å­—ï¼š
        # é 19 æ—¶ç²¾ç¡®åŒ¹é… "[n]"ï¼›19 æ—¶åŒ¹é… "[19" å‰ç¼€ï¼Œä»è€Œè¦†ç›– 19-1 åˆ° 19-10
        key = fr'\\[{n}\\]' if n != 19 else r'\\[19'

        # æŒ‰å­—å…¸åºéå†æ ¹ç›®å½•ä¸‹æ‰€æœ‰ç›´æ¥å­é¡¹ï¼ˆæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼‰
        for d in sorted(root.iterdir()):
            # åªå¤„ç†ç›®å½•ï¼Œä¸”ç›®å½•åå¿…é¡»æ»¡è¶³ä¸Šé¢æ„é€ çš„æ­£åˆ™
            if d.is_dir() and re.search(key, d.name):
                # å®šä½åˆ°è¯¥å®éªŒç›®å½•ä¸‹çš„ Core å­ç›®å½•
                core = d/'Core'
                # åªæœ‰ Core ç›®å½•çœŸå®å­˜åœ¨æ—¶æ‰å†™å…¥æ ‡é¢˜å¹¶ç”Ÿæˆæ ‘çŠ¶å›¾
                if core.exists():
                    # å†™å…¥åˆ†éš”è¡Œï¼Œæ–¹ä¾¿é˜…è¯»
                    f.write(f'\\n======== {d.name} ========\\n')
                    # è°ƒç”¨ç³»ç»Ÿ tree å‘½ä»¤ï¼ŒæŠŠæ ‘çŠ¶å›¾ç›´æ¥é‡å®šå‘åˆ°æ–‡ä»¶ï¼›
                    # stderr ä¹Ÿåˆå¹¶åˆ° stdoutï¼Œä¿è¯æŠ¥é”™ä¿¡æ¯ä¸ä¼šå‡ºç°åœ¨ç»ˆç«¯
                    subprocess.run(['tree', str(core)], stdout=f, stderr=subprocess.STDOUT)
                # ä¸ breakï¼Œç»§ç»­å¾ªç¯ï¼Œç¡®ä¿åŒä¸€ç¼–å·ï¼ˆå°¤å…¶æ˜¯ 19-xï¼‰å…¨éƒ¨è¢«æŠ“å–
"
`,
  type: 'python',
  varName: 'at',
  size: 1441
};
var au = {
  index: 21,
  filename: '3. é¡¹ç›®åˆ†æ/7. ç”Ÿæˆæ–‡ä»¶å·®å¼‚æŠ¥å‘Šï¼ˆä¸¤æ–‡ä»¶ï¼‰2ç‰ˆ.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/7. ç”Ÿæˆæ–‡ä»¶å·®å¼‚æŠ¥å‘Šï¼ˆä¸¤æ–‡ä»¶ï¼‰2ç‰ˆ.py',
  content: `python3 -x <<'EOF'   #   Pythonè½¬bash
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import sys
import re
import difflib
import argparse
from datetime import datetime
from pathlib import Path

def parse_arguments():
    """å¤„ç†å‘½ä»¤è¡Œå‚æ•°æˆ–ä½¿ç”¨é»˜è®¤è·¯å¾„"""
    if len(sys.argv) == 4:  # ä¸‰ä¸ªå‚æ•°ï¼šæ–‡ä»¶1ã€æ–‡ä»¶2ã€è¾“å‡ºç›®å½•
        file1, file2, report_dir = sys.argv[1], sys.argv[2], sys.argv[3]
    elif len(sys.argv) == 1:  # æ— å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤è·¯å¾„
        file1 = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/[19-5]ä¸²å£æ¥æ”¶ä¹‹ä¸­æ–­æ¥æ”¶å®šé•¿æ•°æ®/Core/Src/main.c"
        file2 = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/[19-7]ä¸²å£æ¥æ”¶ä¹‹ç©ºé—²ä¸­æ–­æ¥æ”¶ä¸å®šé•¿æ•°æ®/Core/Src/main.c"
        report_dir = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£/é¡¹ç›®åˆ†ææŠ¥å‘Š/å·®å¼‚æ–‡ä»¶/"
    else:  # å‚æ•°æ•°é‡ä¸æ­£ç¡®
        print(f"ç”¨æ³•: {sys.argv[0]} [æ–‡ä»¶1 æ–‡ä»¶2 è¾“å‡ºç›®å½•]")
        print(f"ç¤ºä¾‹: {sys.argv[0]} /path/to/file1.c /path/to/file2.c /path/to/output")
        print("æ³¨æ„: ä¸å¸¦å‚æ•°ä½¿ç”¨é»˜è®¤è·¯å¾„")
        sys.exit(1)
    
    return file1, file2, report_dir

def initialize_settings(report_dir):
    """åˆ›å»ºæ—¶é—´æˆ³å’ŒæŠ¥å‘Šæ–‡ä»¶è·¯å¾„"""
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    html_diff_report = os.path.join(report_dir, f"ä»£ç å·®å¼‚æŠ¥å‘Š_{timestamp}.html")
    analysis_report = os.path.join(report_dir, f"å·®å¼‚åˆ†ææŠ¥å‘Š_{timestamp}.txt")
    
    # åˆ›å»ºè¾“å‡ºç›®å½•
    Path(report_dir).mkdir(parents=True, exist_ok=True)
    
    return timestamp, html_diff_report, analysis_report

def check_files(file1, file2):
    """éªŒè¯æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯è®¿é—®"""
    if not os.path.isfile(file1):
        raise FileNotFoundError(f"æ–‡ä»¶ä¸å­˜åœ¨: {file1}")
    if not os.path.isfile(file2):
        raise FileNotFoundError(f"æ–‡ä»¶ä¸å­˜åœ¨: {file2}")

def safe_read_file(filepath):
    """å®‰å…¨è¯»å–æ–‡ä»¶ï¼Œå¤„ç†ç¼–ç é—®é¢˜"""
    encodings = ['utf-8', 'gbk', 'gb2312', 'latin-1']
    for encoding in encodings:
        try:
            with open(filepath, 'r', encoding=encoding) as f:
                return f.readlines(), encoding
        except UnicodeDecodeError:
            continue
    # å¦‚æœæ‰€æœ‰ç¼–ç éƒ½å¤±è´¥ï¼Œä½¿ç”¨å¿½ç•¥é”™è¯¯çš„æ–¹å¼è¯»å–
    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
        return f.readlines(), 'utf-8'

def generate_html_diff_report(file1, file2, html_report_path):
    """ç”ŸæˆHTMLæ ¼å¼çš„å·®å¼‚æŠ¥å‘Š"""
    file1_lines, enc1 = safe_read_file(file1)
    file2_lines, enc2 = safe_read_file(file2)
    
    # ç”ŸæˆHTMLæ ¼å¼çš„diffæŠ¥å‘Š
    html_diff = difflib.HtmlDiff().make_file(
        file1_lines, file2_lines, 
        fromdesc=file1, todesc=file2,
        context=True, numlines=3
    )
    
    with open(html_report_path, 'w', encoding='utf-8') as html_file:
        html_file.write(html_diff)
    
    return html_diff

def get_file_info(filepath):
    """è·å–æ–‡ä»¶åŸºæœ¬ä¿¡æ¯ - å¤§å°ã€è¡Œæ•°ç­‰"""
    file_stat = os.stat(filepath)
    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
        line_count = sum(1 for _ in f)
    
    return {
        'name': os.path.basename(filepath),
        'path': os.path.dirname(filepath),
        'size': file_stat.st_size,
        'lines': line_count
    }

def generate_diff_content(file1, file2):
    """ç”Ÿæˆå†…å­˜ä¸­çš„diffå†…å®¹ç”¨äºåˆ†æ"""
    file1_lines, enc1 = safe_read_file(file1)
    file2_lines, enc2 = safe_read_file(file2)
    
    # ç”Ÿæˆunified diffæ ¼å¼
    diff = difflib.unified_diff(file1_lines, file2_lines, 
                               fromfile=file1, tofile=file2, n=3)
    
    return list(diff)

def analyze_diff_statistics(diff_content):
    """åˆ†æå·®å¼‚ç»Ÿè®¡ - ç»Ÿè®¡æ–°å¢è¡Œã€åˆ é™¤è¡Œã€å˜æ›´åŒºå—"""
    added = sum(1 for line in diff_content if line.startswith('+') and not line.startswith('+++'))
    deleted = sum(1 for line in diff_content if line.startswith('-') and not line.startswith('---'))
    changed_blocks = sum(1 for line in diff_content if line.startswith('@@'))
    
    return added, deleted, changed_blocks

def parse_diff_blocks(diff_content, limit=50):
    """è§£ædiffåŒºå— - æå–å˜æ›´çš„è¯¦ç»†ä½ç½®ä¿¡æ¯"""
    blocks = []
    current_block = {}
    
    for line in diff_content[:limit]:  # é™åˆ¶åˆ†æè¡Œæ•°
        if line.startswith('@@'):
            # è§£æåŒºå—å¤´ä¿¡æ¯ï¼š@@ -å¼€å§‹è¡Œ,è¡Œæ•° +å¼€å§‹è¡Œ,è¡Œæ•° @@
            match = re.match(r'@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@', line)
            if match:
                if current_block:  # ä¿å­˜ä¸Šä¸€ä¸ªåŒºå—
                    blocks.append(current_block)
                
                # è§£æè¡Œå·ä¿¡æ¯
                start1 = int(match.group(1))
                count1 = int(match.group(2)) if match.group(2) else 1
                start2 = int(match.group(3))
                count2 = int(match.group(4)) if match.group(4) else 1
                
                current_block = {
                    'header': line.strip(),
                    'start1': start1,
                    'end1': start1 + count1 - 1,
                    'start2': start2,
                    'end2': start2 + count2 - 1,
                    'changes': []
                }
        elif line.startswith('-') and not line.startswith('---'):
            current_block['changes'].append(('delete', line[1:].rstrip()))
        elif line.startswith('+') and not line.startswith('+++'):
            current_block['changes'].append(('add', line[1:].rstrip()))
    
    if current_block:
        blocks.append(current_block)
    
    return blocks

def detect_key_changes(diff_content, keywords):
    """æ£€æµ‹å…³é”®å˜æ›´ - è¯†åˆ«ç‰¹å®šçš„ä»£ç æ¨¡å¼ï¼ˆå¦‚ä¸²å£ç›¸å…³å˜æ›´ï¼‰"""
    key_changes = []
    for line in diff_content:
        if any(keyword.lower() in line.lower() for keyword in keywords):
            change_type = 'delete' if line.startswith('-') else 'add' if line.startswith('+') else 'context'
            key_changes.append((change_type, line.rstrip()))
    
    return key_changes

def generate_analysis_report(file1_info, file2_info, diff_content, analysis_report_path):
    """ç”Ÿæˆæ–‡æœ¬æ ¼å¼çš„è¯¦ç»†åˆ†ææŠ¥å‘Š"""
    with open(analysis_report_path, 'w', encoding='utf-8') as report:
        # æŠ¥å‘Šå¤´éƒ¨
        report.write("=" * 60 + "\\n")
        report.write("                  ä»£ç å·®å¼‚åˆ†ææŠ¥å‘Š\\n")
        report.write("=" * 60 + "\\n")
        report.write(f"ç”Ÿæˆæ—¶é—´: {datetime.now()}\\n")
        report.write(f"æ¯”è¾ƒæ–‡ä»¶: {file1_info['name']} â†” {file2_info['name']}\\n\\n")
        
        # 1. æ–‡ä»¶åŸºæœ¬ä¿¡æ¯
        report.write("ä¸€ã€æ–‡ä»¶åŸºæœ¬ä¿¡æ¯\\n")
        report.write("=" * 25 + "\\n")
        report.write("1. æºæ–‡ä»¶:\\n")
        report.write(f"   - æ–‡ä»¶å: {file1_info['name']}\\n")
        report.write(f"   - è·¯å¾„: {file1_info['path']}\\n")
        report.write(f"   - å¤§å°: {file1_info['size']} å­—èŠ‚\\n")
        report.write(f"   - è¡Œæ•°: {file1_info['lines']} è¡Œ\\n\\n")
        
        report.write("2. ç›®æ ‡æ–‡ä»¶:\\n")
        report.write(f"   - æ–‡ä»¶å: {file2_info['name']}\\n")
        report.write(f"   - è·¯å¾„: {file2_info['path']}\\n")
        report.write(f"   - å¤§å°: {file2_info['size']} å­—èŠ‚\\n")
        report.write(f"   - è¡Œæ•°: {file2_info['lines']} è¡Œ\\n\\n")
        
        # 2. å·®å¼‚ç»Ÿè®¡
        added, deleted, changed_blocks = analyze_diff_statistics(diff_content)
        report.write("äºŒã€å·®å¼‚ç»Ÿè®¡æ‘˜è¦\\n")
        report.write("=" * 25 + "\\n")
        report.write("1. åŸºæœ¬ç»Ÿè®¡:\\n")
        report.write(f"   - æºæ–‡ä»¶æ€»è¡Œæ•°: {file1_info['lines']}\\n")
        report.write(f"   - ç›®æ ‡æ–‡ä»¶æ€»è¡Œæ•°: {file2_info['lines']}\\n")
        report.write(f"   - è¡Œæ•°å·®å¼‚: {file2_info['lines'] - file1_info['lines']} è¡Œ\\n\\n")
        
        report.write("2. å˜æ›´ç»Ÿè®¡:\\n")
        report.write(f"   - æ–°å¢è¡Œæ•°: {added}\\n")
        report.write(f"   - åˆ é™¤è¡Œæ•°: {deleted}\\n")
        report.write(f"   - å˜æ›´åŒºå—æ•°: {changed_blocks}\\n\\n")
        
        # 3. è¯¦ç»†å·®å¼‚åˆ†æ
        report.write("ä¸‰ã€è¯¦ç»†å·®å¼‚åˆ†æ\\n")
        report.write("=" * 25 + "\\n")
        
        if added == 0 and deleted == 0:
            report.write("âœ… ä¸¤ä¸ªæ–‡ä»¶å†…å®¹å®Œå…¨ä¸€è‡´\\n")
        else:
            report.write(f"âŒ æ–‡ä»¶å­˜åœ¨å·®å¼‚ï¼Œå…±å‘ç° {changed_blocks} ä¸ªå˜æ›´åŒºå—\\n\\n")
            
            blocks = parse_diff_blocks(diff_content)
            for i, block in enumerate(blocks, 1):
                if i > 1:
                    report.write("\\n\\n")  # åŒºå—é—´ç©ºè¡Œ
                
                report.write(f"ã€å˜æ›´åŒºå— {i}ã€‘@@{block['start1']}-{block['end1']}è¡Œ â†” {block['start2']}-{block['end2']}è¡Œ@@\\n")
                
                for change_type, content in block['changes'][:10]:  # é™åˆ¶æ¯ä¸ªåŒºå—æ˜¾ç¤º10ä¸ªå˜æ›´
                    if change_type == 'delete':
                        report.write(f"  âŒ åˆ é™¤: {content}\\n")
                    else:
                        report.write(f"      âœ… æ–°å¢: {content}\\n")
            report.write("\\n")
        
        # 4. å…³é”®å˜æ›´è¯†åˆ«
        report.write("å››ã€å…³é”®å˜æ›´è¯†åˆ«\\n")
        report.write("=" * 25 + "\\n")
        uart_keywords = ['HAL_UART', 'USART', 'ä¸­æ–­', 'interrupt']
        key_changes = detect_key_changes(diff_content, uart_keywords)
        
        if key_changes:
            report.write("ğŸ”§ æ£€æµ‹åˆ°ä¸²å£ç›¸å…³å˜æ›´:\\n")
            for change_type, content in key_changes[:5]:  # æ˜¾ç¤ºå‰5ä¸ªå…³é”®å˜æ›´
                if change_type == 'delete':
                    report.write(f"  âŒ åˆ é™¤: {content}\\n")
                elif change_type == 'add':
                    report.write(f"     âœ… æ–°å¢: {content}\\n")
        else:
            report.write("   æœªæ£€æµ‹åˆ°æ˜æ˜¾çš„ä¸²å£ç›¸å…³å˜æ›´\\n")
        report.write("\\n")
        
        # 5. æ€»ç»“ä¸å»ºè®®
        report.write("äº”ã€æ€»ç»“ä¸å»ºè®®\\n")
        report.write("=" * 25 + "\\n")
        
        if added == 0 and deleted == 0:
            report.write("âœ… æ–‡ä»¶å®Œå…¨ç›¸åŒï¼Œæ— éœ€è¿›ä¸€æ­¥æ“ä½œ\\n")
        else:
            total_changes = added + deleted
            total_lines = max(file1_info['lines'], 1)  # é¿å…é™¤é›¶
            change_ratio = (total_changes * 100) // total_lines
            
            report.write("ğŸ“Š å˜æ›´ç¨‹åº¦åˆ†æ:\\n")
            report.write(f"   - æ€»å˜æ›´è¡Œæ•°: {total_changes}\\n")
            report.write(f"   - å˜æ›´ç‡: {change_ratio}%\\n\\n")
            report.write("ğŸ’¡ å¤„ç†å»ºè®®:\\n")
            
            if change_ratio < 10:
                report.write("   è½»å¾®å˜æ›´ - å»ºè®®é‡ç‚¹å®¡æŸ¥å…·ä½“å˜æ›´è¡Œ\\n")
            elif change_ratio < 30:
                report.write("   ä¸­ç­‰å˜æ›´ - éœ€è¦ä»”ç»†å®¡æŸ¥å˜æ›´é€»è¾‘\\n")
            else:
                report.write("   é‡å¤§å˜æ›´ - å»ºè®®å…¨é¢æµ‹è¯•éªŒè¯\\n")
        
        report.write("\\n" + "=" * 60 + "\\n")
        report.write("æŠ¥å‘Šç”Ÿæˆå®Œæˆ\\n")
        report.write("=" * 60 + "\\n")

def main():
    """ä¸»å‡½æ•° - åè°ƒæ•´ä¸ªå·®å¼‚åˆ†ææµç¨‹"""
    try:
        # 1. å‚æ•°è§£æ
        file1, file2, report_dir = parse_arguments()
        
        # 2. åˆå§‹åŒ–è®¾ç½®
        timestamp, html_diff_report, analysis_report = initialize_settings(report_dir)
        
        # 3. æ–‡ä»¶æ£€æŸ¥
        check_files(file1, file2)
        
        # 4. è·å–æ–‡ä»¶ä¿¡æ¯
        file1_info = get_file_info(file1)
        file2_info = get_file_info(file2)
        
        # 5. ç”ŸæˆHTMLæ ¼å¼çš„å·®å¼‚æŠ¥å‘Š
        generate_html_diff_report(file1, file2, html_diff_report)
        
        # 6. ç”Ÿæˆå†…å­˜ä¸­çš„diffå†…å®¹ç”¨äºåˆ†æ
        diff_content = generate_diff_content(file1, file2)
        
        # 7. ç”Ÿæˆæ–‡æœ¬æ ¼å¼çš„è¯¦ç»†åˆ†ææŠ¥å‘Š
        generate_analysis_report(file1_info, file2_info, diff_content, analysis_report)
        
        # 8. è¾“å‡ºå®Œæˆä¿¡æ¯
        print("âœ… å·®å¼‚åˆ†æå®Œæˆï¼\\n")
        print("ğŸ“Š ç”Ÿæˆçš„æŠ¥å‘Šæ–‡ä»¶:")
        print(f"   1. HTMLä»£ç å·®å¼‚æŠ¥å‘Š: {html_diff_report}")
        print(f"   2. æ–‡æœ¬å·®å¼‚åˆ†ææŠ¥å‘Š: {analysis_report}\\n")
        print("ğŸ’¡ ä½¿ç”¨æç¤º:")
        print("   - HTMLæŠ¥å‘Šæä¾›ç›´è§‚çš„ä»£ç å·®å¼‚å¯è§†åŒ–")
        print("   - æ–‡æœ¬åˆ†ææŠ¥å‘ŠåŒ…å«æ‰€æœ‰å…³é”®å·®å¼‚ä¿¡æ¯")
        print(f"   - å¯é€šè¿‡å‚æ•°æŒ‡å®šæ–‡ä»¶è·¯å¾„: {sys.argv[0]} æ–‡ä»¶1 æ–‡ä»¶2 è¾“å‡ºç›®å½•")
        
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()

EOF`,
  type: 'python',
  varName: 'au',
  size: 11071
};
var av = {
  index: 22,
  filename: '3. é¡¹ç›®åˆ†æ/8. ç”Ÿæˆæ–‡ä»¶å·®å¼‚æŠ¥å‘Šï¼ˆé¡¹ç›®ï¼‰.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/8. ç”Ÿæˆæ–‡ä»¶å·®å¼‚æŠ¥å‘Šï¼ˆé¡¹ç›®ï¼‰.py',
  content: `#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import sys
import re
import difflib
import glob
from datetime import datetime
from pathlib import Path

# åŸºç¡€ç›®å½•é…ç½®
BASE_DIR = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£"
REPORT_DIR = os.path.join(BASE_DIR, "é¡¹ç›®åˆ†ææŠ¥å‘Š", "mainå·®å¼‚åˆ†æ")
HTML_REPORT_DIR = os.path.join(BASE_DIR, "é¡¹ç›®åˆ†ææŠ¥å‘Š", "mainå·®å¼‚åˆ†æHTML")  # HTMLæŠ¥å‘Šç›®å½•
BASE_PROJECT = "[8] STM32CubeMXæ–°å»ºMDKå·¥ç¨‹"  # åŸºå‡†é¡¹ç›®åç§°

def safe_read_file(filepath):
    """å®‰å…¨è¯»å–æ–‡ä»¶ï¼Œå¤„ç†ç¼–ç é—®é¢˜"""
    encodings = ['utf-8', 'gbk', 'gb2312', 'latin-1']
    for encoding in encodings:
        try:
            with open(filepath, 'r', encoding=encoding) as f:
                return f.readlines(), encoding
        except UnicodeDecodeError:
            continue
    # å¦‚æœæ‰€æœ‰ç¼–ç éƒ½å¤±è´¥ï¼Œä½¿ç”¨å¿½ç•¥é”™è¯¯çš„æ–¹å¼è¯»å–
    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
        return f.readlines(), 'utf-8'

def get_file_info(filepath):
    """è·å–æ–‡ä»¶åŸºæœ¬ä¿¡æ¯ - å¤§å°ã€è¡Œæ•°ç­‰"""
    if not os.path.isfile(filepath):
        return None
    
    file_stat = os.stat(filepath)
    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
        line_count = sum(1 for _ in f)
    
    return {
        'name': os.path.basename(filepath),
        'path': os.path.dirname(filepath),
        'size': file_stat.st_size,
        'lines': line_count
    }

def generate_html_diff_report(file1, file2, html_report_path):
    """ç”ŸæˆHTMLæ ¼å¼çš„å·®å¼‚æŠ¥å‘Š"""
    file1_lines, enc1 = safe_read_file(file1)
    file2_lines, enc2 = safe_read_file(file2)
    
    # ç”ŸæˆHTMLæ ¼å¼çš„diffæŠ¥å‘Š
    html_diff = difflib.HtmlDiff(
        tabsize=4,
        wrapcolumn=80,
        linejunk=None,
        charjunk=difflib.IS_CHARACTER_JUNK
    ).make_file(
        file1_lines, file2_lines, 
        fromdesc=os.path.basename(file1), 
        todesc=os.path.basename(file2),
        context=True, numlines=5
    )
    
    # æ·»åŠ è‡ªå®šä¹‰CSSæ ·å¼
    html_diff = html_diff.replace(
        '</head>',
        '<style>\\n'
        '  body { font-family: Arial, sans-serif; }\\n'
        '  table.diff { width: 100%; border-collapse: collapse; }\\n'
        '  .diff_header { background-color: #f0f0f0; font-weight: bold; }\\n'
        '  td.diff_header { text-align: right; padding: 4px 8px; }\\n'
        '  .diff_next { background-color: #c0c0c0; }\\n'
        '  .diff_add { background-color: #aaffaa; }\\n'
        '  .diff_chg { background-color: #ffff77; }\\n'
        '  .diff_sub { background-color: #ffaaaa; }\\n'
        '  .diff_pagenav { text-align: center; padding: 10px; }\\n'
        '  .diff_add:hover, .diff_chg:hover, .diff_sub:hover { background-color: #ffd700; }\\n'
        '  .diff_line { font-family: "Courier New", monospace; font-size: 14px; }\\n'
        '</style>\\n'
        '</head>'
    )
    
    with open(html_report_path, 'w', encoding='utf-8') as html_file:
        html_file.write(html_diff)
    
    return html_diff

def generate_diff_content(file1, file2):
    """ç”Ÿæˆå†…å­˜ä¸­çš„diffå†…å®¹ç”¨äºåˆ†æ"""
    file1_lines, enc1 = safe_read_file(file1)
    file2_lines, enc2 = safe_read_file(file2)
    
    # ç”Ÿæˆunified diffæ ¼å¼
    diff = difflib.unified_diff(file1_lines, file2_lines, 
                               fromfile=file1, tofile=file2, n=3)
    
    return list(diff)

def analyze_diff_statistics(diff_content):
    """åˆ†æå·®å¼‚ç»Ÿè®¡ - ç»Ÿè®¡æ–°å¢è¡Œã€åˆ é™¤è¡Œã€å˜æ›´åŒºå—"""
    added = sum(1 for line in diff_content if line.startswith('+') and not line.startswith('+++'))
    deleted = sum(1 for line in diff_content if line.startswith('-') and not line.startswith('---'))
    changed_blocks = sum(1 for line in diff_content if line.startswith('@@'))
    
    return added, deleted, changed_blocks

def parse_diff_blocks(diff_content, limit=50):
    """è§£ædiffåŒºå— - æå–å˜æ›´çš„è¯¦ç»†ä½ç½®ä¿¡æ¯"""
    blocks = []
    current_block = {}
    
    for line in diff_content[:limit]:  # é™åˆ¶åˆ†æè¡Œæ•°
        if line.startswith('@@'):
            # è§£æåŒºå—å¤´ä¿¡æ¯ï¼š@@ -å¼€å§‹è¡Œ,è¡Œæ•° +å¼€å§‹è¡Œ,è¡Œæ•° @@
            match = re.match(r'@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@', line)
            if match:
                if current_block:  # ä¿å­˜ä¸Šä¸€ä¸ªåŒºå—
                    blocks.append(current_block)
                
                # è§£æè¡Œå·ä¿¡æ¯
                start1 = int(match.group(1))
                count1 = int(match.group(2)) if match.group(2) else 1
                start2 = int(match.group(3))
                count2 = int(match.group(4)) if match.group(4) else 1
                
                current_block = {
                    'header': line.strip(),
                    'start1': start1,
                    'end1': start1 + count1 - 1,
                    'start2': start2,
                    'end2': start2 + count2 - 1,
                    'changes': []
                }
        elif line.startswith('-') and not line.startswith('---'):
            current_block['changes'].append(('delete', line[1:].rstrip()))
        elif line.startswith('+') and not line.startswith('+++'):
            current_block['changes'].append(('add', line[1:].rstrip()))
    
    if current_block:
        blocks.append(current_block)
    
    return blocks

def detect_key_changes(diff_content, keywords):
    """æ£€æµ‹å…³é”®å˜æ›´ - è¯†åˆ«ç‰¹å®šçš„ä»£ç æ¨¡å¼ï¼ˆå¦‚ä¸²å£ç›¸å…³å˜æ›´ï¼‰"""
    key_changes = []
    for line in diff_content:
        if any(keyword.lower() in line.lower() for keyword in keywords):
            change_type = 'delete' if line.startswith('-') else 'add' if line.startswith('+') else 'context'
            key_changes.append((change_type, line.rstrip()))
    
    return key_changes

def generate_analysis_report(file1_info, file2_info, diff_content, analysis_report_path):
    """ç”Ÿæˆæ–‡æœ¬æ ¼å¼çš„è¯¦ç»†åˆ†ææŠ¥å‘Š"""
    with open(analysis_report_path, 'w', encoding='utf-8') as report:
        # æŠ¥å‘Šå¤´éƒ¨
        report.write("=" * 60 + "\\n")
        report.write("                  ä»£ç å·®å¼‚åˆ†ææŠ¥å‘Š\\n")
        report.write("=" * 60 + "\\n")
        report.write(f"ç”Ÿæˆæ—¶é—´: {datetime.now()}\\n")
        report.write(f"æ¯”è¾ƒæ–‡ä»¶: {file1_info['name']} â†” {file2_info['name']}\\n\\n")
        
        # 1. æ–‡ä»¶åŸºæœ¬ä¿¡æ¯
        report.write("ä¸€ã€æ–‡ä»¶åŸºæœ¬ä¿¡æ¯\\n")
        report.write("=" * 25 + "\\n")
        report.write("1. æºæ–‡ä»¶ (åŸºå‡†é¡¹ç›®08):\\n")
        report.write(f"   - æ–‡ä»¶å: {file1_info['name']}\\n")
        report.write(f"   - è·¯å¾„: {file1_info['path']}\\n")
        report.write(f"   - å¤§å°: {file1_info['size']} å­—èŠ‚\\n")
        report.write(f"   - è¡Œæ•°: {file1_info['lines']} è¡Œ\\n\\n")
        
        report.write("2. ç›®æ ‡æ–‡ä»¶:\\n")
        report.write(f"   - æ–‡ä»¶å: {file2_info['name']}\\n")
        report.write(f"   - è·¯å¾„: {file2_info['path']}\\n")
        report.write(f"   - å¤§å°: {file2_info['size']} å­—èŠ‚\\n")
        report.write(f"   - è¡Œæ•°: {file2_info['lines']} è¡Œ\\n\\n")
        
        # 2. å·®å¼‚ç»Ÿè®¡
        added, deleted, changed_blocks = analyze_diff_statistics(diff_content)
        report.write("äºŒã€å·®å¼‚ç»Ÿè®¡æ‘˜è¦\\n")
        report.write("=" * 25 + "\\n")
        report.write("1. åŸºæœ¬ç»Ÿè®¡:\\n")
        report.write(f"   - åŸºå‡†æ–‡ä»¶æ€»è¡Œæ•°: {file1_info['lines']}\\n")
        report.write(f"   - ç›®æ ‡æ–‡ä»¶æ€»è¡Œæ•°: {file2_info['lines']}\\n")
        report.write(f"   - è¡Œæ•°å·®å¼‚: {file2_info['lines'] - file1_info['lines']} è¡Œ\\n\\n")
        
        report.write("2. å˜æ›´ç»Ÿè®¡:\\n")
        report.write(f"   - æ–°å¢è¡Œæ•°: {added}\\n")
        report.write(f"   - åˆ é™¤è¡Œæ•°: {deleted}\\n")
        report.write(f"   - å˜æ›´åŒºå—æ•°: {changed_blocks}\\n\\n")
        
        # 3. è¯¦ç»†å·®å¼‚åˆ†æ
        report.write("ä¸‰ã€è¯¦ç»†å·®å¼‚åˆ†æ\\n")
        report.write("=" * 25 + "\\n")
        
        if added == 0 and deleted == 0:
            report.write("âœ… ä¸¤ä¸ªæ–‡ä»¶å†…å®¹å®Œå…¨ä¸€è‡´\\n")
        else:
            report.write(f"âŒ æ–‡ä»¶å­˜åœ¨å·®å¼‚ï¼Œå…±å‘ç° {changed_blocks} ä¸ªå˜æ›´åŒºå—\\n\\n")
            
            blocks = parse_diff_blocks(diff_content)
            for i, block in enumerate(blocks, 1):
                if i > 1:
                    report.write("\\n\\n")  # åŒºå—é—´ç©ºè¡Œ
                
                report.write(f"ã€å˜æ›´åŒºå— {i}ã€‘@@{block['start1']}-{block['end1']}è¡Œ â†” {block['start2']}-{block['end2']}è¡Œ@@\\n")
                
                for change_type, content in block['changes'][:10]:  # é™åˆ¶æ¯ä¸ªåŒºå—æ˜¾ç¤º10ä¸ªå˜æ›´
                    if change_type == 'delete':
                        report.write(f"  âŒ åˆ é™¤: {content}\\n")
                    else:
                        report.write(f"      âœ… æ–°å¢: {content}\\n")
            report.write("\\n")
        
        # 4. å…³é”®å˜æ›´è¯†åˆ«
        report.write("å››ã€å…³é”®å˜æ›´è¯†åˆ«\\n")
        report.write("=" * 25 + "\\n")
        uart_keywords = ['HAL_UART', 'USART', 'ä¸­æ–­', 'interrupt']
        key_changes = detect_key_changes(diff_content, uart_keywords)
        
        if key_changes:
            report.write("ğŸ”§ æ£€æµ‹åˆ°ä¸²å£ç›¸å…³å˜æ›´:\\n")
            for change_type, content in key_changes[:5]:  # æ˜¾ç¤ºå‰5ä¸ªå…³é”®å˜æ›´
                if change_type == 'delete':
                    report.write(f"  âŒ åˆ é™¤: {content}\\n")
                elif change_type == 'add':
                    report.write(f"     âœ… æ–°å¢: {content}\\n")
        else:
            report.write("   æœªæ£€æµ‹åˆ°æ˜æ˜¾çš„ä¸²å£ç›¸å…³å˜æ›´\\n")
        report.write("\\n")
        
        # 5. æ€»ç»“ä¸å»ºè®®
        report.write("äº”ã€æ€»ç»“ä¸å»ºè®®\\n")
        report.write("=" * 25 + "\\n")
        
        if added == 0 and deleted == 0:
            report.write("âœ… æ–‡ä»¶å®Œå…¨ç›¸åŒï¼Œæ— éœ€è¿›ä¸€æ­¥æ“ä½œ\\n")
        else:
            total_changes = added + deleted
            total_lines = max(file1_info['lines'], 1)  # é¿å…é™¤é›¶
            change_ratio = (total_changes * 100) // total_lines
            
            report.write("ğŸ“Š å˜æ›´ç¨‹åº¦åˆ†æ:\\n")
            report.write(f"   - æ€»å˜æ›´è¡Œæ•°: {total_changes}\\n")
            report.write(f"   - å˜æ›´ç‡: {change_ratio}%\\n\\n")
            report.write("ğŸ’¡ å¤„ç†å»ºè®®:\\n")
            
            if change_ratio < 10:
                report.write("   è½»å¾®å˜æ›´ - å»ºè®®é‡ç‚¹å®¡æŸ¥å…·ä½“å˜æ›´è¡Œ\\n")
            elif change_ratio < 30:
                report.write("   ä¸­ç­‰å˜æ›´ - éœ€è¦ä»”ç»†å®¡æŸ¥å˜æ›´é€»è¾‘\\n")
            else:
                report.write("   é‡å¤§å˜æ›´ - å»ºè®®å…¨é¢æµ‹è¯•éªŒè¯\\n")
        
        report.write("\\n" + "=" * 60 + "\\n")
        report.write("æŠ¥å‘Šç”Ÿæˆå®Œæˆ\\n")
        report.write("=" * 60 + "\\n")
        
        # æ·»åŠ HTMLæŠ¥å‘Šæç¤º
        report.write("\\næç¤º: æ›´ç›´è§‚çš„HTMLæ ¼å¼å·®å¼‚æŠ¥å‘Šå¯åœ¨ mainå·®å¼‚åˆ†æHTML ç›®å½•ä¸­æŸ¥çœ‹\\n")

def find_project_main_files():
    """æŸ¥æ‰¾æ‰€æœ‰é¡¹ç›®ä¸­çš„main.cæ–‡ä»¶ - ä½¿ç”¨Bashè„šæœ¬ç›¸åŒçš„æ‰«æé€»è¾‘"""
    projects = {}
    base_project_path = None
    
    # æŸ¥æ‰¾æ‰€æœ‰é¡¹ç›®æ–‡ä»¶å¤¹
    project_dirs = [d for d in os.listdir(BASE_DIR) 
                   if os.path.isdir(os.path.join(BASE_DIR, d)) 
                   and d != "é¡¹ç›®åˆ†ææŠ¥å‘Š"]
    
    for project_dir in project_dirs:
        full_path = os.path.join(BASE_DIR, project_dir)
        
        # ç¡®å®šæ‰«æç›®å½• - ä¸Bashè„šæœ¬ç›¸åŒçš„é€»è¾‘
        scan_dir = None
        if os.path.exists(os.path.join(full_path, "Core")):
            scan_dir = os.path.join(full_path, "Core")
        elif os.path.exists(os.path.join(full_path, "User")):
            scan_dir = os.path.join(full_path, "User")
        elif os.path.exists(os.path.join(full_path, "APP")):
            scan_dir = os.path.join(full_path, "APP")
        
        if not scan_dir:
            continue
        
        # æŸ¥æ‰¾main.cæ–‡ä»¶
        main_c_path = os.path.join(scan_dir, "Src", "main.c")
        if os.path.isfile(main_c_path):
            # ä¿å­˜é¡¹ç›®ä¿¡æ¯
            projects[project_dir] = main_c_path
            
            # æ£€æŸ¥æ˜¯å¦æ˜¯åŸºå‡†é¡¹ç›®
            if project_dir == BASE_PROJECT:
                base_project_path = main_c_path
    
    return projects, base_project_path

def compare_with_base_project():
    """å°†æ‰€æœ‰é¡¹ç›®ä¸åŸºå‡†é¡¹ç›®08è¿›è¡Œæ¯”è¾ƒ"""
    # ç¡®ä¿æŠ¥å‘Šç›®å½•å­˜åœ¨
    Path(REPORT_DIR).mkdir(parents=True, exist_ok=True)
    Path(HTML_REPORT_DIR).mkdir(parents=True, exist_ok=True)  # åˆ›å»ºHTMLæŠ¥å‘Šç›®å½•
    
    # æŸ¥æ‰¾æ‰€æœ‰é¡¹ç›®ä¸­çš„main.cæ–‡ä»¶
    projects, base_project_path = find_project_main_files()
    if not projects:
        print("æœªæ‰¾åˆ°ä»»ä½•é¡¹ç›®ä¸­çš„main.cæ–‡ä»¶")
        return
    
    if not base_project_path:
        print(f"é”™è¯¯: æœªæ‰¾åˆ°åŸºå‡†é¡¹ç›® {BASE_PROJECT} çš„ main.c æ–‡ä»¶")
        return
    
    # è·å–åŸºå‡†é¡¹ç›®æ–‡ä»¶ä¿¡æ¯
    base_info = get_file_info(base_project_path)
    if not base_info:
        print(f"é”™è¯¯: æ— æ³•è¯»å–åŸºå‡†é¡¹ç›®æ–‡ä»¶ {base_project_path}")
        return
    
    # æ¯”è¾ƒæ‰€æœ‰é¡¹ç›®ä¸åŸºå‡†é¡¹ç›®
    for project_name, project_file in projects.items():
        # è·³è¿‡åŸºå‡†é¡¹ç›®è‡ªèº«
        if project_name == BASE_PROJECT:
            continue
        
        # è·å–é¡¹ç›®æ–‡ä»¶ä¿¡æ¯
        project_info = get_file_info(project_file)
        if not project_info:
            print(f"è·³è¿‡å¯¹æ¯”: {project_file} ä¸å­˜åœ¨")
            continue
        
        # ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Šæ–‡ä»¶å
        report_name = f"é¡¹ç›®08_vs_{project_name}_å·®å¼‚åˆ†æ.txt"
        report_path = os.path.join(REPORT_DIR, report_name)
        
        # ç”ŸæˆHTMLæŠ¥å‘Šæ–‡ä»¶å
        html_report_name = f"é¡¹ç›®08_vs_{project_name}_å·®å¼‚åˆ†æ.html"
        html_report_path = os.path.join(HTML_REPORT_DIR, html_report_name)
        
        # ç”Ÿæˆå·®å¼‚å†…å®¹
        diff_content = generate_diff_content(base_project_path, project_file)
        
        # ç”ŸæˆHTMLå·®å¼‚æŠ¥å‘Š
        generate_html_diff_report(base_project_path, project_file, html_report_path)
        
        # ç”Ÿæˆæ–‡æœ¬åˆ†ææŠ¥å‘Š
        generate_analysis_report(base_info, project_info, diff_content, report_path)
        
        print(f"å·²ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Š: é¡¹ç›®08 vs {project_name}")
        print(f"   - æ–‡æœ¬æŠ¥å‘Š: {report_path}")
        print(f"   - HTMLæŠ¥å‘Š: {html_report_path}")

def main():
    """ä¸»å‡½æ•° - åè°ƒæ•´ä¸ªå·®å¼‚åˆ†ææµç¨‹"""
    try:
        print("å¼€å§‹æ‰«æé¡¹ç›®å¹¶ä¸é¡¹ç›®08è¿›è¡Œå¯¹æ¯”...")
        compare_with_base_project()
        print("\\nâœ… æ‰€æœ‰å·®å¼‚åˆ†æå®Œæˆï¼")
        print(f"ğŸ“Š æ–‡æœ¬æŠ¥å‘Šå·²ä¿å­˜è‡³: {REPORT_DIR}")
        print(f"ğŸŒ HTMLæŠ¥å‘Šå·²ä¿å­˜è‡³: {HTML_REPORT_DIR}")
        
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        import traceback
        traceback.print_exc()  # æ‰“å°è¯¦ç»†çš„é”™è¯¯å †æ ˆ
        sys.exit(1)

if __name__ == "__main__":
    main()
`,
  type: 'python',
  varName: 'av',
  size: 13297
};
var aw = {
  index: 23,
  filename: '3. é¡¹ç›®åˆ†æ/9. é¡¹ç›®æ¨¡å— mainå‡½æ•°å·®å¼‚.py',
  fullPath: '/storage/emulated/0/Download/OnePlus Share/03 - ä¸ªäººæµ‹è¯•/å¸¸ç”¨å·¥å…·è½¬å®‰å“/å¸¸ç”¨è„šæœ¬/B_10æœˆè„šæœ¬/3. é¡¹ç›®åˆ†æ/9. é¡¹ç›®æ¨¡å— mainå‡½æ•°å·®å¼‚.py',
  content: `# ç”Ÿæˆé¡¹ç›® å‡½æ•°å·®å¼‚æŠ¥å‘Šï¼Œä¾¿äºAIåˆ†æ
python3 -x <<'EOF'   #   Pythonè½¬bash
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import sys
import re
import difflib
from datetime import datetime
from pathlib import Path

# ==================== é…ç½®æ–‡ä»¶åŒºåŸŸ ====================
# ç”¨æˆ·å¯ä»¥ä¿®æ”¹ä»¥ä¸‹é…ç½®å‚æ•°

# åŸºç¡€ç›®å½•é…ç½®
BASE_DIR = "/storage/emulated/0/Download/OnePlus Share/GITHUB å¼€æºé¡¹ç›®/é¡¹ç›®01/é‡ç«å°æ™ºæ–‡æ¡£"
REPORT_DIR_NAME = "mainå‡½æ•°å·®å¼‚"  # æŠ¥å‘Šç›®å½•åç§°
BASE_PROJECT = "[8] STM32CubeMXæ–°å»ºMDKå·¥ç¨‹"  # åŸºå‡†é¡¹ç›®åç§°
REPORT_EXTENSION = ".c"  # æŠ¥å‘Šæ–‡ä»¶æ‰©å±•å

# æ–‡ä»¶æ‰«æé…ç½®
SCAN_DIRS = ["Core", "User", "APP"]  # æ‰«æçš„ç›®å½•åç§°
MAIN_FILE_PATH = "Src"  # main.cæ–‡ä»¶æ‰€åœ¨çš„å­ç›®å½•

# å‡½æ•°æå–é…ç½®
FUNCTION_PATTERN = r'(\\w+[\\w\\s*]+\\s+\\**\\s*(\\w+)\\s*\\([^{]*\\))\\s*\\{'  # åŒ¹é…å‡½æ•°å®šä¹‰çš„æ­£åˆ™è¡¨è¾¾å¼

# æŠ¥å‘Šæ ¼å¼é…ç½®
REPORT_WIDTH = 60  # æŠ¥å‘Šåˆ†éš”çº¿å®½åº¦
SECTION_WIDTH = 25  # ç« èŠ‚æ ‡é¢˜å®½åº¦

# ==================== ä»¥ä¸‹ä¸ºç¨‹åºä»£ç  ====================

# è®¡ç®—å®Œæ•´çš„æŠ¥å‘Šç›®å½•è·¯å¾„
REPORT_DIR = os.path.join(BASE_DIR, "é¡¹ç›®åˆ†ææŠ¥å‘Š", REPORT_DIR_NAME)

def safe_read_file(filepath):
    """å®‰å…¨è¯»å–æ–‡ä»¶ï¼Œå¤„ç†ç¼–ç é—®é¢˜"""
    encodings = ['utf-8', 'gbk', 'gb2312', 'latin-1']
    for encoding in encodings:
        try:
            with open(filepath, 'r', encoding=encoding) as f:
                return f.read(), encoding
        except UnicodeDecodeError:
            continue
    # å¦‚æœæ‰€æœ‰ç¼–ç éƒ½å¤±è´¥ï¼Œä½¿ç”¨å¿½ç•¥é”™è¯¯çš„æ–¹å¼è¯»å–
    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
        return f.read(), 'utf-8'

def get_file_info(filepath):
    """è·å–æ–‡ä»¶åŸºæœ¬ä¿¡æ¯ - å¤§å°ã€è¡Œæ•°ç­‰"""
    if not os.path.isfile(filepath):
        return None
    
    file_stat = os.stat(filepath)
    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
        line_count = sum(1 for _ in f)
    
    return {
        'name': os.path.basename(filepath),
        'path': os.path.dirname(filepath),
        'size': file_stat.st_size,
        'lines': line_count
    }

def extract_functions(content):
    """ä»Cä»£ç ä¸­æå–å‡½æ•°å®šä¹‰"""
    functions = {}
    
    # æŸ¥æ‰¾æ‰€æœ‰å‡½æ•°å®šä¹‰
    matches = list(re.finditer(FUNCTION_PATTERN, content, re.MULTILINE | re.DOTALL))
    
    for i, match in enumerate(matches):
        func_signature = match.group(1)  # å®Œæ•´çš„å‡½æ•°ç­¾å
        func_name = match.group(2)      # å‡½æ•°å
        
        # æŸ¥æ‰¾å‡½æ•°çš„å¼€å§‹å’Œç»“æŸä½ç½®
        start_pos = match.start()
        
        # æŸ¥æ‰¾åŒ¹é…çš„å¤§æ‹¬å·æ¥ç¡®å®šå‡½æ•°ä½“èŒƒå›´
        brace_count = 0
        func_start = -1
        func_end = -1
        
        # ä»åŒ¹é…ä½ç½®å¼€å§‹æŸ¥æ‰¾å‡½æ•°ä½“çš„å¼€å§‹
        pos = content.find('{', start_pos)
        if pos != -1:
            func_start = pos
            brace_count = 1
            pos += 1
            
            # æŸ¥æ‰¾åŒ¹é…çš„ç»“æŸå¤§æ‹¬å·
            while pos < len(content) and brace_count > 0:
                if content[pos] == '{':
                    brace_count += 1
                elif content[pos] == '}':
                    brace_count -= 1
                pos += 1
            
            if brace_count == 0:
                func_end = pos
                func_body = content[func_start:func_end]
                functions[func_name] = {
                    'signature': func_signature,
                    'body': func_body,
                    'full_function': func_signature + func_body
                }
    
    return functions

def compare_functions(base_functions, target_functions):
    """æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å‡½æ•°å·®å¼‚"""
    differences = {
        'added': {},      # ç›®æ ‡æ–‡ä»¶ä¸­æ–°å¢çš„å‡½æ•°
        'deleted': {},    # ç›®æ ‡æ–‡ä»¶ä¸­åˆ é™¤çš„å‡½æ•°  
        'modified': {}    # ä¿®æ”¹çš„å‡½æ•°ï¼ˆä¸¤ä¸ªæ–‡ä»¶ä¸­éƒ½æœ‰ä½†å†…å®¹ä¸åŒï¼‰
    }
    
    # æŸ¥æ‰¾æ–°å¢çš„å‡½æ•°
    for func_name in target_functions:
        if func_name not in base_functions:
            differences['added'][func_name] = target_functions[func_name]
    
    # æŸ¥æ‰¾åˆ é™¤çš„å‡½æ•°
    for func_name in base_functions:
        if func_name not in target_functions:
            differences['deleted'][func_name] = base_functions[func_name]
    
    # æŸ¥æ‰¾ä¿®æ”¹çš„å‡½æ•°
    for func_name in base_functions:
        if func_name in target_functions:
            base_func = base_functions[func_name]['full_function']
            target_func = target_functions[func_name]['full_function']
            
            if base_func != target_func:
                differences['modified'][func_name] = {
                    'base': base_functions[func_name],
                    'target': target_functions[func_name]
                }
    
    return differences

def generate_function_diff_report(file1_info, file2_info, differences, report_path):
    """ç”Ÿæˆå‡½æ•°çº§åˆ«çš„å·®å¼‚æŠ¥å‘Šï¼ˆå¸¦åºå·å’Œè¡¨æƒ…ç¬¦å·ï¼‰"""
    with open(report_path, 'w', encoding='utf-8') as report:
        # æŠ¥å‘Šå¤´éƒ¨
        report.write("=" * REPORT_WIDTH + "\\n")
        report.write("                  å‡½æ•°çº§åˆ«å·®å¼‚åˆ†ææŠ¥å‘Š\\n")
        report.write("=" * REPORT_WIDTH + "\\n")
        report.write(f"ç”Ÿæˆæ—¶é—´: {datetime.now()}\\n")
        report.write(f"æ¯”è¾ƒæ–‡ä»¶: {file1_info['name']} â†” {file2_info['name']}\\n\\n")
        
        # 1. æ–‡ä»¶åŸºæœ¬ä¿¡æ¯
        report.write("ä¸€ã€æ–‡ä»¶åŸºæœ¬ä¿¡æ¯\\n")
        report.write("=" * SECTION_WIDTH + "\\n")
        report.write("1. æºæ–‡ä»¶ (åŸºå‡†é¡¹ç›®08):\\n")
        report.write(f"   - æ–‡ä»¶å: {file1_info['name']}\\n")
        report.write(f"   - è·¯å¾„: {file1_info['path']}\\n")
        report.write(f"   - å¤§å°: {file1_info['size']} å­—èŠ‚\\n")
        report.write(f"   - è¡Œæ•°: {file1_info['lines']} è¡Œ\\n\\n")
        
        report.write("2. ç›®æ ‡æ–‡ä»¶:\\n")
        report.write(f"   - æ–‡ä»¶å: {file2_info['name']}\\n")
        report.write(f"   - è·¯å¾„: {file2_info['path']}\\n")
        report.write(f"   - å¤§å°: {file2_info['size']} å­—èŠ‚\\n")
        report.write(f"   - è¡Œæ•°: {file2_info['lines']} è¡Œ\\n\\n")
        
        # 2. å‡½æ•°å·®å¼‚ç»Ÿè®¡
        report.write("äºŒã€å‡½æ•°å·®å¼‚ç»Ÿè®¡\\n")
        report.write("=" * SECTION_WIDTH + "\\n")
        report.write(f"1. æ–°å¢å‡½æ•°: {len(differences['added'])} ä¸ª\\n")
        report.write(f"2. åˆ é™¤å‡½æ•°: {len(differences['deleted'])} ä¸ª\\n")
        report.write(f"3. ä¿®æ”¹å‡½æ•°: {len(differences['modified'])} ä¸ª\\n")
        report.write(f"4. æ€»å·®å¼‚å‡½æ•°: {len(differences['added']) + len(differences['deleted']) + len(differences['modified'])} ä¸ª\\n\\n")
        
        # 3. è¯¦ç»†å‡½æ•°å·®å¼‚ï¼ˆå¸¦åºå·å’Œè¡¨æƒ…ç¬¦å·ï¼‰
        report.write("ä¸‰ã€è¯¦ç»†å‡½æ•°å·®å¼‚\\n")
        report.write("=" * SECTION_WIDTH + "\\n")
        
        # 3.1 æ–°å¢å‡½æ•°ï¼ˆä½¿ç”¨ç»¿è‰²å¯¹å‹¾è¡¨æƒ…å’Œåºå·ï¼‰
        if differences['added']:
            report.write("\\nğŸ¯ æ–°å¢å‡½æ•°:\\n")
            report.write("-" * 20 + "\\n")
            for i, (func_name, func_info) in enumerate(differences['added'].items(), 1):
                report.write(f"\\nğŸ”¸ ç¬¬{i}ä¸ªæ–°å¢å‡½æ•°: {func_name}\\n")
                report.write(f"å®Œæ•´å‡½æ•°:\\n{func_info['full_function']}\\n")
                report.write("-" * 40 + "\\n")
        
        # 3.2 åˆ é™¤å‡½æ•°ï¼ˆä½¿ç”¨çº¢è‰²å‰å·è¡¨æƒ…å’Œåºå·ï¼‰
        if differences['deleted']:
            report.write("\\nğŸ¯ åˆ é™¤å‡½æ•°:\\n")
            report.write("-" * 20 + "\\n")
            for i, (func_name, func_info) in enumerate(differences['deleted'].items(), 1):
                report.write(f"\\nâŒ ç¬¬{i}ä¸ªåˆ é™¤å‡½æ•°: {func_name}\\n")
                report.write(f"å®Œæ•´å‡½æ•°:\\n{func_info['full_function']}\\n")
                report.write("-" * 40 + "\\n")
        
        # 3.3 ä¿®æ”¹å‡½æ•°ï¼ˆä½¿ç”¨é»„è‰²è­¦å‘Šè¡¨æƒ…å’Œåºå·ï¼‰
        if differences['modified']:
            report.write("\\nğŸ¯ ä¿®æ”¹å‡½æ•°:\\n")
            report.write("-" * 20 + "\\n")
            for i, (func_name, func_info) in enumerate(differences['modified'].items(), 1):
                report.write(f"\\nâš ï¸ ç¬¬{i}ä¸ªä¿®æ”¹å‡½æ•°: {func_name}\\n")
                
                report.write("\\nğŸ“„ åŸºå‡†é¡¹ç›®ä¸­çš„å‡½æ•°:\\n")
                report.write(func_info['base']['full_function'])
                
                report.write("\\n\\nğŸ“„ ç›®æ ‡é¡¹ç›®ä¸­çš„å‡½æ•°:\\n")
                report.write(func_info['target']['full_function'])
                
                report.write("\\n" + "=" * 50 + "\\n")
        
        # 4. æ€»ç»“
        report.write("\\nå››ã€æ€»ç»“\\n")
        report.write("=" * SECTION_WIDTH + "\\n")
        
        total_changes = len(differences['added']) + len(differences['deleted']) + len(differences['modified'])
        
        if total_changes == 0:
            report.write("âœ… ä¸¤ä¸ªæ–‡ä»¶çš„å‡½æ•°å†…å®¹å®Œå…¨ä¸€è‡´\\n")
        else:
            report.write(f"ğŸ“Š å…±å‘ç° {total_changes} ä¸ªå‡½æ•°å­˜åœ¨å·®å¼‚\\n")
            report.write("\\nğŸ’¡ å¤„ç†å»ºè®®:\\n")
            
            if len(differences['modified']) > 0:
                report.write("   âš ï¸  é‡ç‚¹å…³æ³¨ä¿®æ”¹å‡½æ•°ï¼Œæ£€æŸ¥é€»è¾‘å˜æ›´\\n")
            if len(differences['added']) > 0:
                report.write("   ğŸ”¸ éªŒè¯æ–°å¢å‡½æ•°çš„åŠŸèƒ½å’Œå¿…è¦æ€§\\n")
            if len(differences['deleted']) > 0:
                report.write("   âŒ ç¡®è®¤åˆ é™¤å‡½æ•°ä¸ä¼šå½±å“ç°æœ‰åŠŸèƒ½\\n")
        
        report.write("\\n" + "=" * REPORT_WIDTH + "\\n")
        report.write("æŠ¥å‘Šç”Ÿæˆå®Œæˆ\\n")
        report.write("=" * REPORT_WIDTH + "\\n")

def find_project_main_files():
    """æŸ¥æ‰¾æ‰€æœ‰é¡¹ç›®ä¸­çš„main.cæ–‡ä»¶"""
    projects = {}
    base_project_path = None
    
    # æŸ¥æ‰¾æ‰€æœ‰é¡¹ç›®æ–‡ä»¶å¤¹
    project_dirs = [d for d in os.listdir(BASE_DIR) 
                   if os.path.isdir(os.path.join(BASE_DIR, d)) 
                   and d != "é¡¹ç›®åˆ†ææŠ¥å‘Š"]
    
    for project_dir in project_dirs:
        full_path = os.path.join(BASE_DIR, project_dir)
        
        # ç¡®å®šæ‰«æç›®å½•
        scan_dir = None
        for possible_dir in SCAN_DIRS:
            if os.path.exists(os.path.join(full_path, possible_dir)):
                scan_dir = os.path.join(full_path, possible_dir)
                break
        
        if not scan_dir:
            continue
        
        # æŸ¥æ‰¾main.cæ–‡ä»¶
        main_c_path = os.path.join(scan_dir, MAIN_FILE_PATH, "main.c")
        if os.path.isfile(main_c_path):
            projects[project_dir] = main_c_path
            
            # æ£€æŸ¥æ˜¯å¦æ˜¯åŸºå‡†é¡¹ç›®
            if project_dir == BASE_PROJECT:
                base_project_path = main_c_path
    
    return projects, base_project_path

def compare_with_base_project():
    """å°†æ‰€æœ‰é¡¹ç›®ä¸åŸºå‡†é¡¹ç›®08è¿›è¡Œæ¯”è¾ƒ"""
    # ç¡®ä¿æŠ¥å‘Šç›®å½•å­˜åœ¨
    Path(REPORT_DIR).mkdir(parents=True, exist_ok=True)
    
    # æŸ¥æ‰¾æ‰€æœ‰é¡¹ç›®ä¸­çš„main.cæ–‡ä»¶
    projects, base_project_path = find_project_main_files()
    if not projects:
        print("æœªæ‰¾åˆ°ä»»ä½•é¡¹ç›®ä¸­çš„main.cæ–‡ä»¶")
        return
    
    if not base_project_path:
        print(f"é”™è¯¯: æœªæ‰¾åˆ°åŸºå‡†é¡¹ç›® {BASE_PROJECT} çš„ main.c æ–‡ä»¶")
        return
    
    # è·å–åŸºå‡†é¡¹ç›®æ–‡ä»¶ä¿¡æ¯
    base_info = get_file_info(base_project_path)
    if not base_info:
        print(f"é”™è¯¯: æ— æ³•è¯»å–åŸºå‡†é¡¹ç›®æ–‡ä»¶ {base_project_path}")
        return
    
    # è¯»å–åŸºå‡†é¡¹ç›®å†…å®¹å¹¶æå–å‡½æ•°
    base_content, base_encoding = safe_read_file(base_project_path)
    base_functions = extract_functions(base_content)
    print(f"åŸºå‡†é¡¹ç›® {BASE_PROJECT} ä¸­æ‰¾åˆ° {len(base_functions)} ä¸ªå‡½æ•°")
    
    # æ¯”è¾ƒæ‰€æœ‰é¡¹ç›®ä¸åŸºå‡†é¡¹ç›®
    for project_name, project_file in projects.items():
        # è·³è¿‡åŸºå‡†é¡¹ç›®è‡ªèº«
        if project_name == BASE_PROJECT:
            continue
        
        # è·å–é¡¹ç›®æ–‡ä»¶ä¿¡æ¯
        project_info = get_file_info(project_file)
        if not project_info:
            print(f"è·³è¿‡å¯¹æ¯”: {project_file} ä¸å­˜åœ¨")
            continue
        
        # è¯»å–ç›®æ ‡é¡¹ç›®å†…å®¹å¹¶æå–å‡½æ•°
        project_content, project_encoding = safe_read_file(project_file)
        project_functions = extract_functions(project_content)
        print(f"é¡¹ç›® {project_name} ä¸­æ‰¾åˆ° {len(project_functions)} ä¸ªå‡½æ•°")
        
        # æ¯”è¾ƒå‡½æ•°å·®å¼‚
        differences = compare_functions(base_functions, project_functions)
        
        # ç”ŸæˆæŠ¥å‘Šæ–‡ä»¶å
        report_name = f"é¡¹ç›®08_vs_{project_name}_å‡½æ•°å·®å¼‚åˆ†æ{REPORT_EXTENSION}"
        report_path = os.path.join(REPORT_DIR, report_name)
        
        # ç”Ÿæˆå‡½æ•°çº§åˆ«åˆ†ææŠ¥å‘Š
        generate_function_diff_report(base_info, project_info, differences, report_path)
        
        print(f"å·²ç”Ÿæˆå‡½æ•°å¯¹æ¯”æŠ¥å‘Š: é¡¹ç›®08 vs {project_name}")
        print(f"   - æŠ¥å‘Šè·¯å¾„: {report_path}")
        print(f"   - å‘ç°å·®å¼‚: æ–°å¢{len(differences['added'])}ä¸ª, åˆ é™¤{len(differences['deleted'])}ä¸ª, ä¿®æ”¹{len(differences['modified'])}ä¸ªå‡½æ•°")

def main():
    """ä¸»å‡½æ•° - åè°ƒæ•´ä¸ªå‡½æ•°å·®å¼‚åˆ†ææµç¨‹"""
    try:
        print("å¼€å§‹æ‰«æé¡¹ç›®å¹¶ä¸é¡¹ç›®08è¿›è¡Œå‡½æ•°çº§åˆ«å¯¹æ¯”...")
        compare_with_base_project()
        print("\\nâœ… æ‰€æœ‰å‡½æ•°å·®å¼‚åˆ†æå®Œæˆï¼")
        print(f"ğŸ“Š æŠ¥å‘Šå·²ä¿å­˜è‡³: {REPORT_DIR}")
        
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)

if __name__ == "__main__":
    main()

EOF`,
  type: 'python',
  varName: 'aw',
  size: 11662
};
var scriptCount = 23;
var indexToVarName = {
  1: 'aa',
  2: 'ab',
  3: 'ac',
  4: 'ad',
  5: 'ae',
  6: 'af',
  7: 'ag',
  8: 'ah',
  9: 'ai',
  10: 'aj',
  11: 'ak',
  12: 'al',
  13: 'am',
  14: 'an',
  15: 'ao',
  16: 'ap',
  17: 'aq',
  18: 'ar',
  19: 'as',
  20: 'at',
  21: 'au',
  22: 'av',
  23: 'aw'
};