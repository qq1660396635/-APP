<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTML æºç åˆ†æå·¥å…·</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    padding: 20px;
    min-height: 100vh;
    transition: background-color 0.5s ease;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    padding: 20px;
}

header {
    text-align: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
}

h1 {
    color: #333;
    margin-bottom: 10px;
}

.description {
    color: #666;
    font-size: 16px;
}

.input-section {
    margin-bottom: 20px;
}

textarea {
    width: 100%;
    height: 200px;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-family: monospace;
    resize: vertical;
    font-size: 14px;
}

.buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 15px 0;
}

button {
    padding: 10px 15px;
    background: #4a6ee0;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s;
}

button:hover {
    background: #3a5ec0;
}

/* å³ä¸Šè§’æ§åˆ¶å°æŒ‰é’® */
.console-toggle {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 25px;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    transition: all 0.3s ease;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 8px;
}

.console-toggle:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
}

.console-toggle::before {
    content: "âš™";
    font-size: 18px;
}

/* åŠŸèƒ½é¢æ¿ - åŠé€æ˜ç»ç’ƒæ•ˆæœ */
.function-panel {
    position: fixed;
    top: 70px;
    right: 20px;
    width: 320px;
    max-height: 0;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), 
                opacity 0.3s ease,
                transform 0.3s ease;
    opacity: 0;
    transform: translateY(-20px);
    z-index: 999;
}

.function-panel.active {
    max-height: 500px;
    opacity: 1;
    transform: translateY(0);
}

.function-panel-content {
    padding: 20px;
}

.function-panel h3 {
    color: #333;
    margin-bottom: 15px;
    font-size: 18px;
    text-align: center;
    padding-bottom: 10px;
    border-bottom: 2px solid rgba(102, 126, 234, 0.3);
}

/* å¯†é›†ç½‘æ ¼å¸ƒå±€ */
.function-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
}

.func-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 12px 8px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 12px;
    text-align: center;
    position: relative;
    overflow: hidden;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 500;
}

.func-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
}

.func-btn:hover::before {
    left: 100%;
}

.func-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

/* çªå‡ºæ˜¾ç¤ºé¡µé¢ç»“æ„æŒ‰é’® */
.func-btn[data-func="showStructure"] {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    grid-column: span 2;
    font-size: 14px;
    font-weight: bold;
    box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);
}

.func-btn[data-func="showStructure"]:hover {
    box-shadow: 0 6px 20px rgba(245, 87, 108, 0.4);
}

.dashboard {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 15px;
    transition: transform 0.3s;
}

.card:hover {
    transform: translateY(-5px);
}

.card h3 {
    color: #4a6ee0;
    margin-bottom: 10px;
    border-bottom: 1px solid #eee;
    padding-bottom: 5px;
}

.stats {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
}

.stat-item {
    background: #f0f4ff;
    padding: 8px 12px;
    border-radius: 5px;
    font-size: 14px;
}

.tag-list, .script-list {
    max-height: 200px;
    overflow-y: auto;
    margin-top: 10px;
}

.tag-item, .script-item {
    padding: 5px;
    margin-bottom: 5px;
    background: #f9f9f9;
    border-left: 3px solid #4a6ee0;
    font-size: 14px;
}

.hidden {
    display: none;
}

.error {
    color: #e74c3c;
    background: #ffeaea;
    padding: 10px;
    border-radius: 5px;
    margin-top: 10px;
}

.color-preview {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 10px;
    vertical-align: middle;
}

.toggle-btn {
    background: #2c3e50;
    margin-bottom: 10px;
}

.analysis-result {
    margin-top: 20px;
    padding: 15px;
    background: #f9f9f9;
    border-radius: 5px;
    max-height: 400px;
    overflow-y: auto;
}

pre {
    white-space: pre-wrap;
    font-family: monospace;
    font-size: 13px;
}

.highlight {
    background-color: yellow;
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
    .function-panel {
        width: 280px;
        right: 10px;
    }
    
    .function-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .func-btn[data-func="showStructure"] {
        grid-column: span 2;
    }
}
</style>
</head>
<body>
<div class="container">
<header>
<h1>HTML æºç åˆ†æå·¥å…·</h1>
<p class="description">ç²˜è´´HTML æºç ï¼Œè‡ªåŠ¨åˆ†æé¡µé¢ç»“æ„ã€èµ„æºå¼•ç”¨å’Œå…³é”®è„šæœ¬</p>
</header>
<div class="input-section">
<textarea id="htmlInput" placeholder="è¯·åœ¨æ­¤å¤„ç²˜è´´HTML æºç ..."></textarea>
<div class="buttons">
<button id="analyzeBtn">åˆ†ææºç </button>
<button id="clearBtn">æ¸…ç©º</button>
</div>
</div>
<div id="errorMessage" class="error hidden"></div>
<div id="dashboard" class="dashboard hidden">
<div class="card">
<h3>åŸºæœ¬ä¿¡æ¯</h3>
<div id="basicInfo"></div>
</div>
<div class="card">
<h3>å¤–éƒ¨èµ„æºå¼•ç”¨</h3>
<div id="externalFiles"></div>
</div>
<div class="card">
<h3>è„šæœ¬åˆ†æ</h3>
<div id="scriptAnalysis"></div>
</div>
<div class="card">
<h3>æ ‡ç­¾ç»Ÿè®¡</h3>
<div id="tagStats"></div>
</div>
<div class="card">
<h3>é“¾æ¥åˆ†æ</h3>
<div id="linkAnalysis"></div>
</div>
<div class="card">
<h3>CSS åˆ†æ</h3>
<div id="cssAnalysisResult"></div>
</div>
</div>
<div id="analysisResult" class="analysis-result hidden">
<h3>è¯¦ç»†åˆ†æç»“æœ</h3>
<pre id="resultContent"></pre>
</div>
</div>

<!-- å³ä¸Šè§’æ§åˆ¶å°æŒ‰é’® -->
<button class="console-toggle" id="consoleToggle">åŠŸèƒ½æ§åˆ¶å°</button>

<!-- åŠŸèƒ½é¢æ¿ -->
<div class="function-panel" id="functionPanel">
<div class="function-panel-content">
<h3>ğŸ”§ åˆ†æå·¥å…·ç®±</h3>
<div class="function-grid">
<button class="func-btn" data-func="countTags">æ ‡ç­¾ç»Ÿè®¡</button>
<button class="func-btn" data-func="listExternalFiles">å¤–éƒ¨èµ„æº</button>
<button class="func-btn" data-func="extractScripts">è„šæœ¬æå–</button>
<button class="func-btn" data-func="showStructure">ğŸ“Š é¡µé¢ç»“æ„</button>
<button class="func-btn" data-func="findLinks">é“¾æ¥åˆ†æ</button>
<button class="func-btn" data-func="cssAnalysis">CSS åˆ†æ</button>
<button class="func-btn" data-func="metaTags">Meta æ ‡ç­¾</button>
<button class="func-btn" data-func="imageAnalysis">å›¾ç‰‡åˆ†æ</button>
<button class="func-btn" data-func="formAnalysis">è¡¨å•åˆ†æ</button>
<button class="func-btn" data-func="seoAnalysis">SEO åˆ†æ</button>
<button class="func-btn" data-func="performanceTips">æ€§èƒ½å»ºè®®</button>
<button class="func-btn" data-func="accessibilityCheck">å¯è®¿é—®æ€§</button>
</div>
</div>
</div>

<script>
// é¢„å®šä¹‰èƒŒæ™¯é¢œè‰²æ•°ç»„
const backgroundColors = [
    '#f0f8ff', '#fff0f5', '#f5f5dc', '#f0fff0', '#fffacd', 
    '#f5f5f5', '#faf0e6', '#f0f0f0', '#e6e6fa', '#ffe4e1', 
    '#f0ffff', '#f5fffa', '#fff8dc', '#f8f8ff', '#fdf5e6', '#fff5ee'
];

// é¡µé¢åŠ è½½æ—¶éšæœºé€‰æ‹©èƒŒæ™¯é¢œè‰²
document.addEventListener('DOMContentLoaded', function() {
    const randomColor = backgroundColors[Math.floor(Math.random() * backgroundColors.length)];
    document.body.style.backgroundColor = randomColor;
    
    // è®¾ç½®åŠŸèƒ½é¢æ¿åˆå§‹çŠ¶æ€ä¸ºéšè—
    const functionPanel = document.getElementById('functionPanel');
    functionPanel.classList.remove('active');
});

// è·å–DOM å…ƒç´ 
const htmlInput = document.getElementById('htmlInput');
const analyzeBtn = document.getElementById('analyzeBtn');
const clearBtn = document.getElementById('clearBtn');
const consoleToggle = document.getElementById('consoleToggle');
const functionPanel = document.getElementById('functionPanel');
const dashboard = document.getElementById('dashboard');
const errorMessage = document.getElementById('errorMessage');
const analysisResult = document.getElementById('analysisResult');
const resultContent = document.getElementById('resultContent');

// æ§åˆ¶å°æŒ‰é’®ç‚¹å‡»äº‹ä»¶
consoleToggle.addEventListener('click', function() {
    functionPanel.classList.toggle('active');
});

// åˆ†ææŒ‰é’®ç‚¹å‡»äº‹ä»¶
analyzeBtn.addEventListener('click', function() {
    const html = htmlInput.value.trim();
    if (!html) {
        showError('è¯·è¾“å…¥HTML æºç ');
        return;
    }
    try {
        // åˆ›å»ºä¸´æ—¶DOM è§£æå™¨
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        // åˆ†æHTML
        analyzeHTML(doc, html);
        hideError();
        dashboard.classList.remove('hidden');
    } catch (error) {
        showError('è§£æHTML æ—¶å‡ºé”™: ' + error.message);
    }
});

// æ¸…ç©ºæŒ‰é’®ç‚¹å‡»äº‹ä»¶
clearBtn.addEventListener('click', function() {
    htmlInput.value = '';
    dashboard.classList.add('hidden');
    analysisResult.classList.add('hidden');
    hideError();
});

// åŠŸèƒ½æŒ‰é’®äº‹ä»¶å§”æ‰˜
functionPanel.addEventListener('click', function(e) {
    if (e.target.classList.contains('func-btn')) {
        const funcName = e.target.getAttribute('data-func');
        executeFunction(funcName);
    }
});

// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
function showError(message) {
    errorMessage.textContent = message;
    errorMessage.classList.remove('hidden');
    dashboard.classList.add('hidden');
    analysisResult.classList.add('hidden');
}

// éšè—é”™è¯¯ä¿¡æ¯
function hideError() {
    errorMessage.classList.add('hidden');
}

// HTML åˆ†æå‡½æ•°
function analyzeHTML(doc, html) {
    // åŸºæœ¬ä¿¡æ¯
    const title = doc.title || 'æ— æ ‡é¢˜';
    const charset = doc.querySelector('meta[charset]') ?
        doc.querySelector('meta[charset]').getAttribute('charset') : 'æœªæŒ‡å®š';
    
    document.getElementById('basicInfo').innerHTML = `
        <p><strong>é¡µé¢æ ‡é¢˜:</strong> ${title}</p>
        <p><strong>å­—ç¬¦ç¼–ç :</strong> ${charset}</p>
        <p><strong>æºç é•¿åº¦:</strong> ${html.length} å­—ç¬¦</p>
    `;
    
    // å¤–éƒ¨èµ„æºåˆ†æ
    const cssFiles = doc.querySelectorAll('link[rel="stylesheet"]');
    const jsFiles = doc.querySelectorAll('script[src]');
    const images = doc.querySelectorAll('img[src]');
    
    let externalFilesHTML = `
        <p><strong>CSS æ–‡ä»¶:</strong> ${cssFiles.length} ä¸ª</p>
        <p><strong>JS æ–‡ä»¶:</strong> ${jsFiles.length} ä¸ª</p>
        <p><strong>å›¾ç‰‡èµ„æº:</strong> ${images.length} ä¸ª</p>
    `;
    
    if (cssFiles.length > 0) {
        externalFilesHTML += '<p><strong>CSS æ–‡ä»¶åˆ—è¡¨:</strong></p><ul>';
        cssFiles.forEach(link => {
            const href = link.getAttribute('href');
            externalFilesHTML += `<li>${href}</li>`;
        });
        externalFilesHTML += '</ul>';
    }
    
    document.getElementById('externalFiles').innerHTML = externalFilesHTML;
    
    // è„šæœ¬åˆ†æ
    const inlineScripts = doc.querySelectorAll('script:not([src])');
    const externalScripts = doc.querySelectorAll('script[src]');
    
    let scriptAnalysisHTML = `
        <p><strong>å†…è”è„šæœ¬:</strong> ${inlineScripts.length} ä¸ª</p>
        <p><strong>å¤–éƒ¨è„šæœ¬:</strong> ${externalScripts.length} ä¸ª</p>
    `;
    
    if (inlineScripts.length > 0) {
        scriptAnalysisHTML += '<p><strong>å†…è”è„šæœ¬å†…å®¹:</strong></p>';
        inlineScripts.forEach((script, index) => {
            const content = script.textContent.trim();
            if (content) {
                scriptAnalysisHTML += `<div class="script-item">è„šæœ¬ ${index+1}: ${content.substring(0, 100)}...</div>`;
            }
        });
    }
    
    document.getElementById('scriptAnalysis').innerHTML = scriptAnalysisHTML;
    
    // æ ‡ç­¾ç»Ÿè®¡
    const allElements = doc.querySelectorAll('*');
    const tagCount = {};
    
    allElements.forEach(el => {
        const tagName = el.tagName.toLowerCase();
        tagCount[tagName] = (tagCount[tagName] || 0) + 1;
    });
    
    let tagStatsHTML = '<div class="stats">';
    for (const tag in tagCount) {
        tagStatsHTML += `<div class="stat-item">${tag}: ${tagCount[tag]}</div>`;
    }
    tagStatsHTML += '</div>';
    
    document.getElementById('tagStats').innerHTML = tagStatsHTML;
    
    // é“¾æ¥åˆ†æ
    const links = doc.querySelectorAll('a[href]');
    let linkAnalysisHTML = `<p><strong>é“¾æ¥æ€»æ•°:</strong> ${links.length}</p>`;
    
    if (links.length > 0) {
        linkAnalysisHTML += '<p><strong>é“¾æ¥ç¤ºä¾‹:</strong></p>';
        links.forEach((link, index) => {
            if (index < 5) { // åªæ˜¾ç¤ºå‰5ä¸ªé“¾æ¥
                const href = link.getAttribute('href');
                const text = link.textContent.trim() || '(æ— æ–‡æœ¬)';
                linkAnalysisHTML += `<div class="tag-item">${text} â†’ ${href}</div>`;
            }
        });
        if (links.length > 5) {
            linkAnalysisHTML += `<p>... ä»¥åŠå¦å¤–${links.length - 5} ä¸ªé“¾æ¥</p>`;
        }
    }
    
    document.getElementById('linkAnalysis').innerHTML = linkAnalysisHTML;
    
    // CSS åˆ†æ
    const styleTags = doc.querySelectorAll('style');
    const inlineStyles = doc.querySelectorAll('[style]');
    
    let cssAnalysisHTML = `
        <p><strong>Style æ ‡ç­¾:</strong> ${styleTags.length} ä¸ª</p>
        <p><strong>å†…è”æ ·å¼:</strong> ${inlineStyles.length} ä¸ª</p>
    `;
    
    if (styleTags.length > 0) {
        cssAnalysisHTML += '<p><strong>Style æ ‡ç­¾å†…å®¹ç¤ºä¾‹:</strong></p>';
        styleTags.forEach((style, index) => {
            const content = style.textContent.trim();
            if (content) {
                cssAnalysisHTML += `<div class="script-item">æ ·å¼ ${index+1}: ${content.substring(0, 100)}...</div>`;
            }
        });
    }
    
    document.getElementById('cssAnalysisResult').innerHTML = cssAnalysisHTML;
}

// æ‰§è¡Œç‰¹å®šåŠŸèƒ½
function executeFunction(funcName) {
    const html = htmlInput.value.trim();
    if (!html) {
        showError('è¯·å…ˆè¾“å…¥HTML æºç ');
        return;
    }
    
    try {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        let result = '';
        
        switch(funcName) {
            case 'countTags':
                result = countTags(doc);
                break;
            case 'listExternalFiles':
                result = listExternalFiles(doc);
                break;
            case 'extractScripts':
                result = extractScripts(doc);
                break;
            case 'showStructure':
                result = showStructure(doc);
                break;
            case 'findLinks':
                result = findLinks(doc);
                break;
            case 'cssAnalysis':
                result = cssAnalysis(doc);
                break;
            case 'metaTags':
                result = metaTags(doc);
                break;
            case 'imageAnalysis':
                result = imageAnalysis(doc);
                break;
            case 'formAnalysis':
                result = formAnalysis(doc);
                break;
            case 'seoAnalysis':
                result = seoAnalysis(doc);
                break;
            case 'performanceTips':
                result = performanceTips(doc);
                break;
            case 'accessibilityCheck':
                result = accessibilityCheck(doc);
                break;
            default:
                result = 'åŠŸèƒ½æœªå®ç°';
        }
        
        resultContent.textContent = result;
        analysisResult.classList.remove('hidden');
        hideError();
        
        // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
        analysisResult.scrollIntoView({ behavior: 'smooth' });
    } catch (error) {
        showError('æ‰§è¡ŒåŠŸèƒ½æ—¶å‡ºé”™: ' + error.message);
    }
}

// åŠŸèƒ½å®ç°å‡½æ•°
function countTags(doc) {
    const allElements = doc.querySelectorAll('*');
    const tagCount = {};
    
    allElements.forEach(el => {
        const tagName = el.tagName.toLowerCase();
        tagCount[tagName] = (tagCount[tagName] || 0) + 1;
    });
    
    let result = 'HTML æ ‡ç­¾ç»Ÿè®¡:\n\n';
    for (const tag in tagCount) {
        result += `${tag}: ${tagCount[tag]}\n`;
    }
    result += `\næ€»æ ‡ç­¾æ•°: ${allElements.length}`;
    return result;
}

function listExternalFiles(doc) {
    const cssFiles = doc.querySelectorAll('link[rel="stylesheet"]');
    const jsFiles = doc.querySelectorAll('script[src]');
    const images = doc.querySelectorAll('img[src]');
    const iframes = doc.querySelectorAll('iframe[src]');
    
    let result = 'å¤–éƒ¨èµ„æºå¼•ç”¨åˆ—è¡¨:\n\n';
    
    result += 'CSS æ–‡ä»¶:\n';
    cssFiles.forEach(link => {
        result += `- ${link.getAttribute('href')}\n`;
    });
    
    result += '\nJavaScript æ–‡ä»¶:\n';
    jsFiles.forEach(script => {
        result += `- ${script.getAttribute('src')}\n`;
    });
    
    result += '\nå›¾ç‰‡èµ„æº:\n';
    images.forEach(img => {
        result += `- ${img.getAttribute('src')}\n`;
    });
    
    result += '\niframe èµ„æº:\n';
    iframes.forEach(iframe => {
        result += `- ${iframe.getAttribute('src')}\n`;
    });
    
    result += `\næ€»è®¡: ${cssFiles.length + jsFiles.length + images.length + iframes.length} ä¸ªå¤–éƒ¨èµ„æº`;
    return result;
}

function extractScripts(doc) {
    const inlineScripts = doc.querySelectorAll('script:not([src])');
    const externalScripts = doc.querySelectorAll('script[src]');
    
    let result = 'è„šæœ¬åˆ†æç»“æœ:\n\n';
    
    result += `å†…è”è„šæœ¬: ${inlineScripts.length} ä¸ª\n`;
    inlineScripts.forEach((script, index) => {
        const content = script.textContent.trim();
        result += `\nå†…è”è„šæœ¬${index+1}:\n`;
        result += content.substring(0, 500) + (content.length > 500 ? '...' : '') + '\n';
    });
    
    result += `\nå¤–éƒ¨è„šæœ¬: ${externalScripts.length} ä¸ª\n`;
    externalScripts.forEach((script, index) => {
        result += `å¤–éƒ¨è„šæœ¬${index+1}: ${script.getAttribute('src')}\n`;
    });
    
    return result;
}

function showStructure(doc) {
    let result = 'é¡µé¢DOM ç»“æ„:\n\n';
    
    function traverse(element, depth) {
        const indent = '  '.repeat(depth);
        const tagName = element.tagName.toLowerCase();
        
        result += `${indent}<${tagName}`;
        
        // æ·»åŠ ID å’Œç±»å
        if (element.id) result += ` id="${element.id}"`;
        if (element.className) result += ` class="${element.className}"`;
        
        result += '>\n';
        
        // é€’å½’éå†å­å…ƒç´ 
        Array.from(element.children).forEach(child => {
            traverse(child, depth + 1);
        });
    }
    
    traverse(doc.documentElement, 0);
    return result;
}

function findLinks(doc) {
    const links = doc.querySelectorAll('a[href]');
    
    let result = 'é¡µé¢é“¾æ¥åˆ†æ:\n\n';
    
    links.forEach((link, index) => {
        const href = link.getAttribute('href');
        const text = link.textContent.trim() || '(æ— æ–‡æœ¬)';
        
        result += `é“¾æ¥${index+1}:\n`;
        result += `æ–‡æœ¬: ${text}\n`;
        result += `åœ°å€: ${href}\n`;
        result += `æ ‡é¢˜: ${link.getAttribute('title') || 'æ— '}\n`;
        result += `ç›®æ ‡: ${link.getAttribute('target') || '_self'}\n`;
        result += '---\n';
    });
    
    result += `æ€»è®¡: ${links.length} ä¸ªé“¾æ¥`;
    return result;
}

function cssAnalysis(doc) {
    const styleTags = doc.querySelectorAll('style');
    const inlineStyles = doc.querySelectorAll('[style]');
    
    let result = 'CSS åˆ†æç»“æœ:\n\n';
    
    result += `Style æ ‡ç­¾: ${styleTags.length} ä¸ª\n`;
    styleTags.forEach((style, index) => {
        const content = style.textContent.trim();
        result += `\nStyle æ ‡ç­¾${index+1}:\n`;
        result += content.substring(0, 500) + (content.length > 500 ? '...' : '') + '\n';
    });
    
    result += `\nå†…è”æ ·å¼å…ƒç´ : ${inlineStyles.length} ä¸ª\n`;
    inlineStyles.forEach((element, index) => {
        if (index < 10) { // åªæ˜¾ç¤ºå‰10ä¸ª
            const tagName = element.tagName.toLowerCase();
            const style = element.getAttribute('style');
            result += `\nå…ƒç´ ${index+1} (<${tagName}>):\n`;
            result += `${style}\n`;
        }
    });
    
    if (inlineStyles.length > 10) {
        result += `\n... ä»¥åŠå¦å¤–${inlineStyles.length - 10} ä¸ªå¸¦æœ‰å†…è”æ ·å¼çš„å…ƒç´ `;
    }
    
    return result;
}

function metaTags(doc) {
    const metaTags = doc.querySelectorAll('meta');
    
    let result = 'Meta æ ‡ç­¾åˆ†æ:\n\n';
    
    metaTags.forEach(meta => {
        const name = meta.getAttribute('name') || meta.getAttribute('property');
        const content = meta.getAttribute('content');
        
        if (name) {
            result += `${name}: ${content}\n`;
        } else if (meta.getAttribute('charset')) {
            result += `charset: ${meta.getAttribute('charset')}\n`;
        } else if (meta.getAttribute('http-equiv')) {
            result += `http-equiv: ${meta.getAttribute('http-equiv')} = ${content}\n`;
        }
    });
    
    result += `\næ€»è®¡: ${metaTags.length} ä¸ªmeta æ ‡ç­¾`;
    return result;
}

function imageAnalysis(doc) {
    const images = doc.querySelectorAll('img');
    
    let result = 'å›¾ç‰‡åˆ†æç»“æœ:\n\n';
    
    images.forEach((img, index) => {
        result += `å›¾ç‰‡${index+1}:\n`;
        result += `æºæ–‡ä»¶: ${img.getAttribute('src') || 'æ— '}\n`;
        result += `æ›¿ä»£æ–‡æœ¬: ${img.getAttribute('alt') || 'æ— '}\n`;
        result += `æ ‡é¢˜: ${img.getAttribute('title') || 'æ— '}\n`;
        result += `å®½åº¦: ${img.getAttribute('width') || 'æœªæŒ‡å®š'}\n`;
        result += `é«˜åº¦: ${img.getAttribute('height') || 'æœªæŒ‡å®š'}\n`;
        result += '---\n';
    });
    
    result += `æ€»è®¡: ${images.length} ä¸ªå›¾ç‰‡å…ƒç´ `;
    return result;
}

function formAnalysis(doc) {
    const forms = doc.querySelectorAll('form');
    
    let result = 'è¡¨å•åˆ†æç»“æœ:\n\n';
    
    forms.forEach((form, formIndex) => {
        result += `è¡¨å•${formIndex+1}:\n`;
        result += `åŠ¨ä½œ: ${form.getAttribute('action') || 'æœªæŒ‡å®š'}\n`;
        result += `æ–¹æ³•: ${form.getAttribute('method') || 'GET'}\n`;
        
        const inputs = form.querySelectorAll('input, textarea, select');
        result += `è¡¨å•æ§ä»¶: ${inputs.length} ä¸ª\n`;
        
        inputs.forEach((input, inputIndex) => {
            const type = input.getAttribute('type') || input.tagName.toLowerCase();
            const name = input.getAttribute('name') || 'æœªå‘½å';
            result += `  ${inputIndex+1}. ${type} (name: ${name})\n`;
        });
        
        result += '---\n';
    });
    
    if (forms.length === 0) {
        result += 'é¡µé¢ä¸­æ²¡æœ‰å‘ç°è¡¨å•å…ƒç´ ';
    } else {
        result += `æ€»è®¡: ${forms.length} ä¸ªè¡¨å•`;
    }
    
    return result;
}

function seoAnalysis(doc) {
    let result = 'SEO åˆ†æç»“æœ:\n\n';
    
    // é¡µé¢æ ‡é¢˜
    const title = doc.title;
    result += `é¡µé¢æ ‡é¢˜: ${title || 'æœªè®¾ç½®'}\n`;
    if (title) {
        if (title.length < 30) result += 'è­¦å‘Š: æ ‡é¢˜å¯èƒ½è¿‡çŸ­\n';
        else if (title.length > 60) result += 'è­¦å‘Š: æ ‡é¢˜å¯èƒ½è¿‡é•¿\n';
        else result += 'æ ‡é¢˜é•¿åº¦åˆé€‚\n';
    }
    
    // Meta æè¿°
    const metaDesc = doc.querySelector('meta[name="description"]');
    const descContent = metaDesc ? metaDesc.getAttribute('content') : null;
    
    result += `\nMeta æè¿°: ${descContent || 'æœªè®¾ç½®'}\n`;
    if (descContent) {
        if (descContent.length < 50) result += 'è­¦å‘Š: æè¿°å¯èƒ½è¿‡çŸ­\n';
        else if (descContent.length > 160) result += 'è­¦å‘Š: æè¿°å¯èƒ½è¿‡é•¿\n';
        else result += 'æè¿°é•¿åº¦åˆé€‚\n';
    }
    
    // H1 æ ‡ç­¾
    const h1Tags = doc.querySelectorAll('h1');
    result += `\nH1 æ ‡ç­¾æ•°é‡: ${h1Tags.length}\n`;
    if (h1Tags.length === 0) result += 'è­¦å‘Š: é¡µé¢ç¼ºå°‘H1 æ ‡ç­¾\n';
    else if (h1Tags.length > 1) result += 'è­¦å‘Š: é¡µé¢æœ‰å¤šä¸ªH1 æ ‡ç­¾\n';
    
    // å›¾ç‰‡ALT å±æ€§
    const images = doc.querySelectorAll('img');
    const imagesWithAlt = Array.from(images).filter(img => img.getAttribute('alt'));
    
    result += `\nå›¾ç‰‡æ€»æ•°: ${images.length}\n`;
    result += `å¸¦ALT å±æ€§çš„å›¾ç‰‡: ${imagesWithAlt.length}\n`;
    if (images.length > 0 && imagesWithAlt.length < images.length) {
        result += 'è­¦å‘Š: éƒ¨åˆ†å›¾ç‰‡ç¼ºå°‘ALT å±æ€§\n';
    }
    
    return result;
}

function performanceTips(doc) {
    let result = 'æ€§èƒ½ä¼˜åŒ–å»ºè®®:\n\n';
    
    // æ£€æŸ¥CSS æ–‡ä»¶
    const cssFiles = doc.querySelectorAll('link[rel="stylesheet"]');
    if (cssFiles.length > 3) {
        result += `- å‘ç°${cssFiles.length} ä¸ªCSS æ–‡ä»¶ï¼Œè€ƒè™‘åˆå¹¶ä»¥å‡å°‘HTTP è¯·æ±‚\n`;
    }
    
    // æ£€æŸ¥JS æ–‡ä»¶
    const jsFiles = doc.querySelectorAll('script[src]');
    if (jsFiles.length > 3) {
        result += `- å‘ç°${jsFiles.length} ä¸ªJS æ–‡ä»¶ï¼Œè€ƒè™‘åˆå¹¶æˆ–ä½¿ç”¨å¼‚æ­¥åŠ è½½\n`;
    }
    
    // æ£€æŸ¥å›¾ç‰‡
    const images = doc.querySelectorAll('img');
    const largeImages = Array.from(images).filter(img => {
        const width = parseInt(img.getAttribute('width')) || 0;
        const height = parseInt(img.getAttribute('height')) || 0;
        return width > 1000 || height > 1000;
    });
    
    if (largeImages.length > 0) {
        result += `- å‘ç°${largeImages.length} ä¸ªå¯èƒ½çš„å¤§å›¾ç‰‡ï¼Œè€ƒè™‘ä¼˜åŒ–å›¾ç‰‡å¤§å°\n`;
    }
    
    // æ£€æŸ¥å†…è”æ ·å¼å’Œè„šæœ¬
    const inlineStyles = doc.querySelectorAll('[style]');
    if (inlineStyles.length > 10) {
        result += `- å‘ç°${inlineStyles.length} ä¸ªå†…è”æ ·å¼ï¼Œè€ƒè™‘æå–åˆ°CSS æ–‡ä»¶ä¸­\n`;
    }
    
    const inlineScripts = doc.querySelectorAll('script:not([src])');
    if (inlineScripts.length > 3) {
        result += `- å‘ç°${inlineScripts.length} ä¸ªå†…è”è„šæœ¬ï¼Œè€ƒè™‘æå–åˆ°å¤–éƒ¨æ–‡ä»¶\n`;
    }
    
    if (result === 'æ€§èƒ½ä¼˜åŒ–å»ºè®®:\n\n') {
        result += 'é¡µé¢ç»“æ„è‰¯å¥½ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜';
    }
    
    return result;
}

function accessibilityCheck(doc) {
    let result = 'å¯è®¿é—®æ€§æ£€æŸ¥:\n\n';
    
    // æ£€æŸ¥å›¾ç‰‡ALT
    const images = doc.querySelectorAll('img');
    const imagesWithoutAlt = Array.from(images).filter(img => !img.getAttribute('alt'));
    
    if (imagesWithoutAlt.length > 0) {
        result += `- å‘ç°${imagesWithoutAlt.length} ä¸ªå›¾ç‰‡ç¼ºå°‘ALT å±æ€§\n`;
    }
    
    // æ£€æŸ¥è¡¨å•æ ‡ç­¾
    const inputs = doc.querySelectorAll('input, textarea, select');
    const unlabeledInputs = Array.from(inputs).filter(input => {
        const id = input.getAttribute('id');
        if (!id) return true;
        
        const label = doc.querySelector(`label[for="${id}"]`);
        return !label;
    });
    
    if (unlabeledInputs.length > 0) {
        result += `- å‘ç°${unlabeledInputs.length} ä¸ªè¡¨å•å…ƒç´ å¯èƒ½ç¼ºå°‘å…³è”æ ‡ç­¾\n`;
    }
    
    // æ£€æŸ¥æ ‡é¢˜ç»“æ„
    const headings = doc.querySelectorAll('h1, h2, h3, h4, h5, h6');
    let lastLevel = 0;
    let headingError = false;
    
    headings.forEach(heading => {
        const level = parseInt(heading.tagName.substring(1));
        if (level > lastLevel + 1) {
            headingError = true;
        }
        lastLevel = level;
    });
    
    if (headingError) {
        result += '- æ ‡é¢˜å±‚çº§å¯èƒ½ä¸åˆç†ï¼Œé¿å…è·³è¿‡æ ‡é¢˜çº§åˆ«\n';
    }
    
    // æ£€æŸ¥è¯­è¨€å±æ€§
    const html = doc.documentElement;
    if (!html.getAttribute('lang')) {
        result += '- HTML å…ƒç´ ç¼ºå°‘lang å±æ€§\n';
    }
    
    if (result === 'å¯è®¿é—®æ€§æ£€æŸ¥:\n\n') {
        result += 'é¡µé¢å¯è®¿é—®æ€§è‰¯å¥½ï¼Œæœªå‘ç°æ˜æ˜¾é—®é¢˜';
    }
    
    return result;
}
</script>
</body>
</html>
