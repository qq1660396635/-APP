######################### 一键安装 begin #########################
# 0. 如有旧文件先清掉（可选）
rm -f $PREFIX/2025/kw.txt $PREFIX/2025/start

# 1. 确保目录存在
mkdir -p $PREFIX/2025

# 2. 写入核心关键词
cat > $PREFIX/2025/kw.txt <<'EOF'
进程调度
内存管理
虚拟文件系统
网络子系统
中断处理
系统调用
文件描述符
缺页异常
信号量
死锁
cron
EOF

# 3. 生成 start 脚本
cat > $PREFIX/2025/start <<'EOF'
#!/data/data/com.termux/files/usr/bin/bash
while :; do
    kw=$(shuf -n 1 $PREFIX/2025/kw.txt)
    response=$(curl -s "https://baike.baidu.com/api/openapi/BaikeLemmaCardApi?scope=103&format=json&appid=379020&bk_key=$kw")
    abstract=$(echo "$response" | jq -r '.abstract // ""')
    [[ -n $abstract ]] && break
done

# 自然分段处理：将句号替换为换行，去除多余内容，每行前加两个空格
abstract=$(echo "$abstract" | sed 's/。/。\n/g' | sed 's/\[[0-9]*\]//g' | sed 's/^[[:space:]]*//' | sed '/^$/d' | sed 's/^/  /')
printf "【%s】\n%s\n" "$kw" "$abstract"
EOF

# 4. 赋权 & 注入 .bashrc
chmod +x $PREFIX/2025/start
sed -i '\|$PREFIX/.*/start|d' $HOME/.bashrc
echo '$PREFIX/2025/start' >> $HOME/.bashrc
######################### 一键安装 end #########################





######################### 精简关键词更新脚本 begin #########################
#!/bin/bash

# 删除旧的关键词文件
rm -f $PREFIX/2025/kw.txt

# 创建新的关键词文件，只包含5个核心术语
cat > $PREFIX/2025/kw.txt <<'EOF'
Linux内核
进程调度
内存管理
STM32
嵌入式系统
EOF

echo "关键词列表已精简更新完成！共包含 $(wc -l < $PREFIX/2025/kw.txt) 个核心术语。"
echo "下次启动Termux时将显示随机术语的百度百科摘要。"
######################### 精简关键词更新脚本 end #########################




#########################1.  脚本3 添加力扣功能 begin #########################
# 创建力扣题目文件（新格式）
cat > $PREFIX/2025/leetcode_short.txt <<'EOF'
100. Same Tree｜两棵二叉树长得一模一样吗？｜像比较两盆盆栽，先比根，再递归比左右枝｜算法思想：分治；数据结构：树
101. Symmetric Tree｜二叉树是不是左右照镜子？｜把树对折，看两边叶脉能否重叠｜算法思想：分治；数据结构：树
102. Binary Tree Level Order Traversal｜把树按楼层拍照｜用队列当电梯，一层层把人放出来合影｜算法思想：图遍历-BFS；数据结构：队列+树
103. Binary Tree Zigzag Level Order Traversal｜蛇形排队拍照｜电梯每层换方向，左→右→左→右｜算法思想：图遍历-BFS；数据结构：队列+树
104. Maximum Depth of Binary Tree｜树最高到几楼？｜从根往下扔石子，看最深溅起的水花｜算法思想：分治；数据结构：树
EOF

# 创建力扣题目随机显示脚本（新格式版）
cat > $PREFIX/2025/leetcode.sh <<'EOF'
#!/data/data/com.termux/files/usr/bin/bash
FILE="$PREFIX/2025/leetcode_short.txt"
if [ -f "$FILE" ]; then
    echo  # 换行
    echo  # 换行
    line=$(shuf -n 1 "$FILE")
    
    # 使用｜分割各个部分
    IFS='｜' read -ra parts <<< "$line"
    
    # 输出格式化内容
    echo "${parts[0]}"  # 题目名称
    echo "  题目说明：${parts[1]}"  # 题目人话说明
    echo "  思路说明：${parts[2]}"  # 思路人话说明
    echo "  算法与数据结构：${parts[3]}"  # 算法思想和数据结构
else
    echo "Leetcode file not found."
fi
EOF

# 赋予执行权限
chmod +x $PREFIX/2025/leetcode.sh

# 注入到.bashrc（只添加力扣部分）
sed -i '\|$PREFIX/2025/leetcode.sh|d' $HOME/.bashrc
echo '$PREFIX/2025/leetcode.sh' >> $HOME/.bashrc

echo "力扣功能添加完成！重启Termux或运行 'source ~/.bashrc' 查看效果。"
######################### 添加力扣功能 end #########################






#########################1. 添加力扣功能 begin #########################
# 创建力扣题目文件（100-150题，全部使用中文）
cat > $PREFIX/2025/leetcode_short.txt <<'EOF'
100. 判断两棵二叉树是否相同｜两棵二叉树长得一模一样吗？｜像比较两盆盆栽，先比根，再递归比左右枝｜算法思想：分治；数据结构：树
101. 判断二叉树是否对称｜二叉树是不是左右照镜子？｜把树对折，看两边叶脉能否重叠｜算法思想：分治；数据结构：树
102. 二叉树的层序遍历｜把树按楼层拍照｜用队列当电梯，一层层把人放出来合影｜算法思想：图遍历-BFS；数据结构：队列+树
103. 二叉树的锯齿形层序遍历｜蛇形排队拍照｜电梯每层换方向，左→右→左→右｜算法思想：图遍历-BFS；数据结构：队列+树
104. 二叉树的最大深度｜树最高到几楼？｜从根往下扔石子，看最深溅起的水花｜算法思想：分治；数据结构：树
105. 根据前序和中序遍历序列构造二叉树｜Preorder当"骨架"，Inorder当"肉"｜像拼乐高，先放主梁，再左右插砖｜算法思想：分治；数据结构：树
106. 根据中序和后序遍历序列构造二叉树｜Postorder当"倒骨架"｜从后往前像倒着拆快递，边拆边复原｜算法思想：分治；数据结构：树
107. 二叉树的层序遍历II｜自底向上拍楼层｜把楼层照片倒序排，像翻书从最后一页看｜算法思想：图遍历-BFS；数据结构：队列+数组
108. 将有序数组转换为二叉搜索树｜把排好序的"台阶"折成平衡树｜找中间当支点，左右继续折｜算法思想：分治；数据结构：树
109. 将有序链表转换为二叉搜索树｜把有序链表折成树｜快慢指针找中点，像折纸飞机找重心｜算法思想：分治；数据结构：链表+树
110. 判断平衡二叉树｜树是不是"歪脖子"？｜检查任意子树两叉深度差≤1，像看盆景平衡｜算法思想：分治；数据结构：树
111. 二叉树的最小深度｜树最浅到根叶子几步？｜BFS找到第一个叶子即停，像迷宫最短出口｜算法思想：图遍历-BFS；数据结构：队列+树
112. 路径总和｜根到叶子有没有一条"刚好"钱数的路径？｜DFS一路扣极钱，到叶子看钱包空不空｜算法思想：图遍历-DFS；数据结构：树
113. 路径总和II｜把所有刚好花光钱的路径都记下来｜DFS走到叶子若清零，则拍照留念｜算法思想：图遍历-DFS；数据结构：树+数组
114. 二叉树展开为链表｜把树压成右斜"糖葫芦"｜后序先压左右，再把左子树挂到右下｜算法思想：图遍历-DFS；数据结构：树
115. 不同的子序列｜字符串T在S里能"跳房子"几次？｜DP跳棋盘，匹配则继承左上，否则继承上方｜算法思想：动态规划；数据结构：数组
116. 填充每个节点的下一个右侧节点指针I｜把满二叉树每层连"横丝"｜BFS队列像串珍珠，左右邻居牵手｜算法思想：图遍历-BFS；数据结构：队列+树
117. 填充每个节点的下一个右侧节点指针II｜普通二叉树也连横丝｜用"上一层的横丝"当链表，节省队列｜算法思想：图遍历-BFS；数据结构：链表+树
118. 杨辉三角｜打印杨辉三角｜每行两端放1，中间是上一行两肩相加｜算法思想：动态规划；数据结构：数组
119. 杨辉三角II｜只要第k行｜滚动数组，只存当前行，像折扇只展开一层｜算法思想：动态规划；数据结构：数组
120. 三角形最小路径和｜从三角塔顶往下走，和最小？｜自底向上DP，像叠积木，每层选便宜底座｜算法思想：动态规划；数据结构：数组
121. 买卖股票的最佳时机｜低买高卖一次，最大差？｜一次遍历，记录历史最低，今天卖能赚多少｜算法思想：贪心；数据结构：数组
122. 买卖股票的最佳时机II｜可以多次买卖，当天可卖再买｜只要明天比今天贵就今天买明天卖，像"搬砖套利"｜算法思想：贪心；数据结构：数组
123. 买卖股票的最佳时机III｜最多两次交易｜DP四状态：第一次买、卖、第二次买、卖，像两条心跳曲线｜算法思想：动态规划；数据结构：数组
124. 二叉树中的最大路径和｜二叉树任意路径最大和｜后序遍历，左右子树贡献正数，像"树枝快递"只送不亏本的｜算法思想：分治；数据结构：树
125. 验证回文串｜过滤后是否回文？｜双指针从两头往中间夹，像吃甘蔗剥叶子｜算法思想：双指针；数据结构：数组
126. 单词接龙II｜字典里变单词，最短所有路径｜BFS建图+DFS回溯，像地铁换乘所有最短路线｜算法思想：图遍历+回溯；数据结构：图+队列
127. 单词接龙｜只想要最短长度｜单向/双向BFS，像两束激光对射碰头｜算法思想：图遍历-BFS；数据结构：队列+哈希表
128. 最长连续序列｜无序数组最长连续数列｜哈希表当"抽屉"，先全放再O(n)找每个数列开头｜算法思想：哈希；数据结构：哈希表
129. 求根节点到叶节点数字之和｜根到叶子路径数字和｜DFS一路拼数字，到叶子加总，像"拨号盘"累计｜算法思想：图遍历-DFS；数据结构：树
130. 被围绕的区域｜棋盘边界O不会包围的X才变O｜先DFS边界O做"救生圈"，再扫描中间沉的｜算法思想：图遍历-DFS；数据结构：数组
131. 分割回文串｜把字符串切成每块都是回文｜回溯+DP预处理回文，像切蛋糕先画虚线｜算法思想：回溯；数据结构：数组
132. 分割回文串II｜最少切几刀能全回文｜DP：若s[i..j]回文则dp[j]=min(dp[j],dp[i-1]+1)｜算法思想：动态规划；数据结构：数组
133. 克隆图｜深度拷贝无向图｜DFS/BFS+哈希"影印"节点，像复印机边翻页边影印｜算法思想：图遍历；数据结构：图+哈希表
134. 加油站｜环形路油站能否跑一圈｜总油≥总耗即可，起点找"亏空"后一站，像接力棒找起跑点｜算法思想：贪心；数据结构：数组
135. 分发糖果｜分糖果，评分高的比邻居多｜两遍贪心：左→右保证右邻居，右→左保证左邻居｜算法思想：贪心；数据结构：数组
136. 只出现一次的数字｜众数成双，落单是谁？｜全员异或，相同归零，落单现身｜算法思想：数学位运算；数据结构：数组
137. 只出现一次的数字II｜三个数成对，落单是谁？｜位计数模3，像"三进制"里找余1位｜算法思想：数学位运算；数据结构：数组
138. 复制带随机指针的链表｜链表带随机指针深拷贝｜第一次串next并建哈希，第二次补random，像先搭骨架再连神经｜算法思想：哈希；数据结构：链表+哈希表
139. 单词拆分｜字典能否拼出字符串？｜DP：s[0..i]可拼当存在j<i且s[j+1..i]在字典｜算法思想：动态规划；数据结构：数组+哈希表
140. 单词拆分II｜拼法所有句子｜DP预处理可行+回溯拼句子，像先筛乐高底座再搭造型｜算法思想：动态规划+回溯；数据结构：数组+哈希表
141. 环形链表｜链表有环吗？｜快慢指针，像跑道套圈，相遇则有环｜算法思想：双指针；数据结构：链表
142. 环形链表II｜环起点在哪？｜快慢相遇后，慢回头到起点，再同步走到环口｜算法思想：双指针；数据结构：链表
143. 重排链表｜链表L0→Ln→L1→Ln-1…重排｜找中点+反转后半+合并，像折扇收拢再穿插｜算法思想：分治+链表操作；数据结构：链表
144. 二叉树的前序遍历｜根左右顺序输出｜递归/迭代栈，像探险先插旗再探左右｜算法思想：图遍历-DFS；数据结构：树+栈
145. 二叉树的后序遍历｜左右根顺序输出｜递归/迭代，像清理战场先清左右再汇报｜算法思想：图遍历-DFS；数据结构：树+栈
146. LRU缓存｜最近最少用缓存｜哈希+双向链表，像书架+便签，用完放最前，满时扔末尾｜算法思想：哈希+链表；数据结构：哈希表+双向链表
147. 对链表进行插入排序｜链表插入排序｜断链重插，像打扑克摸一张插一张｜算法思想：暴力枚举；数据结构：链表
148. 排序链表｜链表归并排序｜快慢找中点+归并，像把珍珠链先掰半再合并｜算法思想：分治；数据结构：链表
149. 直线上最多的点数｜平面上最多点共线｜对每点极角排序，滑动窗口数同斜率，像雷达扫射｜算法思想：暴力枚举+哈希；数据结构：数组+哈希表
150. 逆波兰表达式求值｜后缀表达式求值｜栈当"算盘"，遇数压栈，遇符弹两数算完压回｜算法思想：栈；数据结构：栈
EOF

# 创建力扣题目随机显示脚本
cat > $PREFIX/2025/leetcode.sh <<'EOF'
#!/data/data/com.termux/files/usr/bin/bash
FILE="$PREFIX/2025/leetcode_short.txt"
if [ -f "$FILE" ]; then
    echo
    echo
    line=$(shuf -n 1 "$FILE")
    IFS='｜' read -ra parts <<< "$line"
    echo "【${parts[0]}】"
    echo "题目说明：${parts[1]}"
    echo "思路说明：${parts[2]}"
    echo "算法与数据结构：${parts[3]}"
else
    echo "Leetcode file not found."
fi
EOF

# 赋予执行权限
chmod +x $PREFIX/2025/leetcode.sh

# 注入到.bashrc（只添加力扣部分）
sed -i '\|$PREFIX/2025/leetcode.sh|d' $HOME/.bashrc
echo '$PREFIX/2025/leetcode.sh' >> $HOME/.bashrc

echo "力扣功能添加完成！重启Termux或运行 'source ~/.bashrc' 查看效果。"
######################### 添加力扣功能 end #########################